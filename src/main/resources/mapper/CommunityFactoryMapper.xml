<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.tdkj.dao.CommunityFactory.CommunityFactoryMapper" >
  <resultMap id="BaseResultMap" type="com.tdkj.model.CommunityFactory" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    <id column="CTF001" property="ctf001" jdbcType="VARCHAR" />
    <result column="CTF002" property="ctf002" jdbcType="VARCHAR" />
    <result column="CTF003" property="ctf003" jdbcType="VARCHAR" />
    <result column="CTF004" property="ctf004" jdbcType="VARCHAR" />
    <result column="CTF005" property="ctf005" jdbcType="VARCHAR" />
    <result column="CTF006" property="ctf006" jdbcType="VARCHAR" />
    <result column="CTF007" property="ctf007" jdbcType="DECIMAL" />
    <result column="CTF008" property="ctf008" jdbcType="DECIMAL" />
    <result column="CTF009" property="ctf009" jdbcType="VARCHAR" />
    <result column="CTF010" property="ctf010" jdbcType="VARCHAR" />
    <result column="CTF011" property="ctf011" jdbcType="VARCHAR" />
    <result column="AAB301" property="aab301" jdbcType="VARCHAR" />
    <result column="AAE011" property="aae011" jdbcType="VARCHAR" />
    <result column="CTF012" property="ctf012" jdbcType="VARCHAR" />
    <result column="CTF013" property="ctf013" jdbcType="VARCHAR" />
    <result column="CTF014" property="ctf014" jdbcType="VARCHAR" />
    <result column="CTF015" property="ctf015" jdbcType="VARCHAR" />
    <result column="CTF016" property="ctf016" jdbcType="VARCHAR" />
    <result column="CTF017" property="ctf017" jdbcType="VARCHAR" />
    <result column="CTF018" property="ctf018" jdbcType="VARCHAR" />
    <result column="CTF019" property="ctf019" jdbcType="VARCHAR" />
    <result column="CTF020" property="ctf020" jdbcType="VARCHAR" />
    <result column="AAE036" property="aae036" jdbcType="TIMESTAMP" />
    <result column="DATASOURCE" property="datasource" jdbcType="VARCHAR" />
    <result column="AAE100" property="aae100" jdbcType="VARCHAR" />
    <result column="UPDATEDATE" property="updatedate" jdbcType="TIMESTAMP" />
    <result column="UPDATEBY" property="updateby" jdbcType="VARCHAR" />
    <result column="CREATEBY" property="createby" jdbcType="VARCHAR" />
    <result column="AAE012" property="aae012" jdbcType="VARCHAR" />
    <result column="DELETEBY" property="deleteby" jdbcType="VARCHAR" />
    <result column="DELETEDATE" property="deletedate" jdbcType="TIMESTAMP" />
  </resultMap>
  <sql id="Base_Column_List" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    CTF001, CTF002, CTF003, CTF004, CTF005, CTF006, CTF007, CTF008, CTF009, CTF010, CTF011, 
    AAB301, AAE011, AAE036,DATASOURCE,AAE100,UPDATEDATE,UPDATEBY,CREATEBY,AAE012,CTF012,CTF013,CTF014,CTF015,CTF016,CTF017,CTF018,CTF019,CTF020,
    DELETEBY,DELETEDATE
  </sql>
  <select id="selectByPrimaryKey" resultMap="BaseResultMap" parameterType="java.lang.String" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    select 
    <include refid="Base_Column_List" />
    from community_factory
    where CTF001 = #{ctf001,jdbcType=VARCHAR}
  </select>
 <!-- <delete id="deleteByPrimaryKey" parameterType="java.lang.String" >
    &lt;!&ndash;
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    &ndash;&gt;
    delete from community_factory
    where CTF001 = #{ctf001,jdbcType=VARCHAR}
  </delete>-->

  <update id="deleteByPrimaryKey" parameterType="java.lang.String" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    UPDATE community_factory set aae100='0'
    where CTF001 = #{ctf001,jdbcType=VARCHAR}
  </update>

  <insert id="insert" parameterType="com.tdkj.model.CommunityFactory" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    insert into community_factory (CTF001, CTF002, CTF003, 
      CTF004, CTF005, CTF006, 
      CTF007, CTF008, CTF009, 
      CTF010, CTF011, AAB301, 
      AAE011, AAE036,DATASOURCE,AAE100,UPDATEDATE,UPDATEBY,CREATEBY,AAE012,CTF012,CTF013,CTF014,CTF015,CTF016,CTF017,CTF018,CTF019,CTF020,DELETEBY,DELETEDATE)
    values (#{ctf001,jdbcType=VARCHAR}, #{ctf002,jdbcType=VARCHAR}, #{ctf003,jdbcType=VARCHAR}, 
      #{ctf004,jdbcType=VARCHAR}, #{ctf005,jdbcType=VARCHAR}, #{ctf006,jdbcType=VARCHAR},
      #{ctf007,jdbcType=DECIMAL}, #{ctf008,jdbcType=DECIMAL}, #{ctf009,jdbcType=VARCHAR}, 
      #{ctf010,jdbcType=VARCHAR}, #{ctf011,jdbcType=VARCHAR}, #{aab301,jdbcType=VARCHAR}, 
      #{aae011,jdbcType=VARCHAR}, #{aae036,jdbcType=TIMESTAMP},#{datasource,jdbcType=VARCHAR},
      #{aae100,jdbcType=VARCHAR},#{updatedate,jdbcType=TIMESTAMP},#{updateby,jdbcType=VARCHAR},
      #{createby,jdbcType=VARCHAR},#{aae012,jdbcType=VARCHAR}, #{ctf012,jdbcType=VARCHAR}, #{ctf013,jdbcType=VARCHAR}
    , #{ctf014,jdbcType=VARCHAR},#{ctf015,jdbcType=VARCHAR},#{ctf016,jdbcType=VARCHAR},
    #{ctf017,jdbcType=VARCHAR},#{ctf018,jdbcType=VARCHAR},#{ctf019,jdbcType=VARCHAR},#{ctf020,jdbcType=VARCHAR},
    #{deleteby,jdbcType=VARCHAR},#{deletedate,jdbcType=TIMESTAMP})
  </insert>
  <insert id="insertSelective" parameterType="com.tdkj.model.CommunityFactory" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    insert into community_factory
    <trim prefix="(" suffix=")" suffixOverrides="," >
      <if test="ctf001 != null" >
        CTF001,
      </if>
      <if test="ctf002 != null" >
        CTF002,
      </if>
      <if test="ctf003 != null" >
        CTF003,
      </if>
      <if test="ctf004 != null" >
        CTF004,
      </if>
      <if test="ctf005 != null" >
        CTF005,
      </if>
      <if test="ctf006 != null" >
        CTF006,
      </if>
      <if test="ctf007 != null" >
        CTF007,
      </if>
      <if test="ctf008 != null" >
        CTF008,
      </if>
      <if test="ctf009 != null" >
        CTF009,
      </if>
      <if test="ctf010 != null" >
        CTF010,
      </if>
      <if test="ctf011 != null" >
        CTF011,
      </if>
      <if test="ctf012 != null" >
        CTF012,
      </if>
      <if test="ctf013 != null" >
        CTF013,
      </if>
      <if test="ctf014 != null" >
        CTF014,
      </if>
      <if test="ctf015 != null" >
        CTF015,
      </if>
      <if test="ctf016 != null" >
        CTF016,
      </if>
      <if test="ctf017 != null" >
        CTF017,
      </if>
      <if test="ctf018 != null" >
        CTF018,
      </if>
      <if test="ctf019 != null" >
        CTF019,
      </if>
      <if test="ctf020 != null" >
        CTF020,
      </if>
      <if test="aab301 != null" >
        AAB301,
      </if>
      <if test="aae011 != null" >
        AAE011,
      </if>
      <if test="aae036 != null" >
        AAE036,
      </if>
      <if test="datasource != null" >
        DATASOURCE,
      </if>
      <if test="aae100 != null" >
        AAE100,
      </if>
      <if test="updatedate != null" >
        UPDATEDATE,
      </if>
      <if test="updateby != null" >
        UPDATEBY,
      </if>
      <if test="createby != null" >
        CREATEBY,
      </if>
      <if test="aae012 != null" >
        AAE012,
      </if>
      <if test="deleteby != null" >
        DELETEBY,
      </if>
      <if test="deletedate != null" >
        DELETEDATE,
      </if>
    </trim>
    <trim prefix="values (" suffix=")" suffixOverrides="," >
      <if test="ctf001 != null" >
        #{ctf001,jdbcType=VARCHAR},
      </if>
      <if test="ctf002 != null" >
        #{ctf002,jdbcType=VARCHAR},
      </if>
      <if test="ctf003 != null" >
        #{ctf003,jdbcType=VARCHAR},
      </if>
      <if test="ctf004 != null" >
        #{ctf004,jdbcType=VARCHAR},
      </if>
      <if test="ctf005 != null" >
        #{ctf005,jdbcType=VARCHAR},
      </if>
      <if test="ctf006 != null" >
        #{ctf006,jdbcType=VARCHAR},
      </if>
      <if test="ctf007 != null" >
        #{ctf007,jdbcType=DECIMAL},
      </if>
      <if test="ctf008 != null" >
        #{ctf008,jdbcType=DECIMAL},
      </if>
      <if test="ctf009 != null" >
        #{ctf009,jdbcType=VARCHAR},
      </if>
      <if test="ctf010 != null" >
        #{ctf010,jdbcType=VARCHAR},
      </if>
      <if test="ctf011 != null" >
        #{ctf011,jdbcType=VARCHAR},
      </if>
      <if test="ctf012 != null" >
        #{ctf012,jdbcType=VARCHAR},
      </if>
      <if test="ctf013 != null" >
        #{ctf013,jdbcType=VARCHAR},
      </if>
      <if test="ctf014 != null" >
        #{ctf014,jdbcType=VARCHAR},
      </if>
      <if test="ctf015 != null" >
        #{ctf015,jdbcType=VARCHAR},
      </if>
      <if test="ctf016 != null" >
        #{ctf016,jdbcType=VARCHAR},
      </if>
      <if test="ctf017 != null" >
        #{ctf017,jdbcType=VARCHAR},
      </if>
      <if test="ctf018 != null" >
        #{ctf018,jdbcType=VARCHAR},
      </if>
      <if test="ctf019 != null" >
        #{ctf019,jdbcType=VARCHAR},
      </if>
      <if test="ctf020 != null" >
        #{ctf020,jdbcType=VARCHAR},
      </if>
      <if test="aab301 != null" >
        #{aab301,jdbcType=VARCHAR},
      </if>
      <if test="aae011 != null" >
        #{aae011,jdbcType=VARCHAR},
      </if>
      <if test="aae036 != null" >
        #{aae036,jdbcType=TIMESTAMP},
      </if>
      <if test="datasource != null" >
        #{datasource,jdbcType=VARCHAR},
      </if>
      <if test="aae100 != null" >
        #{aae100,jdbcType=VARCHAR},
      </if>
      <if test="updatedate != null" >
        #{updatedate,jdbcType=TIMESTAMP},
      </if>
      <if test="updateby != null" >
        #{updateby,jdbcType=VARCHAR},
      </if>
      <if test="createby != null" >
        #{createby,jdbcType=VARCHAR},
      </if>
      <if test="aae012 != null" >
        #{aae012,jdbcType=VARCHAR},
      </if>
      <if test="deleteby != null" >
        #{deleteby,jdbcType=VARCHAR},
      </if>
      <if test="deletedate != null" >
        #{deletedate,jdbcType=TIMESTAMP},
      </if>
    </trim>
  </insert>
  <update id="updateByPrimaryKeySelective" parameterType="com.tdkj.model.CommunityFactory" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    update community_factory
    <set >
      <if test="ctf002 != null" >
        CTF002 = #{ctf002,jdbcType=VARCHAR},
      </if>
      <if test="ctf003 != null" >
        CTF003 = #{ctf003,jdbcType=VARCHAR},
      </if>
      <if test="ctf004 != null" >
        CTF004 = #{ctf004,jdbcType=VARCHAR},
      </if>
      <if test="ctf005 != null" >
        CTF005 = #{ctf005,jdbcType=VARCHAR},
      </if>
      <if test="ctf006 != null" >
        CTF006 = #{ctf006,jdbcType=VARCHAR},
      </if>
      <if test="ctf007 != null" >
        CTF007 = #{ctf007,jdbcType=DECIMAL},
      </if>
      <if test="ctf008 != null" >
        CTF008 = #{ctf008,jdbcType=DECIMAL},
      </if>
      <if test="ctf009 != null" >
        CTF009 = #{ctf009,jdbcType=VARCHAR},
      </if>
      <if test="ctf010 != null" >
        CTF010 = #{ctf010,jdbcType=VARCHAR},
      </if>
      <if test="ctf011 != null" >
        CTF011 = #{ctf011,jdbcType=VARCHAR},
      </if>
      <if test="ctf012 != null" >
        CTF012 = #{ctf012,jdbcType=VARCHAR},
      </if>
      <if test="ctf013 != null" >
        CTF013 = #{ctf013,jdbcType=VARCHAR},
      </if>
      <if test="ctf014 != null" >
        CTF014 = #{ctf014,jdbcType=VARCHAR},
      </if>
      <if test="ctf015 != null" >
        CTF015 = #{ctf015,jdbcType=VARCHAR},
      </if>
      <if test="ctf016 != null" >
        CTF016 = #{ctf016,jdbcType=VARCHAR},
      </if>
      <if test="ctf017 != null" >
        CTF017 = #{ctf017,jdbcType=VARCHAR},
      </if>
      <if test="ctf018 != null" >
        CTF018 = #{ctf018,jdbcType=VARCHAR},
      </if>
      <if test="ctf019 != null" >
        CTF019 = #{ctf019,jdbcType=VARCHAR},
      </if>
      <if test="ctf020 != null" >
        CTF020 = #{ctf020,jdbcType=VARCHAR},
      </if>
      <if test="aab301 != null" >
        AAB301 = #{aab301,jdbcType=VARCHAR},
      </if>
      <if test="aae011 != null" >
        AAE011 = #{aae011,jdbcType=VARCHAR},
      </if>
      <if test="aae036 != null" >
        AAE036 = #{aae036,jdbcType=TIMESTAMP},
      </if>
      <if test="datasource != null" >
        DATASOURCE = #{datasource,jdbcType=VARCHAR},
      </if>
      <if test="aae100 != null" >
        AAE100 = #{aae100,jdbcType=VARCHAR},
      </if>
      <if test="updatedate != null" >
        UPDATEDATE = #{updatedate,jdbcType=TIMESTAMP},
      </if>
      <if test="updateby != null" >
        UPDATEBY = #{updateby,jdbcType=VARCHAR},
      </if>
      <if test="createby != null" >
        CREATEBY = #{createby,jdbcType=VARCHAR},
      </if>
      <if test="aae012 != null" >
        AAE012 = #{aae012,jdbcType=VARCHAR},
      </if>
      <if test="deleteby != null" >
        DELETEBY = #{deleteby,jdbcType=VARCHAR},
      </if>
      <if test="deletedate != null" >
        DELETEDATE = #{deletedate,jdbcType=TIMESTAMP},
      </if>
    </set>
    where CTF001 = #{ctf001,jdbcType=VARCHAR}
  </update>
  <update id="updateByPrimaryKey" parameterType="com.tdkj.model.CommunityFactory" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    update community_factory
    set CTF002 = #{ctf002,jdbcType=VARCHAR},
      CTF003 = #{ctf003,jdbcType=VARCHAR},
      CTF004 = #{ctf004,jdbcType=VARCHAR},
      CTF005 = #{ctf005,jdbcType=VARCHAR},
      CTF006 = #{ctf006,jdbcType=VARCHAR},
      CTF007 = #{ctf007,jdbcType=DECIMAL},
      CTF008 = #{ctf008,jdbcType=DECIMAL},
      CTF009 = #{ctf009,jdbcType=VARCHAR},
      CTF010 = #{ctf010,jdbcType=VARCHAR},
      CTF011 = #{ctf011,jdbcType=VARCHAR},
      CTF012 = #{ctf012,jdbcType=VARCHAR},
      CTF013 = #{ctf013,jdbcType=VARCHAR},
      CTF014 = #{ctf014,jdbcType=VARCHAR},
      CTF015 = #{ctf015,jdbcType=VARCHAR},
      CTF016 = #{ctf016,jdbcType=VARCHAR},
    CTF017 = #{ctf017,jdbcType=VARCHAR},
    CTF018 = #{ctf018,jdbcType=VARCHAR},
    CTF019 = #{ctf019,jdbcType=VARCHAR},
    CTF020 = #{ctf020,jdbcType=VARCHAR},
      AAB301 = #{aab301,jdbcType=VARCHAR},
      AAE011 = #{aae011,jdbcType=VARCHAR},
      AAE036 = #{aae036,jdbcType=TIMESTAMP},
      DATASOURCE = #{datasource,jdbcType=VARCHAR},
      AAE100 = #{aae100,jdbcType=VARCHAR},
      UPDATEDATE = #{updatedate,jdbcType=TIMESTAMP},
      UPDATEBY = #{updateby,jdbcType=VARCHAR},
      CREATEBY = #{createby,jdbcType=VARCHAR},
      AAE012 = #{aae012,jdbcType=VARCHAR},
      DELETEBY = #{deleteby,jdbcType=VARCHAR},
      DELETEDATE = #{deletedate,jdbcType=TIMESTAMP}
    where CTF001 = #{ctf001,jdbcType=VARCHAR}
  </update>

  <!--根据行政区划查询社区工厂信息-->
  <!--根据行政区划查询社区工厂信息-->
  <select id="queryCommunityFactoryByAab301" resultMap="BaseResultMap" parameterType="java.lang.String" >
    select CTF001, CTF002, CTF003, CTF004, CTF005, CTF006, CTF007, CTF008, CTF009, CTF010, CTF011,CTF012,CTF013,CTF014,CTF015,CTF016,CTF017,CTF018,CTF019,CTF020,
    AAB301, AAE011, AAE036,DATASOURCE,AAE100,UPDATEDATE,UPDATEBY,CREATEBY,AAE012,rn,DELETEBY,DELETEDATE
    from (select CTF001, CTF002, CTF003, CTF004, CTF005, CTF006, CTF007, CTF008, CTF009, CTF010, CTF011,CTF012,CTF013,CTF014,CTF015,CTF016,CTF017,CTF018,CTF019,CTF020,
    AAB301, AAE011, AAE036,DATASOURCE,AAE100,UPDATEDATE,UPDATEBY,CREATEBY,AAE012, rownum rn,DELETEBY,DELETEDATE
    from (
    select
    CTF001, CTF002, CTF003,
    (select cts002 from centralized_settlements where cts001=CTF004)CTF004,
    CTF005, CTF006, CTF007, CTF008, CTF009, CTF010, CTF011,CTF012,CTF013,CTF014,f_getcodename('EDC441', CTF015)CTF015,f_getcodename('EDC441', CTF016)CTF016,
    f_getcodename('EDC441', CTF017)CTF017,CTF018,CTF019,CTF020,DELETEBY,DELETEDATE,
    t.INFO AAB301,
    AAE011, AAE036,DATASOURCE,AAE100,UPDATEDATE,UPDATEBY,CREATEBY,AAE012
    from community_factory,POOR_XZQH t where AAB301=t.XZQHBM
    <if test="communityFactory.taizhang != null and communityFactory.taizhang !='' and communityFactory.aae100=='1'.toString()  " >
      and aae100='1' and (select count(r.companyid) from relation r,poor_labor_force p where r.peopleid=p.plf001 and  r.aae100 = '1'and p.aae100='1'
      and ctf001 =r.companyid)>=1
      and ctf006 is null
    </if>
    <if test="communityFactory.taizhang != null and communityFactory.taizhang !='' and communityFactory.aae100=='0'.toString()  " >
      and aae100='1' and ctf006 is not null
    </if>
    <if test="communityFactory.taizhang == null or communityFactory.taizhang =='' " >
      and aae100='1'
    </if>
    /*待完善条件 */
    <if test="communityFactory.istobecomplete != null  and communityFactory.istobecomplete !='' ">
      and (CTF005 is null or CTF015 is null or (CTF015 ='1' and CTF004 is null))
    </if>
    <if test="communityFactory.aab301 != null and communityFactory.aab301 !='' " >
      and AAB301 like #{communityFactory.aab301,jdbcType=VARCHAR}
    </if>
    <if test="communityFactory.ctf002 != null and communityFactory.ctf002 !='' " >
      and CTF002 like #{communityFactory.ctf002,jdbcType=VARCHAR}
    </if>
    <if test="communityFactory.ctf003 != null and communityFactory.ctf003 !='' " >
      and CTF003 = #{communityFactory.ctf003,jdbcType=VARCHAR}
    </if>
    <if test="communityFactory.ctf004 != null and communityFactory.ctf004 !=''" >
      and CTF004 = #{communityFactory.ctf004,jdbcType=VARCHAR}
    </if>
    <if test="communityFactory.ctf005 != null and communityFactory.ctf005 !='' " >
      and substr(CTF005,0,4)  = #{communityFactory.ctf005,jdbcType=VARCHAR}
    </if>
    <if test="communityFactory.ctf006 != null and communityFactory.ctf006 !='' " >
      and  CTF006 = #{communityFactory.ctf006,jdbcType=VARCHAR}
    </if>
    <if test="communityFactory.ctf007 != null and communityFactory.ctf007 !='' " >
      and  CTF007 = #{communityFactory.ctf007,jdbcType=DECIMAL}
    </if>
    <if test="communityFactory.ctf008 != null and communityFactory.ctf008 !='' " >
      and  CTF008 = #{communityFactory.ctf008,jdbcType=DECIMAL}
    </if>
    <if test="communityFactory.ctf009 != null and communityFactory.ctf009 !='' " >
      and  CTF009 = #{communityFactory.ctf009,jdbcType=VARCHAR}
    </if>
    <if test="communityFactory.ctf010 != null and communityFactory.ctf010 !='' " >
      and  CTF010 = #{communityFactory.ctf010,jdbcType=VARCHAR}
    </if>
    <if test="communityFactory.ctf011 != null and communityFactory.ctf011 !='' " >
      and  CTF011 = #{communityFactory.ctf011,jdbcType=VARCHAR}
    </if>
    <if test="communityFactory.ctf012 != null and communityFactory.ctf012 !='' " >
      and  CTF012 = #{communityFactory.ctf012,jdbcType=VARCHAR}
    </if>
    <if test="communityFactory.ctf013 != null and communityFactory.ctf013 !='' " >
      and  CTF013 = #{communityFactory.ctf013,jdbcType=VARCHAR}
    </if>
    <if test="communityFactory.ctf014 != null and communityFactory.ctf014 !='' " >
      and  CTF014 = #{communityFactory.ctf014,jdbcType=VARCHAR}
    </if>
    <if test="communityFactory.ctf015 != null and communityFactory.ctf015 !='' " >
      and  CTF015 = #{communityFactory.ctf015,jdbcType=VARCHAR}
    </if>
    <if test="communityFactory.ctf016 != null and communityFactory.ctf016 !='' " >
      and  CTF016 = #{communityFactory.ctf016,jdbcType=VARCHAR}
    </if>
    <if test="communityFactory.ctf017 != null and communityFactory.ctf017 !='' " >
      and  CTF017 = #{communityFactory.ctf017,jdbcType=VARCHAR}
    </if>
    <if test="communityFactory.ctf018 != null and communityFactory.ctf018 !='' " >
      and  CTF018 = #{communityFactory.ctf018,jdbcType=VARCHAR}
    </if>
    <if test="communityFactory.ctf019 != null and communityFactory.ctf019 !='' " >
      and  CTF019 = #{communityFactory.ctf019,jdbcType=VARCHAR}
    </if>
    <if test="communityFactory.ctf020 != null and communityFactory.ctf020 !='' " >
      and  CTF020 = #{communityFactory.ctf020,jdbcType=VARCHAR}
    </if>
    <if test="communityFactory.aae011 != null and communityFactory.aae011 !='' " >
      and  AAE011 = #{communityFactory.aae011,jdbcType=VARCHAR}
    </if>
    <if test="communityFactory.aae036 != null and communityFactory.aae036 !='' " >
      and  AAE036 = #{communityFactory.aae036,jdbcType=TIMESTAMP}
    </if>
    <if test="communityFactory.datasource != null and communityFactory.datasource !='' " >
      and  DATASOURCE = #{communityFactory.datasource,jdbcType=VARCHAR}
    </if>

    <if test="communityFactory.updatedate != null and communityFactory.updatedate !='' " >
      and  UPDATEDATE = #{communityFactory.updatedate,jdbcType=TIMESTAMP}
    </if>
    <if test="communityFactory.updateby != null and communityFactory.updateby !='' " >
      and  UPDATEBY = #{communityFactory.updateby,jdbcType=VARCHAR}
    </if>
    <if test="communityFactory.createby != null and communityFactory.createby !='' " >
      and  CREATEBY = #{communityFactory.createby,jdbcType=VARCHAR}
    </if>
    <if test="communityFactory.aae012 != null and communityFactory.aae012 !='' " >
      and  AAE012 = #{communityFactory.aae012,jdbcType=VARCHAR}
    </if>
    ) a1
    where rownum &lt;= #{pageSize})
    where rn &gt;= #{startRecord}

  </select>


  <!--根据行政区划查询社区工厂总条数-->
  <select id="queryAllByAab301" resultType="java.lang.String" parameterType="java.lang.String" >
    select count(1)
    from community_factory
    where  AAB301 like #{communityFactory.aab301,jdbcType=VARCHAR}
    <if test="communityFactory.taizhang != null and communityFactory.taizhang !='' and communityFactory.aae100=='1'.toString()  " >
      and aae100='1' and (select count(r.companyid) from relation r,poor_labor_force p where r.peopleid=p.plf001 and  r.aae100 = '1'and p.aae100='1'
      and ctf001 =r.companyid)>=1
      and ctf006 is null
    </if>
    <if test="communityFactory.taizhang != null and communityFactory.taizhang !='' and communityFactory.aae100=='0'.toString()  " >
      and aae100='1' and ctf006 is not null
    </if>
    <if test="communityFactory.taizhang == null or communityFactory.taizhang =='' " >
      and aae100='1'
    </if>
    /*待完善条件 */
    <if test="communityFactory.istobecomplete != null  and communityFactory.istobecomplete !='' ">
      and (CTF005 is null or CTF015 is null or (CTF015 ='1' and CTF004 is null))
    </if>
    <if test="communityFactory.ctf002 != null and communityFactory.ctf002 !='' " >
      and CTF002 like #{communityFactory.ctf002,jdbcType=VARCHAR}
    </if>
    <if test="communityFactory.ctf003 != null and communityFactory.ctf003 !='' " >
      and CTF003 = #{communityFactory.ctf003,jdbcType=VARCHAR}
    </if>
    <if test="communityFactory.ctf004 != null and communityFactory.ctf004 !=''" >
      and CTF004 = #{communityFactory.ctf004,jdbcType=VARCHAR}
    </if>
    <if test="communityFactory.ctf005 != null and communityFactory.ctf005 !='' " >
      and substr(CTF005,0,4)  = #{communityFactory.ctf005,jdbcType=VARCHAR}
    </if>
    <if test="communityFactory.ctf006 != null and communityFactory.ctf006 !='' " >
      and  CTF006 = #{communityFactory.ctf006,jdbcType=VARCHAR}
    </if>
    <if test="communityFactory.ctf007 != null and communityFactory.ctf007 !='' " >
      and  CTF007 = #{communityFactory.ctf007,jdbcType=DECIMAL}
    </if>
    <if test="communityFactory.ctf008 != null and communityFactory.ctf008 !='' " >
      and  CTF008 = #{communityFactory.ctf008,jdbcType=DECIMAL}
    </if>
    <if test="communityFactory.ctf009 != null and communityFactory.ctf009 !='' " >
      and  CTF009 = #{communityFactory.ctf009,jdbcType=VARCHAR}
    </if>
    <if test="communityFactory.ctf010 != null and communityFactory.ctf010 !='' " >
      and  CTF010 = #{communityFactory.ctf010,jdbcType=VARCHAR}
    </if>
    <if test="communityFactory.ctf011 != null and communityFactory.ctf011 !='' " >
      and  CTF011 = #{communityFactory.ctf011,jdbcType=VARCHAR}
    </if>
    <if test="communityFactory.ctf012 != null and communityFactory.ctf012 !='' " >
      and  CTF012 = #{communityFactory.ctf012,jdbcType=VARCHAR}
    </if>
    <if test="communityFactory.ctf013 != null and communityFactory.ctf013 !='' " >
      and  CTF013 = #{communityFactory.ctf013,jdbcType=VARCHAR}
    </if>
    <if test="communityFactory.ctf014 != null and communityFactory.ctf014 !='' " >
      and  CTF014 = #{communityFactory.ctf014,jdbcType=VARCHAR}
    </if>
    <if test="communityFactory.ctf015 != null and communityFactory.ctf015 !='' " >
      and  CTF015 = #{communityFactory.ctf015,jdbcType=VARCHAR}
    </if>
    <if test="communityFactory.ctf016 != null and communityFactory.ctf016 !='' " >
      and  CTF016 = #{communityFactory.ctf016,jdbcType=VARCHAR}
    </if>
    <if test="communityFactory.ctf017 != null and communityFactory.ctf017 !='' " >
      and  CTF017 = #{communityFactory.ctf017,jdbcType=VARCHAR}
    </if>
    <if test="communityFactory.ctf018 != null and communityFactory.ctf018 !='' " >
      and  CTF018 = #{communityFactory.ctf018,jdbcType=VARCHAR}
    </if>
    <if test="communityFactory.ctf019 != null and communityFactory.ctf019 !='' " >
      and  CTF019 = #{communityFactory.ctf019,jdbcType=VARCHAR}
    </if>
    <if test="communityFactory.ctf020 != null and communityFactory.ctf020 !='' " >
      and  CTF020 = #{communityFactory.ctf020,jdbcType=VARCHAR}
    </if>
    <if test="communityFactory.aae011 != null and communityFactory.aae011 !='' " >
      and  AAE011 = #{communityFactory.aae011,jdbcType=VARCHAR}
    </if>
    <if test="communityFactory.aae036 != null and communityFactory.aae036 !='' " >
      and  AAE036 = #{communityFactory.aae036,jdbcType=TIMESTAMP}
    </if>
    <if test="communityFactory.datasource != null and communityFactory.datasource !='' " >
      and  DATASOURCE = #{communityFactory.datasource,jdbcType=VARCHAR}
    </if>

    <if test="communityFactory.updatedate != null and communityFactory.updatedate !='' " >
      and  UPDATEDATE = #{communityFactory.updatedate,jdbcType=TIMESTAMP}
    </if>
    <if test="communityFactory.updateby != null and communityFactory.updateby !='' " >
      and  UPDATEBY = #{communityFactory.updateby,jdbcType=VARCHAR}
    </if>
    <if test="communityFactory.createby != null and communityFactory.createby !='' " >
      and  CREATEBY = #{communityFactory.createby,jdbcType=VARCHAR}
    </if>
    <if test="communityFactory.aae012 != null and communityFactory.aae012 !='' " >
      and  AAE012 = #{communityFactory.aae012,jdbcType=VARCHAR}
    </if>
  </select>



<!--待完善社区工厂信息查询开始-->

  <!--根据行政区划查询社区工厂信息-->
  <!--根据行政区划查询社区工厂信息-->
  <select id="querytobeCompleteFactoryByAab301" resultMap="BaseResultMap" parameterType="java.lang.String" >
    select CTF001, CTF002, CTF003, CTF004, CTF005, CTF006, CTF007, CTF008, CTF009, CTF010, CTF011,CTF012,CTF013,CTF014,CTF015,CTF016,CTF017,CTF018,CTF019,CTF020,
    AAB301, AAE011, AAE036,DATASOURCE,AAE100,UPDATEDATE,UPDATEBY,CREATEBY,AAE012,rn,DELETEBY,DELETEDATE
    from (select CTF001, CTF002, CTF003, CTF004, CTF005, CTF006, CTF007, CTF008, CTF009, CTF010, CTF011,CTF012,CTF013,CTF014,CTF015,CTF016,CTF017,CTF018,CTF019,CTF020,
    AAB301, AAE011, AAE036,DATASOURCE,AAE100,UPDATEDATE,UPDATEBY,CREATEBY,AAE012, rownum rn,DELETEBY,DELETEDATE
    from (
    select
    CTF001, CTF002, CTF003,
    (select cts002 from centralized_settlements where cts001=CTF004)CTF004,
    CTF005, CTF006, CTF007, CTF008, CTF009, CTF010, CTF011,CTF012,CTF013,CTF014,
    f_getcodename('EDC441', CTF015)CTF015,f_getcodename('EDC441', CTF016)CTF016,
    f_getcodename('EDC441', CTF017)CTF017,CTF018,CTF019,CTF020,DELETEBY,DELETEDATE,
    t.INFO AAB301,
    AAE011, AAE036,DATASOURCE,AAE100,UPDATEDATE,UPDATEBY,CREATEBY,AAE012
    from community_factory,POOR_XZQH t where ctf001 not in  (select r.companyid from relation r where r.aae100 = '1') and AAB301=t.XZQHBM and AAE100='1' and ctf006 is null
    <if test="communityFactory.aab301 != null and communityFactory.aab301 !='' " >
      and AAB301 like #{communityFactory.aab301,jdbcType=VARCHAR}
    </if>
    <if test="communityFactory.ctf002 != null and communityFactory.ctf002 !='' " >
      and CTF002 like #{communityFactory.ctf002,jdbcType=VARCHAR}
    </if>
    <if test="communityFactory.ctf003 != null and communityFactory.ctf003 !='' " >
      and CTF003 = #{communityFactory.ctf003,jdbcType=VARCHAR}
    </if>
    <if test="communityFactory.ctf004 != null and communityFactory.ctf004 !=''" >
      and CTF004 = #{communityFactory.ctf004,jdbcType=VARCHAR}
    </if>
    <if test="communityFactory.ctf005 != null and communityFactory.ctf005 !='' " >
      and substr(CTF005,0,4)  = #{communityFactory.ctf005,jdbcType=VARCHAR}
    </if>
    <if test="communityFactory.ctf006 != null and communityFactory.ctf006 !='' " >
      and  CTF006 = #{communityFactory.ctf006,jdbcType=VARCHAR}
    </if>
    <if test="communityFactory.ctf007 != null and communityFactory.ctf007 !='' " >
      and  CTF007 = #{communityFactory.ctf007,jdbcType=DECIMAL}
    </if>
    <if test="communityFactory.ctf008 != null and communityFactory.ctf008 !='' " >
      and  CTF008 = #{communityFactory.ctf008,jdbcType=DECIMAL}
    </if>
    <if test="communityFactory.ctf009 != null and communityFactory.ctf009 !='' " >
      and  CTF009 = #{communityFactory.ctf009,jdbcType=VARCHAR}
    </if>
    <if test="communityFactory.ctf010 != null and communityFactory.ctf010 !='' " >
      and  CTF010 = #{communityFactory.ctf010,jdbcType=VARCHAR}
    </if>
    <if test="communityFactory.ctf011 != null and communityFactory.ctf011 !='' " >
      and  CTF011 = #{communityFactory.ctf011,jdbcType=VARCHAR}
    </if>
    <if test="communityFactory.ctf012 != null and communityFactory.ctf012 !='' " >
      and  CTF012 = #{communityFactory.ctf012,jdbcType=VARCHAR}
    </if>
    <if test="communityFactory.ctf013 != null and communityFactory.ctf013 !='' " >
      and  CTF013 = #{communityFactory.ctf013,jdbcType=VARCHAR}
    </if>
    <if test="communityFactory.ctf014 != null and communityFactory.ctf014 !='' " >
      and  CTF014 = #{communityFactory.ctf014,jdbcType=VARCHAR}
    </if>
    <if test="communityFactory.ctf015 != null and communityFactory.ctf015 !='' " >
      and  CTF015 = #{communityFactory.ctf015,jdbcType=VARCHAR}
    </if>
    <if test="communityFactory.ctf016 != null and communityFactory.ctf016 !='' " >
      and  CTF016 = #{communityFactory.ctf016,jdbcType=VARCHAR}
    </if>
    <if test="communityFactory.ctf017 != null and communityFactory.ctf017 !='' " >
      and  CTF017 = #{communityFactory.ctf017,jdbcType=VARCHAR}
    </if>
    <if test="communityFactory.ctf018 != null and communityFactory.ctf018 !='' " >
      and  CTF018 = #{communityFactory.ctf018,jdbcType=VARCHAR}
    </if>
    <if test="communityFactory.ctf019 != null and communityFactory.ctf019 !='' " >
      and  CTF019 = #{communityFactory.ctf019,jdbcType=VARCHAR}
    </if>
    <if test="communityFactory.ctf020 != null and communityFactory.ctf020 !='' " >
      and  CTF020 = #{communityFactory.ctf020,jdbcType=VARCHAR}
    </if>
    <if test="communityFactory.aae011 != null and communityFactory.aae011 !='' " >
      and  AAE011 = #{communityFactory.aae011,jdbcType=VARCHAR}
    </if>
    <if test="communityFactory.aae036 != null and communityFactory.aae036 !='' " >
      and  AAE036 = #{communityFactory.aae036,jdbcType=TIMESTAMP}
    </if>
    <if test="communityFactory.datasource != null and communityFactory.datasource !='' " >
      and  DATASOURCE = #{communityFactory.datasource,jdbcType=VARCHAR}
    </if>
    <if test="communityFactory.aae100 != null and communityFactory.aae100 !='' " >
      and AAE100 = #{communityFactory.aae100,jdbcType=VARCHAR}
    </if>
    <if test="communityFactory.updatedate != null and communityFactory.updatedate !='' " >
      and  UPDATEDATE = #{communityFactory.updatedate,jdbcType=TIMESTAMP}
    </if>
    <if test="communityFactory.updateby != null and communityFactory.updateby !='' " >
      and  UPDATEBY = #{communityFactory.updateby,jdbcType=VARCHAR}
    </if>
    <if test="communityFactory.createby != null and communityFactory.createby !='' " >
      and  CREATEBY = #{communityFactory.createby,jdbcType=VARCHAR}
    </if>
    <if test="communityFactory.aae012 != null and communityFactory.aae012 !='' " >
      and  AAE012 = #{communityFactory.aae012,jdbcType=VARCHAR}
    </if>
    ) a1
    where rownum &lt;= #{pageSize})
    where rn &gt;= #{startRecord}

  </select>


  <!--根据行政区划查询社区工厂总条数-->
  <select id="queryAlltobeCompleteFactoryByAab301" resultType="java.lang.String" parameterType="java.lang.String" >
    select count(1)
    from community_factory
    where  ctf001 not in  (select r.companyid from relation r where r.aae100 = '1')  and aae100='1' and AAB301 like #{communityFactory.aab301,jdbcType=VARCHAR} and ctf006 is null
    <if test="communityFactory.ctf002 != null and communityFactory.ctf002 !='' " >
      and CTF002 like #{communityFactory.ctf002,jdbcType=VARCHAR}
    </if>
    <if test="communityFactory.ctf003 != null and communityFactory.ctf003 !='' " >
      and CTF003 = #{communityFactory.ctf003,jdbcType=VARCHAR}
    </if>
    <if test="communityFactory.ctf004 != null and communityFactory.ctf004 !=''" >
      and CTF004 = #{communityFactory.ctf004,jdbcType=VARCHAR}
    </if>
    <if test="communityFactory.ctf005 != null and communityFactory.ctf005 !='' " >
      and substr(CTF005,0,4)  = #{communityFactory.ctf005,jdbcType=VARCHAR}
    </if>
    <if test="communityFactory.ctf006 != null and communityFactory.ctf006 !='' " >
      and  CTF006 = #{communityFactory.ctf006,jdbcType=VARCHAR}
    </if>
    <if test="communityFactory.ctf007 != null and communityFactory.ctf007 !='' " >
      and  CTF007 = #{communityFactory.ctf007,jdbcType=DECIMAL}
    </if>
    <if test="communityFactory.ctf008 != null and communityFactory.ctf008 !='' " >
      and  CTF008 = #{communityFactory.ctf008,jdbcType=DECIMAL}
    </if>
    <if test="communityFactory.ctf009 != null and communityFactory.ctf009 !='' " >
      and  CTF009 = #{communityFactory.ctf009,jdbcType=VARCHAR}
    </if>
    <if test="communityFactory.ctf010 != null and communityFactory.ctf010 !='' " >
      and  CTF010 = #{communityFactory.ctf010,jdbcType=VARCHAR}
    </if>
    <if test="communityFactory.ctf011 != null and communityFactory.ctf011 !='' " >
      and  CTF011 = #{communityFactory.ctf011,jdbcType=VARCHAR}
    </if>
    <if test="communityFactory.ctf012 != null and communityFactory.ctf012 !='' " >
      and  CTF012 = #{communityFactory.ctf012,jdbcType=VARCHAR}
    </if>
    <if test="communityFactory.ctf013 != null and communityFactory.ctf013 !='' " >
      and  CTF013 = #{communityFactory.ctf013,jdbcType=VARCHAR}
    </if>
    <if test="communityFactory.ctf014 != null and communityFactory.ctf014 !='' " >
      and  CTF014 = #{communityFactory.ctf014,jdbcType=VARCHAR}
    </if>
    <if test="communityFactory.ctf015 != null and communityFactory.ctf015 !='' " >
      and  CTF015 = #{communityFactory.ctf015,jdbcType=VARCHAR}
    </if>
    <if test="communityFactory.ctf016 != null and communityFactory.ctf016 !='' " >
      and  CTF016 = #{communityFactory.ctf016,jdbcType=VARCHAR}
    </if>
    <if test="communityFactory.ctf017 != null and communityFactory.ctf017 !='' " >
      and  CTF017 = #{communityFactory.ctf017,jdbcType=VARCHAR}
    </if>
    <if test="communityFactory.ctf018 != null and communityFactory.ctf018 !='' " >
      and  CTF018 = #{communityFactory.ctf018,jdbcType=VARCHAR}
    </if>
    <if test="communityFactory.ctf019 != null and communityFactory.ctf019 !='' " >
      and  CTF019 = #{communityFactory.ctf019,jdbcType=VARCHAR}
    </if>
    <if test="communityFactory.ctf020 != null and communityFactory.ctf020 !='' " >
      and  CTF020 = #{communityFactory.ctf020,jdbcType=VARCHAR}
    </if>
    <if test="communityFactory.aae011 != null and communityFactory.aae011 !='' " >
      and  AAE011 = #{communityFactory.aae011,jdbcType=VARCHAR}
    </if>
    <if test="communityFactory.aae036 != null and communityFactory.aae036 !='' " >
      and  AAE036 = #{communityFactory.aae036,jdbcType=TIMESTAMP}
    </if>
    <if test="communityFactory.datasource != null and communityFactory.datasource !='' " >
      and  DATASOURCE = #{communityFactory.datasource,jdbcType=VARCHAR}
    </if>
    <if test="communityFactory.aae100 != null and communityFactory.aae100 !='' " >
      and AAE100 = #{communityFactory.aae100,jdbcType=VARCHAR}
    </if>
    <if test="communityFactory.updatedate != null and communityFactory.updatedate !='' " >
      and  UPDATEDATE = #{communityFactory.updatedate,jdbcType=TIMESTAMP}
    </if>
    <if test="communityFactory.updateby != null and communityFactory.updateby !='' " >
      and  UPDATEBY = #{communityFactory.updateby,jdbcType=VARCHAR}
    </if>
    <if test="communityFactory.createby != null and communityFactory.createby !='' " >
      and  CREATEBY = #{communityFactory.createby,jdbcType=VARCHAR}
    </if>
    <if test="communityFactory.aae012 != null and communityFactory.aae012 !='' " >
      and  AAE012 = #{communityFactory.aae012,jdbcType=VARCHAR}
    </if>
  </select>
</mapper>