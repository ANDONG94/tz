<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.tdkj.dao.InformationCollection.TrainingSituationMapper" >
  <resultMap id="BaseResultMap" type="com.tdkj.model.TrainingSituation" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    <id column="TSN001" property="tsn001" jdbcType="VARCHAR" />
    <result column="TSN010" property="tsn010" jdbcType="VARCHAR" />
    <result column="TSN003" property="tsn003" jdbcType="VARCHAR" />
    <result column="TSN004" property="tsn004" jdbcType="VARCHAR" />
    <result column="TSN005" property="tsn005" jdbcType="VARCHAR" />
    <result column="TSN006" property="tsn006" jdbcType="VARCHAR" />
    <result column="TSN007" property="tsn007" jdbcType="VARCHAR" />
    <result column="TSN008" property="tsn008" jdbcType="VARCHAR" />
    <result column="TSN002" property="tsn002" jdbcType="VARCHAR" />
    <result column="TSN009" property="tsn009" jdbcType="VARCHAR" />
    <result column="AAB301" property="aab301" jdbcType="VARCHAR" />
    <result column="AAE036" property="aae036" jdbcType="TIMESTAMP" />
    <result column="AAE011" property="aae011" jdbcType="VARCHAR" />
    <result column="TSN011" property="tsn011" jdbcType="VARCHAR" />
    <result column="DATASOURCE" property="datasource" jdbcType="VARCHAR" />
    <result column="AAE100" property="aae100" jdbcType="VARCHAR" />
    <result column="UPDATEDATE" property="updatedate" jdbcType="TIMESTAMP" />
    <result column="UPDATEBY" property="updateby" jdbcType="VARCHAR" />
    <result column="CREATEBY" property="createby" jdbcType="VARCHAR" />
    <result column="AAE012" property="aae012" jdbcType="VARCHAR" />
    <result column="TSN012" property="tsn012" jdbcType="VARCHAR" />
    <result column="TSN013" property="tsn013" jdbcType="VARCHAR" />
    <result column="TSN014" property="tsn014" jdbcType="VARCHAR" />
    <result column="TSN015" property="tsn015" jdbcType="VARCHAR" />
    <result column="TSN016" property="tsn016" jdbcType="VARCHAR" />
    <result column="ISNEW" property="isnew" jdbcType="VARCHAR" />
    <result column="DELETEBY" property="deleteby" jdbcType="VARCHAR" />
    <result column="DELETEDATE" property="deletedate" jdbcType="TIMESTAMP" />

  </resultMap>

  <resultMap id="TsnPlfResultMap" type="com.tdkj.model.TsnPlf" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    <id column="TSN001" property="tsn001" jdbcType="VARCHAR" />
    <result column="TSN010" property="tsn010" jdbcType="VARCHAR" />
    <result column="TSN003" property="tsn003" jdbcType="VARCHAR" />
    <result column="TSN004" property="tsn004" jdbcType="VARCHAR" />
    <result column="TSN005" property="tsn005" jdbcType="VARCHAR" />
    <result column="TSN006" property="tsn006" jdbcType="VARCHAR" />
    <result column="TSN007" property="tsn007" jdbcType="VARCHAR" />
    <result column="TSN008" property="tsn008" jdbcType="VARCHAR" />
    <result column="TSN002" property="tsn002" jdbcType="VARCHAR" />
    <result column="TSN009" property="tsn009" jdbcType="VARCHAR" />
    <result column="AAB301" property="aab301" jdbcType="VARCHAR" />
    <result column="AAE036" property="aae036" jdbcType="TIMESTAMP" />
    <result column="AAE011" property="aae011" jdbcType="VARCHAR" />
    <result column="TSN011" property="tsn011" jdbcType="VARCHAR" />
    <result column="DATASOURCE" property="datasource" jdbcType="VARCHAR" />
    <result column="AAE100" property="aae100" jdbcType="VARCHAR" />
    <result column="UPDATEDATE" property="updatedate" jdbcType="TIMESTAMP" />
    <result column="UPDATEBY" property="updateby" jdbcType="VARCHAR" />
    <result column="CREATEBY" property="createby" jdbcType="VARCHAR" />
    <result column="AAE012" property="aae012" jdbcType="VARCHAR" />
    <result column="TSN012" property="tsn012" jdbcType="VARCHAR" />
    <result column="TSN013" property="tsn013" jdbcType="VARCHAR" />
    <result column="TSN014" property="tsn014" jdbcType="VARCHAR" />
    <result column="TSN015" property="tsn015" jdbcType="VARCHAR" />
    <result column="TSN016" property="tsn016" jdbcType="VARCHAR" />
    <result column="ISNEW" property="isnew" jdbcType="VARCHAR" />

    <result column="PLF001" property="plf001" jdbcType="VARCHAR" />
    <result column="PLF002" property="plf002" jdbcType="VARCHAR" />
    <result column="PLF004" property="plf004" jdbcType="VARCHAR" />
    <result column="PLF005" property="plf005" jdbcType="VARCHAR" />
    <result column="PLF006" property="plf006" jdbcType="VARCHAR" />
    <result column="PLF007" property="plf007" jdbcType="VARCHAR" />
    <result column="PLF008" property="plf008" jdbcType="VARCHAR" />
    <result column="PLF009" property="plf009" jdbcType="VARCHAR" />
    <result column="PLF010" property="plf010" jdbcType="VARCHAR" />
    <result column="PLF011" property="plf011" jdbcType="VARCHAR" />
    <result column="PLF012" property="plf012" jdbcType="VARCHAR" />
    <result column="PLF013" property="plf013" jdbcType="VARCHAR" />
    <result column="PLF014" property="plf014" jdbcType="VARCHAR" />
    <result column="AAE011" property="aae011" jdbcType="VARCHAR" />
    <result column="AAE036" property="aae036" jdbcType="TIMESTAMP" />
    <result column="PLF016" property="plf016" jdbcType="VARCHAR" />
    <result column="PLF015" property="plf015" jdbcType="VARCHAR" />
    <result column="PLF017" property="plf017" jdbcType="VARCHAR" />
    <result column="PLF018" property="plf018" jdbcType="VARCHAR" />
    <result column="PLF019" property="plf019" jdbcType="VARCHAR" />
    <result column="PLF020" property="plf020" jdbcType="VARCHAR" />
    <result column="PLF021" property="plf021" jdbcType="VARCHAR" />
    <result column="PLF022" property="plf022" jdbcType="VARCHAR" />
    <result column="PLF023" property="plf023" jdbcType="VARCHAR" />
    <result column="PLF024" property="plf024" jdbcType="VARCHAR" />
    <result column="DELETEBY" property="deleteby" jdbcType="VARCHAR" />
    <result column="DELETEDATE" property="deletedate" jdbcType="TIMESTAMP" />

  </resultMap>
  <sql id="Base_Column_List" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    TSN001, TSN010, TSN003, TSN004, TSN005, TSN006, TSN007, TSN008, TSN002, TSN009, AAB301, 
    AAE036, AAE011, TSN011,DATASOURCE,AAE100,UPDATEDATE,UPDATEBY,CREATEBY,AAE012,TSN012,TSN013,TSN014,TSN015,TSN016,ISNEW,DELETEBY,DELETEDATE
  </sql>
  <select id="selectByPrimaryKey" resultMap="BaseResultMap" parameterType="java.lang.String" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    select 
    <include refid="Base_Column_List" />
    from training_situation
    where TSN001 = #{tsn001,jdbcType=VARCHAR}
  </select>
  <!--<delete id="deleteByPrimaryKey" parameterType="java.lang.String" >
    &lt;!&ndash;
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    &ndash;&gt;
    delete from training_situation
    where TSN001 = #{tsn001,jdbcType=VARCHAR}
  </delete>-->

  <update id="deleteByPrimaryKey" parameterType="java.lang.String" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    update training_situation set aae100='0'
    where TSN001 = #{tsn001,jdbcType=VARCHAR}
  </update>

  <!--根据劳动力id 修改是否最新字段-->
  <update id="updateIsNewByTsn010" parameterType="java.lang.String" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    update  training_situation set isnew='0'
    where TSN010 = #{tsn010,jdbcType=VARCHAR}
  </update>

  <insert id="insert" parameterType="com.tdkj.model.TrainingSituation" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    insert into training_situation (TSN001, TSN010, TSN003, 
      TSN004, TSN005, TSN006, 
      TSN007, TSN008, TSN002, 
      TSN009, AAB301, AAE036, 
      AAE011, TSN011,DATASOURCE,AAE100,UPDATEDATE,UPDATEBY,CREATEBY,
    AAE012,TSN012,TSN013,TSN014,TSN015,TSN016,ISNEW,DELETEBY,DELETEDATE)
    values (#{tsn001,jdbcType=VARCHAR}, #{tsn010,jdbcType=VARCHAR}, #{tsn003,jdbcType=VARCHAR}, 
      #{tsn004,jdbcType=VARCHAR}, #{tsn005,jdbcType=VARCHAR}, #{tsn006,jdbcType=VARCHAR}, 
      #{tsn007,jdbcType=VARCHAR}, #{tsn008,jdbcType=VARCHAR}, #{tsn002,jdbcType=VARCHAR},
      #{tsn009,jdbcType=VARCHAR}, #{aab301,jdbcType=VARCHAR}, #{aae036,jdbcType=TIMESTAMP}, 
      #{aae011,jdbcType=VARCHAR}, #{tsn011,jdbcType=VARCHAR},#{datasource,jdbcType=VARCHAR},
    #{aae100,jdbcType=VARCHAR},#{updatedate,jdbcType=TIMESTAMP},#{updateby,jdbcType=VARCHAR},
    #{createby,jdbcType=VARCHAR},#{aae012,jdbcType=VARCHAR},#{tsn012,jdbcType=VARCHAR},#{tsn013,jdbcType=VARCHAR}
    #{tsn014,jdbcType=VARCHAR},#{tsn015,jdbcType=VARCHAR},#{tsn016,jdbcType=VARCHAR},#{isnew,jdbcType=VARCHAR},
    #{deleteby,jdbcType=VARCHAR},#{deletedate,jdbcType=TIMESTAMP})
  </insert>

    <insert id="addList" parameterType="java.util.List" useGeneratedKeys="false">
        INSERT INTO TRAINING_SITUATION

        (TSN001, TSN010, TSN003,
        TSN004, TSN005, TSN006,
        TSN007, TSN008, TSN002,
        TSN009, AAB301, AAE036,
        AAE011, TSN011, DATASOURCE,
        AAE100, UPDATEDATE, UPDATEBY,
        CREATEBY, AAE012, TSN012,
        TSN013, TSN014, TSN015,
        TSN016, BATCH, IDENTIFICATION,
        MESSAGE, ISNEW, AAC003,DELETEBY,DELETEDATE

        <foreach item="bean" index="index" collection="list" separator="union all">
            (

            select #{bean.tsn001,jdbcType=VARCHAR}, #{bean.tsn010,jdbcType=VARCHAR}, #{bean.tsn003,jdbcType=VARCHAR},
            #{bean.tsn004,jdbcType=VARCHAR}, #{bean.tsn005,jdbcType=VARCHAR}, #{bean.tsn006,jdbcType=VARCHAR},
            #{bean.tsn007,jdbcType=VARCHAR}, #{bean.tsn008,jdbcType=VARCHAR}, #{bean.tsn002,jdbcType=VARCHAR},
            #{bean.tsn009,jdbcType=VARCHAR}, #{bean.aab301,jdbcType=VARCHAR}, #{bean.aae036,jdbcType=TIMESTAMP},
            #{bean.aae011,jdbcType=VARCHAR}, #{bean.tsn011,jdbcType=VARCHAR}, #{bean.datasource,jdbcType=VARCHAR},
            #{bean.aae100,jdbcType=VARCHAR}, #{bean.updatedate,jdbcType=TIMESTAMP}, #{bean.updateby,jdbcType=VARCHAR},
            #{bean.createby,jdbcType=VARCHAR}, #{bean.aae012,jdbcType=VARCHAR}, #{bean.tsn012,jdbcType=VARCHAR},
            #{bean.tsn013,jdbcType=VARCHAR}, #{bean.tsn014,jdbcType=VARCHAR}, #{bean.tsn015,jdbcType=VARCHAR},
            #{bean.tsn016,jdbcType=VARCHAR}, #{bean.batch,jdbcType=VARCHAR}, #{bean.identification,jdbcType=VARCHAR},
            #{bean.message,jdbcType=VARCHAR}, #{bean.isnew,jdbcType=VARCHAR}, #{bean.aac003,jdbcType=VARCHAR},#{bean.deleteby,jdbcType=VARCHAR},#{bean.deletedate,jdbcType=TIMESTAMP}
            from dual

            )
        </foreach>
    </insert>

  <insert id="insertSelective" parameterType="com.tdkj.model.TrainingSituation" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    insert into training_situation
    <trim prefix="(" suffix=")" suffixOverrides="," >
      <if test="tsn001 != null" >
        TSN001,
      </if>
      <if test="tsn010 != null" >
        TSN010,
      </if>
      <if test="tsn003 != null" >
        TSN003,
      </if>
      <if test="tsn004 != null" >
        TSN004,
      </if>
      <if test="tsn005 != null" >
        TSN005,
      </if>
      <if test="tsn006 != null" >
        TSN006,
      </if>
      <if test="tsn007 != null" >
        TSN007,
      </if>
      <if test="tsn008 != null" >
        TSN008,
      </if>
      <if test="tsn002 != null" >
        TSN002,
      </if>
      <if test="tsn009 != null" >
        TSN009,
      </if>
      <if test="aab301 != null" >
        AAB301,
      </if>
      <if test="aae036 != null" >
        AAE036,
      </if>
      <if test="aae011 != null" >
        AAE011,
      </if>
      <if test="tsn011 != null" >
        TSN011,
      </if>
      <if test="datasource != null" >
        DATASOURCE,
      </if>
      <if test="aae100 != null" >
        AAE100,
      </if>
      <if test="updatedate != null" >
        UPDATEDATE,
      </if>
      <if test="updateby != null" >
        UPDATEBY,
      </if>
      <if test="createby != null" >
        CREATEBY,
      </if>
      <if test="aae012 != null" >
        AAE012,
      </if>
      <if test="tsn012 != null" >
        TSN012,
      </if>
      <if test="tsn013 != null" >
        TSN013,
      </if>
      <if test="tsn014 != null" >
        TSN014,
      </if>
      <if test="tsn015 != null" >
        TSN015,
      </if>
      <if test="tsn016 != null" >
        TSN016,
      </if>
      <if test="isnew != null" >
        ISNEW,
      </if>
      <if test="deleteby != null" >
        DELETEBY,
      </if>
      <if test="deletedate != null" >
        DELETEDATE,
      </if>
    </trim>
    <trim prefix="values (" suffix=")" suffixOverrides="," >
      <if test="tsn001 != null" >
        #{tsn001,jdbcType=VARCHAR},
      </if>
      <if test="tsn010 != null" >
        #{tsn010,jdbcType=VARCHAR},
      </if>
      <if test="tsn003 != null" >
        #{tsn003,jdbcType=VARCHAR},
      </if>
      <if test="tsn004 != null" >
        #{tsn004,jdbcType=VARCHAR},
      </if>
      <if test="tsn005 != null" >
        #{tsn005,jdbcType=VARCHAR},
      </if>
      <if test="tsn006 != null" >
        #{tsn006,jdbcType=VARCHAR},
      </if>
      <if test="tsn007 != null" >
        #{tsn007,jdbcType=VARCHAR},
      </if>
      <if test="tsn008 != null" >
        #{tsn008,jdbcType=VARCHAR},
      </if>
      <if test="tsn002 != null" >
        #{tsn002,jdbcType=VARCHAR},
      </if>
      <if test="tsn009 != null" >
        #{tsn009,jdbcType=VARCHAR},
      </if>
      <if test="aab301 != null" >
        #{aab301,jdbcType=VARCHAR},
      </if>
      <if test="aae036 != null" >
        #{aae036,jdbcType=TIMESTAMP},
      </if>
      <if test="aae011 != null" >
        #{aae011,jdbcType=VARCHAR},
      </if>
      <if test="tsn011 != null" >
        #{tsn011,jdbcType=VARCHAR},
      </if>
      <if test="datasource != null" >
        #{datasource,jdbcType=VARCHAR},
      </if>
      <if test="aae100 != null" >
        #{aae100,jdbcType=VARCHAR},
      </if>
      <if test="updatedate != null" >
        #{updatedate,jdbcType=TIMESTAMP},
      </if>
      <if test="updateby != null" >
        #{updateby,jdbcType=VARCHAR},
      </if>
      <if test="createby != null" >
        #{createby,jdbcType=VARCHAR},
      </if>
      <if test="aae012 != null" >
        #{aae012,jdbcType=VARCHAR},
      </if>
      <if test="tsn012 != null" >
        #{tsn012,jdbcType=VARCHAR},
      </if>
      <if test="tsn013 != null" >
        #{tsn013,jdbcType=VARCHAR},
      </if>
      <if test="tsn014 != null" >
        #{tsn014,jdbcType=VARCHAR},
      </if>
      <if test="tsn015 != null" >
        #{tsn015,jdbcType=VARCHAR},
      </if>
      <if test="tsn016 != null" >
        #{tsn016,jdbcType=VARCHAR},
      </if>
      <if test="isnew != null" >
        #{isnew,jdbcType=VARCHAR},
      </if>
      <if test="deleteby != null" >
        #{deleteby,jdbcType=VARCHAR},
      </if>
      <if test="deletedate != null" >
        #{deletedate,jdbcType=TIMESTAMP},
      </if>
    </trim>
  </insert>
  <update id="updateByPrimaryKeySelective" parameterType="com.tdkj.model.TrainingSituation" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    update training_situation
    <set >
      <if test="tsn010 != null" >
        TSN010 = #{tsn010,jdbcType=VARCHAR},
      </if>
      <if test="tsn003 != null" >
        TSN003 = #{tsn003,jdbcType=VARCHAR},
      </if>
      <if test="tsn004 != null" >
        TSN004 = #{tsn004,jdbcType=VARCHAR},
      </if>
      <if test="tsn005 != null" >
        TSN005 = #{tsn005,jdbcType=VARCHAR},
      </if>
      <if test="tsn006 != null" >
        TSN006 = #{tsn006,jdbcType=VARCHAR},
      </if>
      <if test="tsn007 != null" >
        TSN007 = #{tsn007,jdbcType=VARCHAR},
      </if>
      <if test="tsn008 != null" >
        TSN008 = #{tsn008,jdbcType=VARCHAR},
      </if>
      <if test="tsn002 != null" >
        TSN002 = #{tsn002,jdbcType=VARCHAR},
      </if>
      <if test="tsn009 != null" >
        TSN009 = #{tsn009,jdbcType=VARCHAR},
      </if>
      <if test="aab301 != null" >
        AAB301 = #{aab301,jdbcType=VARCHAR},
      </if>
      <if test="aae036 != null" >
        AAE036 = #{aae036,jdbcType=TIMESTAMP},
      </if>
      <if test="aae011 != null" >
        AAE011 = #{aae011,jdbcType=VARCHAR},
      </if>
      <if test="tsn011 != null" >
        TSN011 = #{tsn011,jdbcType=VARCHAR},
      </if>
      <if test="datasource != null" >
        DATASOURCE = #{datasource,jdbcType=VARCHAR},
      </if>
      <if test="aae100 != null" >
        AAE100 = #{aae100,jdbcType=VARCHAR},
      </if>
      <if test="updatedate != null" >
        UPDATEDATE = #{updatedate,jdbcType=TIMESTAMP},
      </if>
      <if test="updateby != null" >
        UPDATEBY = #{updateby,jdbcType=VARCHAR},
      </if>
      <if test="createby != null" >
        CREATEBY = #{createby,jdbcType=VARCHAR},
      </if>
      <if test="aae012 != null" >
        AAE012 = #{aae012,jdbcType=VARCHAR},
      </if>
      <if test="tsn012 != null" >
        TSN012 = #{tsn012,jdbcType=VARCHAR},
      </if>
      <if test="tsn013 != null" >
        TSN013 = #{tsn013,jdbcType=VARCHAR},
      </if>
      <if test="tsn014 != null" >
        TSN014 = #{tsn014,jdbcType=VARCHAR},
      </if>
      <if test="tsn015 != null" >
        TSN015 = #{tsn015,jdbcType=VARCHAR},
      </if>
      <if test="tsn016 != null" >
        TSN016 = #{tsn016,jdbcType=VARCHAR},
      </if>
      <if test="isnew != null" >
        ISNEW = #{isnew,jdbcType=VARCHAR},
      </if>
      <if test="deleteby != null" >
        DELETEBY = #{deleteby,jdbcType=VARCHAR},
      </if>
      <if test="deletedate != null" >
        DELETEDATE = #{deletedate,jdbcType=TIMESTAMP},
      </if>
    </set>
    where TSN001 = #{tsn001,jdbcType=VARCHAR}
  </update>
  <update id="updateByPrimaryKey" parameterType="com.tdkj.model.TrainingSituation" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    update training_situation
    set TSN010 = #{tsn010,jdbcType=VARCHAR},
      TSN003 = #{tsn003,jdbcType=VARCHAR},
      TSN004 = #{tsn004,jdbcType=VARCHAR},
      TSN005 = #{tsn005,jdbcType=VARCHAR},
      TSN006 = #{tsn006,jdbcType=VARCHAR},
      TSN007 = #{tsn007,jdbcType=VARCHAR},
      TSN008 = #{tsn008,jdbcType=VARCHAR},
      TSN002 = #{tsn002,jdbcType=VARCHAR},
      TSN009 = #{tsn009,jdbcType=VARCHAR},
      AAB301 = #{aab301,jdbcType=VARCHAR},
      AAE036 = #{aae036,jdbcType=TIMESTAMP},
      AAE011 = #{aae011,jdbcType=VARCHAR},
      TSN011 = #{tsn011,jdbcType=VARCHAR},
    DATASOURCE = #{datasource,jdbcType=VARCHAR},
    AAE100 = #{aae100,jdbcType=VARCHAR},
    UPDATEDATE = #{updatedate,jdbcType=TIMESTAMP},
    UPDATEBY = #{updateby,jdbcType=VARCHAR},
    CREATEBY = #{createby,jdbcType=VARCHAR},
    AAE012 = #{aae012,jdbcType=VARCHAR},
    TSN012 = #{tsn012,jdbcType=VARCHAR},
    TSN013 = #{tsn013,jdbcType=VARCHAR},
    TSN014 = #{tsn014,jdbcType=VARCHAR},
    TSN015 = #{tsn015,jdbcType=VARCHAR},
    TSN016 = #{tsn016,jdbcType=VARCHAR},
    ISNEW = #{isnew,jdbcType=VARCHAR},
    DELETEBY = #{deleteby,jdbcType=VARCHAR},
    DELETEDATE = #{deletedate,jdbcType=TIMESTAMP}
    where TSN001 = #{tsn001,jdbcType=VARCHAR}
  </update>

  <!--根据劳动力id 查询劳动力培训情况信息-->
  <select id="queryTrainingSituationByTsn010" resultMap="BaseResultMap" parameterType="java.lang.String" >
    select
    TSN001, TSN010,
    f_getcodename('AAA007',TSN003)TSN003,
      f_getcodename('AAA019',TSN004)TSN004,
     TSN005, TSN006, TSN007, TSN008, TSN002, TSN009, AAB301,
    AAE036, AAE011, TSN011,DATASOURCE,AAE100,UPDATEDATE,UPDATEBY,
    CREATEBY,AAE012,TSN012,TSN013,TSN014,TSN015,TSN016,ISNEW
    from training_situation
    where  TSN010 = #{tsn010,jdbcType=VARCHAR} and aae100='1'
  </select>

  <!--根据劳动力id 删除培训情况信息-->
  <update id="deleteTrainingSituationByTsn010" parameterType="java.lang.String" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    update  training_situation set aae100='0',DELETEBY=#{realname,jdbcType=VARCHAR},DELETEDATE=sysdate
    where TSN010 = #{tsn010,jdbcType=VARCHAR}
  </update>


    <!--*************************************以下是台账、待完善信息查询***********************************************************************************-->


    <!--根据行政区划查询劳动力技能培训台账、待完善 信息-->
  <select id="queryTrainSituationAccountByAab301" resultMap="TsnPlfResultMap" parameterType="java.lang.String" >
    select plf001,plf002,
    plf004,plf005,plf006,plf007,plf008,
    plf009,plf010,plf011,plf012,plf013,plf015,plf016,plf017,plf018,
    plf023,plf024,phd013,phd007,rn,phd014,
    TSN001, TSN010, TSN003, TSN004, TSN005, TSN006, TSN007, TSN008, TSN002, TSN009, AAB301,
    AAE036, AAE011, TSN011,DATASOURCE,AAE100,UPDATEDATE,UPDATEBY,CREATEBY,AAE012,
    TSN012,TSN013,TSN014,TSN015,TSN016,ISNEW
    from (select plf001,plf002,
    plf004,plf005,plf006,plf007,plf008,
    plf009,plf010,plf011,plf012,plf013,plf015,plf016,plf017,plf018,
    plf023,plf024,phd013,phd007,phd014,
    TSN001, TSN010, TSN003, TSN004, TSN005, TSN006, TSN007, TSN008, TSN002, TSN009, AAB301,
    AAE036, AAE011, TSN011,DATASOURCE,AAE100,UPDATEDATE,UPDATEBY,CREATEBY,AAE012,TSN012,TSN013,TSN014,TSN015,TSN016,ISNEW, rownum rn
    from (select plf.plf001,plf.plf002, plf.plf004,plf.plf005,plf.plf006,
      f_getcodename('AAC004',plf.PLF007) PLF007,plf.PLF008,
      f_getcodename('AAC011',plf.PLF009) PLF009,
      f_getcodename('AAA004',plf.PLF010) PLF010,
      f_getcodename('AAA002',plf.PLF011) PLF011,
      f_getcodename('AAA003',plf.PLF012) PLF012,plf.PLF013,plf.PLF016,
      f_getcodename('AAA001',plf.PLF014) PLF014,
      (case when plf.plf015 ='1' then '是' else '否' end) plf015,
      f_getcodename('AAA011',plf.PLF017) PLF017,
      f_getcodename('AAA016',plf.PLF018) PLF018,
      f_getcodename('EDC441',plf.plf023) plf023,
      f_getcodename('PLF024',plf.plf024) plf024,
      f_getcodename('EDC441',ts.PHD013) phd013,''phd007, f_getcodename('AAA012',ts.phd014) phd014,
    ts.TSN001, ts.TSN010,
      f_getcodename('AAA007',ts.TSN003)TSN003,
      f_getcodename('AAA019',ts.TSN004)TSN004,
    ts.TSN005, ts.TSN006, ts.TSN007, ts.TSN008, ts.TSN002, ts.TSN009,
     t.info AAB301,
    ts.AAE036, ts.AAE011, ts.TSN011,ts.DATASOURCE,ts.AAE100,ts.UPDATEDATE,ts.UPDATEBY,
    ts.CREATEBY,ts.AAE012,
    f_getcodename('EDC441',ts.TSN012) TSN012,ts.TSN013,ts.TSN014,ts.TSN015,ts.TSN016,ts.ISNEW,
      row_number() over(partition by ts.tsn010    order by tsn007    desc) as sn
    from   training_situation ts left join poor_labor_force plf   on ts.tsn010 = plf.plf001  left join poor_households ph on ph.phd001 =  plf.plf002,POOR_XZQH t
    where  plf.AAB301=t.XZQHBM and ts.aae100='1'  and plf.aae100='1'
      /*待完善条件TSN007 TSN008 培训开始日期不能为空*/
      <if test="tsnPlf.istobecomplete != null  and tsnPlf.istobecomplete !='' ">
        and (ts.TSN007 is null or to_date(ts.TSN008,'yyyy-MM-dd hh24:mi:ss') > sysdate or (ts.TSN007 is not null and (substr(ts.TSN007, 0, 4) != '2019'  and ts.TSN008 is null)) or to_date(ts.TSN007,'yyyy-MM-dd hh24:mi:ss') - to_date(ts.TSN008,'yyyy-MM-dd hh24:mi:ss') >0)
      </if>
    <if test="tsnPlf.showscope != null and tsnPlf.showscope !='' ">
      -- and plf.plf018 in ('01','02')    and plf.ispoor='1'  and plf.plf025='0' and plf.plf015 ='0'
      and plf.ispoor='1'
    </if>
      <if test="tsnPlf.helpyear != null and tsnPlf.helpyear !='' ">
          and   substr(ts.TSN007,0,4) = #{tsnPlf.helpyear,jdbcType=VARCHAR}
      </if>
      <if test='tsnPlf.isnoduty != null and tsnPlf.isnoduty =="1" '>
          and  ts.TSN008 is  null
      </if>
      <if test='tsnPlf.isnoduty != null and tsnPlf.isnoduty =="0" '>
          and  ts.TSN008 is  not null
      </if>
    <if test="tsnPlf.tsn010 != null and tsnPlf.tsn010 !='' " >
      and  ts.TSN010 = #{tsnPlf.tsn010,jdbcType=VARCHAR}
    </if>
    <if test="tsnPlf.tsn003 != null and tsnPlf.tsn003 !='' " >
      and  ts.TSN003 = #{tsnPlf.tsn003,jdbcType=VARCHAR}
    </if>
    <if test="tsnPlf.tsn004 != null and tsnPlf.tsn004 !='' " >
      and  ts.TSN004 = #{tsnPlf.tsn004,jdbcType=VARCHAR}
    </if>
    <if test="tsnPlf.tsn005 != null and tsnPlf.tsn005 !='' " >
      and  ts.TSN005 = #{tsnPlf.tsn005,jdbcType=VARCHAR}
    </if>
    <if test="tsnPlf.tsn006 != null and tsnPlf.tsn006 !='' " >
      and  ts.TSN006 = #{tsnPlf.tsn006,jdbcType=VARCHAR}
    </if>
    <if test="tsnPlf.tsn007 != null and tsnPlf.tsn007 !='' " >
      and to_date(ts.TSN007,'yyyy-MM-dd') >= to_date(#{tsnPlf.tsn007},'yyyy-MM-dd')
    </if>
    <if test="tsnPlf.tsn008 != null and tsnPlf.tsn008 !='' " >
      and to_date(ts.TSN008,'yyyy-MM-dd') &lt;= to_date(#{tsnPlf.tsn008},'yyyy-MM-dd')
    </if>
    <if test="tsnPlf.tsn002 != null and tsnPlf.tsn002 !='' " >
      and  ts.TSN002 = #{tsnPlf.tsn002,jdbcType=VARCHAR}
    </if>
    <if test="tsnPlf.tsn009 != null and tsnPlf.tsn009 !='' " >
      and  ts.TSN009 = #{tsnPlf.tsn009,jdbcType=VARCHAR}
    </if>
    <if test="tsnPlf.aae036 != null and tsnPlf.aae036 !='' " >
      and  ts. AAE036 = #{tsnPlf.aae036,jdbcType=TIMESTAMP}
    </if>
    <if test="tsnPlf.aae011 != null and tsnPlf.aae011 !='' " >
      and  ts.AAE011 = #{tsnPlf.aae011,jdbcType=VARCHAR}
    </if>
    <if test="tsnPlf.tsn011 != null and tsnPlf.tsn011 !='' " >
      and  ts.TSN011 = #{tsnPlf.tsn011,jdbcType=VARCHAR}
    </if>
    <if test="tsnPlf.datasource != null and tsnPlf.datasource !='' " >
      and  ts.DATASOURCE = #{tsnPlf.datasource,jdbcType=VARCHAR}
    </if>
    <if test="tsnPlf.aae100 != null and tsnPlf.aae100 !='' " >
      and  ts.AAE100 = #{tsnPlf.aae100,jdbcType=VARCHAR}
    </if>
    <if test="tsnPlf.updatedate != null and tsnPlf.updatedate !='' " >
      and  ts.UPDATEDATE = #{tsnPlf.updatedate,jdbcType=TIMESTAMP}
    </if>
    <if test="tsnPlf.updateby != null and tsnPlf.updateby !='' " >
      and  ts.UPDATEBY = #{tsnPlf.updateby,jdbcType=VARCHAR}
    </if>
    <if test="tsnPlf.createby != null and tsnPlf.createby !='' " >
      and  ts.CREATEBY = #{tsnPlf.createby,jdbcType=VARCHAR}
    </if>
    <if test="tsnPlf.aae012 != null and tsnPlf.aae012 !='' " >
      and  ts.AAE012 = #{tsnPlf.aae012,jdbcType=VARCHAR}
    </if>
    <if test="tsnPlf.tsn012 != null and tsnPlf.tsn012 !='' " >
      and  ts.TSN012 = #{tsnPlf.tsn012,jdbcType=VARCHAR}
    </if>
    <if test="tsnPlf.tsn013 != null and tsnPlf.tsn013 !='' " >
      and  ts.TSN013 = #{tsnPlf.tsn013,jdbcType=VARCHAR}
    </if>
    <if test="tsnPlf.tsn014 != null and tsnPlf.tsn014 !='' " >
      and  ts.TSN014 = #{tsnPlf.tsn014,jdbcType=VARCHAR}
    </if>
    <if test="tsnPlf.tsn015 != null and tsnPlf.tsn015 !='' " >
      and  ts.TSN015 = #{tsnPlf.tsn015,jdbcType=VARCHAR}
    </if>
    <if test="tsnPlf.tsn016 != null and tsnPlf.tsn016 !='' " >
      and  ts.TSN016 = #{tsnPlf.tsn016,jdbcType=VARCHAR}
    </if>
    <if test="tsnPlf.isnew != null and tsnPlf.isnew !='' " >
      and  ts.ISNEW = #{tsnPlf.isnew,jdbcType=VARCHAR}
    </if>
    <if test="tsnPlf.aab301 != null and tsnPlf.aab301 !='' " >
      and   plf.AAB301 like #{tsnPlf.aab301,jdbcType=VARCHAR}
    </if>
    <if test="tsnPlf.plf004 != null and tsnPlf.plf004 !='' " >
      and  plf.PLF004 like #{tsnPlf.plf004,jdbcType=VARCHAR}
    </if>
    <if test="tsnPlf.plf005 != null and tsnPlf.plf005 !='' " >
      and plf.PLF005 = #{tsnPlf.plf005,jdbcType=VARCHAR}
    </if>
    <if test="tsnPlf.plf006 != null and tsnPlf.plf006 !='' " >
      and plf.PLF006 = #{tsnPlf.plf006,jdbcType=VARCHAR}
    </if>
    <if test="tsnPlf.plf007 != null and tsnPlf.plf007 !='' " >
      and plf.PLF007 = #{tsnPlf.plf007,jdbcType=VARCHAR}
    </if>
    <if test="tsnPlf.startage != null and tsnPlf.startage !='' " >
      and plf.PLF008 >= #{tsnPlf.startage,jdbcType=VARCHAR}
    </if>
    <if test="tsnPlf.endage != null and tsnPlf.endage !='' " >
      and plf.PLF008 &lt; #{tsnPlf.endage,jdbcType=VARCHAR}
    </if>
    <if test="tsnPlf.plf009 != null and tsnPlf.plf009 !='' " >
      and plf.PLF009 = #{tsnPlf.plf009,jdbcType=VARCHAR}
    </if>
    <if test="tsnPlf.plf010 != null and tsnPlf.plf010 !='' " >
      and plf.PLF010 = #{tsnPlf.plf010,jdbcType=VARCHAR}
    </if>
    <if test="tsnPlf.plf011 != null and tsnPlf.plf011 !='' " >
      and plf.PLF011 = #{tsnPlf.plf011,jdbcType=VARCHAR}
    </if>
    <if test="tsnPlf.plf012 != null and tsnPlf.plf012 !='' " >
      and plf.PLF012 = #{tsnPlf.plf012,jdbcType=VARCHAR}
    </if>
    <if test="tsnPlf.plf013 != null and tsnPlf.plf013 !='' " >
      and plf.PLF013 = #{tsnPlf.plf013,jdbcType=VARCHAR}
    </if>
    <if test="tsnPlf.plf014 != null and tsnPlf.plf014 !='' " >
      and  plf.PLF014 = #{tsnPlf.plf014,jdbcType=VARCHAR}
    </if>
    <if test="tsnPlf.plf016 != null and tsnPlf.plf016 !='' " >
      and plf.PLF016 = #{tsnPlf.plf016,jdbcType=VARCHAR}
    </if>
    <if test="tsnPlf.plf015 != null and tsnPlf.plf015 !='' " >
      and plf.PLF015 = #{tsnPlf.plf015,jdbcType=VARCHAR}
    </if>
    <if test="tsnPlf.plf017 != null and tsnPlf.plf017 !='' " >
      and  plf.PLF017 = #{tsnPlf.plf017,jdbcType=VARCHAR}
    </if>
    <if test="tsnPlf.plf018 != null and tsnPlf.plf018 !='' " >
      and  plf.PLF018 = #{tsnPlf.plf018,jdbcType=VARCHAR}
    </if>
    <if test="tsnPlf.plf023 != null and tsnPlf.plf023 !='' " >
      and  plf.PLF023 = #{tsnPlf.plf023,jdbcType=VARCHAR}
    </if>
    <if test="tsnPlf.plf024 != null and tsnPlf.plf024 !='' " >
      and plf.PLF024 = #{tsnPlf.plf024,jdbcType=VARCHAR}
    </if>
    <if test="tsnPlf.phd013 != null and tsnPlf.phd013 !='' " >
      and ts.PHD013 = #{tsnPlf.phd013,jdbcType=VARCHAR}
    </if>
    <if test="tsnPlf.phd014 != null and tsnPlf.phd014 !='' " >
      and ts.phd014 = #{tsnPlf.phd014,jdbcType=VARCHAR}
    </if>
    <if test="tsnPlf.phd014_19 != null and tsnPlf.phd014_19 !='' " >
      and ts.phd014_19 = #{tsnPlf.phd014_19,jdbcType=VARCHAR}
    </if>
    ) a1
    where sn=1 and rownum &lt;= #{pageSize})
    where rn &gt;= #{startRecord}
  </select>

  <!--查询所有多少个  根据行政区划   查询台账信息-->
  <select id="queryAllTrainSituationByAab301" resultType="java.lang.String" parameterType="java.lang.String" >
    select count(1) from
      (
      select row_number() over(partition by ts.tsn010 order by tsn007 desc) as sn
      from training_situation ts left join poor_labor_force plf on ts.tsn010 = plf.plf001
      where ts.aae100='1'  and plf.aae100='1'
      /*待完善条件TSN007 TSN008 培训开始日期 结束日期不能为空*/
      <if test="tsnPlf.istobecomplete != null  and tsnPlf.istobecomplete !='' ">
        and (ts.TSN007 is null or to_date(ts.TSN008,'yyyy-MM-dd hh24:mi:ss') > sysdate or (ts.TSN007 is not null and (substr(ts.TSN007, 0, 4) != '2019'  and ts.TSN008 is null)) or to_date(ts.TSN007,'yyyy-MM-dd hh24:mi:ss') - to_date(ts.TSN008,'yyyy-MM-dd hh24:mi:ss') >0)
      </if>
    <if test="tsnPlf.showscope != null and tsnPlf.showscope !='' ">
      -- and plf.plf018 in ('01','02')    and plf.ispoor='1'   and plf.plf025='0' and  plf.plf015 ='0'
      and  plf.ispoor='1'
    </if>
      <if test="tsnPlf.helpyear != null and tsnPlf.helpyear !='' ">
          and substr(ts.TSN007,0,4) = #{tsnPlf.helpyear,jdbcType=VARCHAR}
      </if>
      <if test='tsnPlf.isnoduty != null and tsnPlf.isnoduty =="1" '>
          and ts.TSN008 is null
      </if>
      <if test='tsnPlf.isnoduty != null and tsnPlf.isnoduty =="0" '>
          and ts.TSN008 is not null
      </if>
    <if test="tsnPlf.tsn010 != null and tsnPlf.tsn010 !='' ">
      and  ts.TSN010 = #{tsnPlf.tsn010,jdbcType=VARCHAR}
    </if>
    <if test="tsnPlf.tsn003 != null and tsnPlf.tsn003 !='' " >
      and  ts.TSN003 = #{tsnPlf.tsn003,jdbcType=VARCHAR}
    </if>
    <if test="tsnPlf.tsn004 != null and tsnPlf.tsn004 !='' " >
      and  ts.TSN004 = #{tsnPlf.tsn004,jdbcType=VARCHAR}
    </if>
    <if test="tsnPlf.tsn005 != null and tsnPlf.tsn005 !='' " >
      and  ts.TSN005 = #{tsnPlf.tsn005,jdbcType=VARCHAR}
    </if>
    <if test="tsnPlf.tsn006 != null and tsnPlf.tsn006 !='' " >
      and  ts.TSN006 = #{tsnPlf.tsn006,jdbcType=VARCHAR}
    </if>
    <if test="tsnPlf.tsn007 != null and tsnPlf.tsn007 !='' " >
      and to_date(ts.TSN007,'yyyy-MM-dd') >= to_date(#{tsnPlf.tsn007},'yyyy-MM-dd')
    </if>
    <if test="tsnPlf.tsn008 != null and tsnPlf.tsn008 !='' " >
      and to_date(ts.TSN008,'yyyy-MM-dd') &lt;= to_date(#{tsnPlf.tsn008},'yyyy-MM-dd')
    </if>
    <if test="tsnPlf.tsn002 != null and tsnPlf.tsn002 !='' " >
      and  ts.TSN002 = #{tsnPlf.tsn002,jdbcType=VARCHAR}
    </if>
    <if test="tsnPlf.tsn009 != null and tsnPlf.tsn009 !='' " >
      and  ts.TSN009 = #{tsnPlf.tsn009,jdbcType=VARCHAR}
    </if>
    <if test="tsnPlf.aae036 != null and tsnPlf.aae036 !='' " >
      and  ts. AAE036 = #{tsnPlf.aae036,jdbcType=TIMESTAMP}
    </if>
    <if test="tsnPlf.aae011 != null and tsnPlf.aae011 !='' " >
      and  ts.AAE011 = #{tsnPlf.aae011,jdbcType=VARCHAR}
    </if>
    <if test="tsnPlf.tsn011 != null and tsnPlf.tsn011 !='' " >
      and  ts.TSN011 = #{tsnPlf.tsn011,jdbcType=VARCHAR}
    </if>
    <if test="tsnPlf.datasource != null and tsnPlf.datasource !='' " >
      and  ts.DATASOURCE = #{tsnPlf.datasource,jdbcType=VARCHAR}
    </if>
    <if test="tsnPlf.aae100 != null and tsnPlf.aae100 !='' " >
      and  ts.AAE100 = #{tsnPlf.aae100,jdbcType=VARCHAR}
    </if>
    <if test="tsnPlf.updatedate != null and tsnPlf.updatedate !='' " >
      and  ts.UPDATEDATE = #{tsnPlf.updatedate,jdbcType=TIMESTAMP}
    </if>
    <if test="tsnPlf.updateby != null and tsnPlf.updateby !='' " >
      and  ts.UPDATEBY = #{tsnPlf.updateby,jdbcType=VARCHAR}
    </if>
    <if test="tsnPlf.createby != null and tsnPlf.createby !='' " >
      and  ts.CREATEBY = #{tsnPlf.createby,jdbcType=VARCHAR}
    </if>
    <if test="tsnPlf.aae012 != null and tsnPlf.aae012 !='' " >
      and  ts.AAE012 = #{tsnPlf.aae012,jdbcType=VARCHAR}
    </if>
    <if test="tsnPlf.tsn012 != null and tsnPlf.tsn012 !='' " >
      and  ts.TSN012 = #{tsnPlf.tsn012,jdbcType=VARCHAR}
    </if>
    <if test="tsnPlf.tsn013 != null and tsnPlf.tsn013 !='' " >
      and  ts.TSN013 = #{tsnPlf.tsn013,jdbcType=VARCHAR}
    </if>
    <if test="tsnPlf.tsn014 != null and tsnPlf.tsn014 !='' " >
      and  ts.TSN014 = #{tsnPlf.tsn014,jdbcType=VARCHAR}
    </if>
    <if test="tsnPlf.tsn015 != null and tsnPlf.tsn015 !='' " >
      and  ts.TSN015 = #{tsnPlf.tsn015,jdbcType=VARCHAR}
    </if>
    <if test="tsnPlf.tsn016 != null and tsnPlf.tsn016 !='' " >
      and  ts.TSN016 = #{tsnPlf.tsn016,jdbcType=VARCHAR}
    </if>
    <if test="tsnPlf.isnew != null and tsnPlf.isnew !='' " >
      and  ts.ISNEW = #{tsnPlf.isnew,jdbcType=VARCHAR}
    </if>
    <if test="tsnPlf.aab301 != null and tsnPlf.aab301 !='' " >
      and   plf.AAB301 like #{tsnPlf.aab301,jdbcType=VARCHAR}
    </if>
    <if test="tsnPlf.plf004 != null and tsnPlf.plf004 !='' " >
      and  plf.PLF004 like #{tsnPlf.plf004,jdbcType=VARCHAR}
    </if>
    <if test="tsnPlf.plf005 != null and tsnPlf.plf005 !='' " >
      and plf.PLF005 = #{tsnPlf.plf005,jdbcType=VARCHAR}
    </if>
    <if test="tsnPlf.plf006 != null and tsnPlf.plf006 !='' " >
      and plf.PLF006 = #{tsnPlf.plf006,jdbcType=VARCHAR}
    </if>
    <if test="tsnPlf.plf007 != null and tsnPlf.plf007 !='' " >
      and plf.PLF007 = #{tsnPlf.plf007,jdbcType=VARCHAR}
    </if>
    <if test="tsnPlf.startage != null and tsnPlf.startage !='' " >
      and plf.PLF008 >= #{tsnPlf.startage,jdbcType=VARCHAR}
    </if>
    <if test="tsnPlf.endage != null and tsnPlf.endage !='' " >
      and plf.PLF008 &lt; #{tsnPlf.endage,jdbcType=VARCHAR}
    </if>
    <if test="tsnPlf.plf009 != null and tsnPlf.plf009 !='' " >
      and plf.PLF009 = #{tsnPlf.plf009,jdbcType=VARCHAR}
    </if>
    <if test="tsnPlf.plf010 != null and tsnPlf.plf010 !='' " >
      and plf.PLF010 = #{tsnPlf.plf010,jdbcType=VARCHAR}
    </if>
    <if test="tsnPlf.plf011 != null and tsnPlf.plf011 !='' " >
      and plf.PLF011 = #{tsnPlf.plf011,jdbcType=VARCHAR}
    </if>
    <if test="tsnPlf.plf012 != null and tsnPlf.plf012 !='' " >
      and plf.PLF012 = #{tsnPlf.plf012,jdbcType=VARCHAR}
    </if>
    <if test="tsnPlf.plf013 != null and tsnPlf.plf013 !='' " >
      and plf.PLF013 = #{tsnPlf.plf013,jdbcType=VARCHAR}
    </if>
    <if test="tsnPlf.plf014 != null and tsnPlf.plf014 !='' " >
      and  plf.PLF014 = #{tsnPlf.plf014,jdbcType=VARCHAR}
    </if>
    <if test="tsnPlf.plf016 != null and tsnPlf.plf016 !='' " >
      and plf.PLF016 = #{tsnPlf.plf016,jdbcType=VARCHAR}
    </if>
    <if test="tsnPlf.plf015 != null and tsnPlf.plf015 !='' " >
      and plf.PLF015 = #{tsnPlf.plf015,jdbcType=VARCHAR}
    </if>
    <if test="tsnPlf.plf017 != null and tsnPlf.plf017 !='' " >
      and  plf.PLF017 = #{tsnPlf.plf017,jdbcType=VARCHAR}
    </if>
    <if test="tsnPlf.plf018 != null and tsnPlf.plf018 !='' " >
      and  plf.PLF018 = #{tsnPlf.plf018,jdbcType=VARCHAR}
    </if>
    <if test="tsnPlf.plf023 != null and tsnPlf.plf023 !='' " >
      and  plf.PLF023 = #{tsnPlf.plf023,jdbcType=VARCHAR}
    </if>
    <if test="tsnPlf.plf024 != null and tsnPlf.plf024 !='' " >
      and plf.PLF024 = #{tsnPlf.plf024,jdbcType=VARCHAR}
    </if>
    <if test="tsnPlf.phd013 != null and tsnPlf.phd013 !='' " >
      and ts.PHD013 = #{tsnPlf.phd013,jdbcType=VARCHAR}
    </if>
    <if test="tsnPlf.phd014 != null and tsnPlf.phd014 !='' " >
      and ts.phd014 = #{tsnPlf.phd014,jdbcType=VARCHAR}
    </if>
    <if test="tsnPlf.phd014_19 != null and tsnPlf.phd014_19 !='' " >
      and ts.phd014_19 = #{tsnPlf.phd014_19,jdbcType=VARCHAR}
    </if>
    ) where sn=1
  </select>

  <!--根据劳动力id  查询最新的培训信息-->
  <select id="queryNewTrainSituation" resultMap="BaseResultMap" parameterType="java.lang.String" >
    select tsn001,tsn002,tsn007 from
    (select s.tsn001,tsn002,tsn007,row_number() over(partition by s.tsn010 order by tsn007 desc) as sn from training_situation s where  s.aae100='1' and s.tsn002 = #{tsn002})
    where sn=1
  </select>

</mapper>