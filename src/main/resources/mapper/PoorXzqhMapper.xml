<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.tdkj.dao.Ztree.PoorXzqhMapper" >
    <resultMap id="BaseResultMap" type="com.tdkj.model.PoorXzqh" >
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
        <result column="XZQHBM" property="xzqhbm" jdbcType="VARCHAR" />
        <result column="XZQHMC" property="xzqhmc" jdbcType="VARCHAR" />
        <result column="FXZQHBM" property="fxzqhbm" jdbcType="VARCHAR" />
        <result column="FXZQHMC" property="fxzqhmc" jdbcType="VARCHAR" />
        <result column="GXSJ" property="gxsj" jdbcType="VARCHAR" />
        <result column="TYPE" property="type" jdbcType="VARCHAR" />
        <result column="INFO" property="info" jdbcType="VARCHAR" />
        <result column="ISPARENT" property="isParent" jdbcType="VARCHAR" />
    </resultMap>
    <insert id="insert" parameterType="com.tdkj.model.PoorXzqh" >
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
        insert into POOR_XZQH (XZQHBM, XZQHMC, FXZQHBM,
        FXZQHMC, GXSJ, TYPE,
        INFO, ISPARENT)
        values (#{xzqhbm,jdbcType=VARCHAR}, #{xzqhmc,jdbcType=VARCHAR}, #{fxzqhbm,jdbcType=VARCHAR},
        #{fxzqhmc,jdbcType=VARCHAR}, #{gxsj,jdbcType=VARCHAR}, #{type,jdbcType=VARCHAR},
        #{info,jdbcType=VARCHAR}, #{isparent,jdbcType=VARCHAR})
    </insert>
    <insert id="insertSelective" parameterType="com.tdkj.model.PoorXzqh" >
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
        insert into POOR_XZQH
        <trim prefix="(" suffix=")" suffixOverrides="," >
            <if test="xzqhbm != null" >
                XZQHBM,
            </if>
            <if test="xzqhmc != null" >
                XZQHMC,
            </if>
            <if test="fxzqhbm != null" >
                FXZQHBM,
            </if>
            <if test="fxzqhmc != null" >
                FXZQHMC,
            </if>
            <if test="gxsj != null" >
                GXSJ,
            </if>
            <if test="type != null" >
                TYPE,
            </if>
            <if test="info != null" >
                INFO,
            </if>
            <if test="isparent != null" >
                ISPARENT,
            </if>
        </trim>
        <trim prefix="values (" suffix=")" suffixOverrides="," >
            <if test="xzqhbm != null" >
                #{xzqhbm,jdbcType=VARCHAR},
            </if>
            <if test="xzqhmc != null" >
                #{xzqhmc,jdbcType=VARCHAR},
            </if>
            <if test="fxzqhbm != null" >
                #{fxzqhbm,jdbcType=VARCHAR},
            </if>
            <if test="fxzqhmc != null" >
                #{fxzqhmc,jdbcType=VARCHAR},
            </if>
            <if test="gxsj != null" >
                #{gxsj,jdbcType=VARCHAR},
            </if>
            <if test="type != null" >
                #{type,jdbcType=VARCHAR},
            </if>
            <if test="info != null" >
                #{info,jdbcType=VARCHAR},
            </if>
            <if test="isparent != null" >
                #{isparent,jdbcType=VARCHAR},
            </if>
        </trim>
    </insert>

    <!--查询树形菜单数据-->
    <select id="getAllGroupList"   resultType="com.tdkj.model.PoorXzqh"  parameterType="java.lang.String">

        <if test="first != null and first !='' " >
            select groupid,isParent,parentid ,
            <if test="menutype == 'poorwork' " >
                xzqhmc||'('||countnum||'总户数，'||workernum||'总人数'||')'  name,
            </if>
            <if test="menutype == 'poor_taizhang' " >
                xzqhmc||'('||taizhangcountnum||'确认户数，'||taizhangworkernum||'确认人数'||')'  name,
            </if>
            <if test="menutype == 'worker' " >
                xzqhmc||'('||taizhangworkernum||'确认人数'||')'  name,
            </if>
            <if test="menutype == 'tobe_comfire_poor_taizhang' " >
                xzqhmc||'('||tobecomfirehu||'待确认户数，'||tobecomfireworkernum||'待确认人数'||')'  name,
            </if>
            <if test="menutype == 'tobe_comfire_worker' " >
                xzqhmc||'('||tobecomfireworkernum||'待确认人数'||')'  name,
            </if>
            <if test="menutype == 'wait_pf_hu' " >
                xzqhmc||'('||tobecompletehunum||'待完善户数'||')'  name,
            </if>
            <if test="menutype == 'wait_factory' " >
                xzqhmc||'('||tobecompletefactorynum||'待完善社区工厂数'||')'  name,
            </if>
            <if test="menutype == 'wait_base' " >
                xzqhmc||'('||tobecompletebasenum||'待完善扶贫基地数'||')'  name,
            </if>
            <if test="menutype == null or menutype =='' " >
                xzqhmc name,
            </if>
            groupname,type from (
            select xzqhbm  groupid,a.type,
            isParent isParent,
            fxzqhbm  parentid,

         <!--   <if test="menutype == 'poorwork' " >
                xzqhmc,
                zc.POOR_HU countnum,
                zc.worker workernum,
            </if>
            <if test="menutype == 'poor_taizhang' " >
                xzqhmc,
                zc.confirm_poor_hu taizhangcountnum,
                zc.confirm_worker taizhangworkernum,
            </if>
            <if test="menutype == 'worker' " >
                xzqhmc,
                zc.confirm_worker taizhangworkernum,
            </if>
            <if test="menutype == 'tobe_comfire_poor_taizhang' " >
                xzqhmc,
                zc.wait_roor_hu tobecomfirehu,
                zc.wait_worrer tobecomfireworkernum,
            </if>
            <if test="menutype == 'tobe_comfire_worker' " >
                xzqhmc,
                zc.wait_worrer tobecomfireworkernum,
            </if>
            <if test="menutype == 'wait_pf_hu' " >
                xzqhmc,
                zc.wait_pf_hu tobecompletehunum,
            </if>-->
            <if test="menutype == 'wait_factory' " >
                xzqhmc,
                ( select count(1)
                from community_factory c,RECURSION r
                where  ctf001 not in  (select r.companyid from relation r where r.aae100 = '1')   and c.aab301 = r.aab301

                and aae100='1'  and r.parentid  = a.xzqhbm) tobecompletefactorynum,
            </if>
            <if test="menutype == 'wait_base' " >
                xzqhmc,
                (select count(1)
                from poverty_alleviation_base c,RECURSION r
                where  aae100='1' and pab001 not in
                (select r.companyid from relation r where r.aae100 = '1')  and c.aab301 = r.aab301
                and r.parentid  = a.xzqhbm) tobecompletebasenum,
            </if>
            <if test="menutype == null or menutype =='' " >
                xzqhmc ,
            </if>
            xzqhmc groupname
            from poor_xzqh a
            where  xzqhbm =#{parentid,jdbcType=VARCHAR}order by sort,xzqhbm )
        </if>



        <if test="first == null or first =='' " >
            select xzqhbm  groupid,
            isParent isParent,
            fxzqhbm  parentid,
            <if test="menutype == 'poorwork' " >
                xzqhmc||'('||countnum||'总户数，'||workernum||'总人数'||')'  name,
            </if>
            <if test="menutype == 'poor_taizhang' " >
                xzqhmc||'('||taizhangcountnum||'确认户数，'||taizhangworkernum||'确认人数'||')'  name,
            </if>
            <if test="menutype == 'worker' " >
                xzqhmc||'('||taizhangworkernum||'确认人数'||')'  name,
            </if>
            <if test="menutype == 'tobe_comfire_poor_taizhang' " >
                xzqhmc||'('||tobecomfirehu||'待确认户数，'||tobecomfireworkernum||'待确认人数'||')'  name,
            </if>
            <if test="menutype == 'tobe_comfire_worker' " >
                xzqhmc||'('||tobecomfireworkernum||'待确认人数'||')'  name,
            </if>
            <if test="menutype == 'wait_pf_hu' " >
                xzqhmc||'('||tobecompletehunum||'待完善户数'||')'  name,
            </if>
            <if test="menutype == 'wait_factory' " >
                xzqhmc||'('||tobecompletefactorynum||'待完善社区工厂数'||')'  name,
            </if>
            <if test="menutype == 'wait_base' " >
                xzqhmc||'('||tobecompletebasenum||'待完善扶贫基地数'||')'  name,
            </if>
            <if test="menutype == null or menutype =='' " >
                xzqhmc  name,
            </if>
            t.xzqhmc groupname,type
            from (select a.xzqhbm,
            fxzqhbm,
            a.xzqhmc,a.type,
            case
            when (select count(*)
            from poor_xzqh s
            where s.fxzqhbm = a.xzqhbm) > 0 then
            'true'
            else
            'false'
            end isParent

            <if test="menutype == 'wait_factory' " >
                ,
                ( select count(1)
                from community_factory c,RECURSION r
                where  ctf001 not in  (select r.companyid from relation r where r.aae100 = '1') and c.aab301 = r.aab301
                and aae100='1'  and r.parentid  =  a.xzqhbm) tobecompletefactorynum
            </if>
            <if test="menutype == 'wait_base' " >
                ,
                (select count(1)
                from poverty_alleviation_base c,RECURSION r
                where  aae100='1' and pab001 not in
                (select r.companyid from relation r where r.aae100 = '1') and c.aab301 = r.aab301
                and r.parentid  =  a.xzqhbm) tobecompletebasenum
            </if>
            from poor_xzqh a
            where fxzqhbm =#{parentid,jdbcType=VARCHAR}
            order by  sort,xzqhbm ) t
        </if>
    </select>


    <!--查询所有行政区划，用于注册下拉框-->
    <select id="queryPoorXzqh"   resultType="com.tdkj.model.PoorXzqh"  parameterType="java.lang.String">
    select xzqhbm,type,info
    from poor_xzqh
  </select>

    <!--查询所有行政区划，用于注册下拉框-->
    <select id="queryPoorXzqhSub"   resultType="com.tdkj.model.PoorXzqh"  parameterType="java.lang.String">
    select type ,fxzqhbm,xzqhbm
    from poor_xzqh
    where xzqhbm = #{parentid,jdbcType=VARCHAR}
  </select>

    <!--查询所有的市，区，街道-->
    <select id="queryArea"   resultType="com.tdkj.model.PoorXzqh"  parameterType="java.lang.String">
    select * from poor_xzqh where xzqhbm ='610821012000'
  </select>

    <!--根据aab301 查询info -->
    <select id="queryAab301Info"   resultType="com.tdkj.model.PoorXzqh"  parameterType="java.lang.String">
    select * from poor_xzqh where xzqhbm = #{aab301,jdbcType=VARCHAR}
  </select>

    <!--查询树形菜单数据  没有使用-->
    <select id="getAllPoorWorkGroupList"   resultType="com.tdkj.model.PoorXzqh"  parameterType="java.lang.String">

        <if test="first != null and first !='' " >
            select xzqhbm  groupid,
            isParent isParent,
            fxzqhbm  parentid,
            xzqhmc  name,
            xzqhmc groupname
            from poor_xzqh a
            where xzqhbm = #{parentid,jdbcType=VARCHAR}  order by sort
        </if>



        <if test="first == null or first =='' " >
            select xzqhbm  groupid,
            isParent isParent,
            fxzqhbm  parentid,
            xzqhmc  name,
            t.xzqhmc groupname
            from (select a.xzqhbm,
            fxzqhbm,
            a.xzqhmc,
            case
            when (select count(*)
            from poor_xzqh s
            where s.fxzqhbm = a.xzqhbm) > 0 then
            'true'
            else
            'false'
            end isParent
            from poor_xzqh a
            where a.fxzqhbm = #{parentid,jdbcType=VARCHAR}
            order by sort,xzqhbm) t
        </if>
    </select>
    <select id="queryAllByAab301Statistics" parameterType="java.lang.String" resultMap="BaseResultMap">
        select xzqhbm,
        xzqhmc aab301,
        fxzqhbm,
        总户数 PHT001,
        有贫困劳动力户数 PHT002,
        最少就业一人的贫困户 PHT003,
        有就创业意愿户数 PHT004,
        贫困劳动力 PHT005,
        转移就业 PHT006,
        农业就业 PHT007,
        自主创业 PHT008,
        有就创业意愿人数 PHT009,
        技能培训 PHT010
        from (select xzqhbm,
        xzqhmc,
        fxzqhbm,
        sort,
        总户数,
        有贫困劳动力户数,
        最少就业一人的贫困户,
        有就创业意愿户数,
        贫困劳动力,
        转移就业,
        农业就业,
        自主创业,
        有就创业意愿人数,
        技能培训
        from (select d.xzqhbm,
        d.xzqhmc xzqhmc,
        d.fxzqhbm,
        d.sort,
        nvl((SELECT sum(count(a.aab301)) cun1
        FROM POOR_HOUSEHOLDS a
        where a.aae100 = '1'
        and a.aab301 like substr(xzqhbm, 0, #{len1}) || '%'
        <if test="phd013 != null and phd013 !='' " >
            and phd013 = #{phd013,jdbcType=VARCHAR}
        </if>
        group by a.aab301),
        0) 总户数,
        nvl((SELECT sum(count(1)) cun1
        FROM POOR_HOUSEHOLDS a
        where a.aae100 = '1'
        and a.aab301 like substr(xzqhbm, 0, #{len1}) || '%'

        AND A.PHD008 > 0
        <if test="phd013 != null and phd013 !='' " >
            and phd013 = #{phd013,jdbcType=VARCHAR}
        </if>
        group by a.aab301),
        0) 有贫困劳动力户数,
        nvl((select count(plf001)
        from (SELECT d.plf001,
        row_number() over(partition by d.plf002 order by aae036 desc) as sn
        FROM poor_labor_force d
        where d.aae100 = '1'
        and (plf011 = '2' or plf011 = '4')
        and d.aab301 like
        substr(xzqhbm, 0, #{len1}) || '%')
        <if test="phd013 != null and phd013 !='' " >
            and phd013 = #{phd013,jdbcType=VARCHAR}
        </if>
        where sn = 1),
        0) 最少就业一人的贫困户,
        nvl((SELECT sum(count(phd001)) cun2
        FROM poor_labor_force a, poor_households h
        where a.plf002 = h.phd001
        and a.aae100 = '1'
        and (plf018 in ('01', '02', '05') or
        plf018 is null)
        and (plf008 >= 16 and  plf008 &lt; 60)
        and (plf010 = '2' or plf010 = '1')
        and a.aab301 like substr(xzqhbm, 0, #{len1}) || '%'

        <if test="phd013 != null and phd013 !='' " >
            and phd013 = #{phd013,jdbcType=VARCHAR}
        </if>
        group by a.aab301, phd001),
        0) 有就创业意愿户数,
        nvl((SELECT sum(count(a.plf001)) cun2
        FROM poor_labor_force a
        where a.aae100 = '1'
        and (plf018 in ('01', '02', '05') or
        plf018 is null)
        and (plf008 >= 16 and  plf008 &lt; 60)
        and a.aab301 like substr(xzqhbm, 0, #{len1}) || '%'
        <if test="phd013 != null and phd013 !='' " >
            and phd013 = #{phd013,jdbcType=VARCHAR}
        </if>
        group by a.aab301),
        0) 贫困劳动力,
        nvl((SELECT sum(count(a.plf001)) cun2
        FROM poor_labor_force a, EMPLOYMENT_SITUATION e
        where a.plf001 = e.eys002
        and e.aae100 = '1'
        and e.eys004 = '1'
        and a.aab301 like substr(xzqhbm, 0, #{len1}) || '%'
        <if test="phd013 != null and phd013 !='' " >
            and phd013 = #{phd013,jdbcType=VARCHAR}
        </if>
        <if test="phd012 != null and phd012 !='' " >
            and substr(eys009, 0, 4)  = #{phd012,jdbcType=VARCHAR}
        </if>
        <if test="phd014 != null and phd014 !='' " >
            <if test="phd014 =='1' " >
                and eys010 is null
            </if>
            and tsn008
        </if>

        group by a.aab301, a.plf001),
        0) 转移就业,
        nvl((SELECT sum(count(a.plf001)) cun2
        FROM poor_labor_force a, EMPLOYMENT_SITUATION e
        where a.plf001 = e.eys002
        and e.aae100 = '1'
        and e.eys004 = '3'
        and a.aab301 like substr(xzqhbm, 0, #{len1}) || '%'
        <if test="phd013 != null and phd013 !='' " >
            and phd013 = #{phd013,jdbcType=VARCHAR}
        </if>
        <if test="phd012 != null and phd012 !='' " >
            and substr(eys009, 0, 4)  = #{phd012,jdbcType=VARCHAR}
        </if>
        <if test="phd014 != null and phd014 !='' " >
            <if test="phd014 =='1' " >
                and eys010 is null
            </if>
            and tsn008
        </if>
        group by a.aab301, a.plf001),
        0) 农业就业,
        nvl((SELECT sum(count(a.plf001)) cun2
        FROM poor_labor_force a, ENTREPRENEURSHIP e
        where a.plf001 = e.epp002
        and e.aae100 = '1'
        <if test="phd012 != null and phd012 !='' " >
            and substr(epp006, 0, 4)  = #{phd012,jdbcType=VARCHAR}
        </if>

        <if test="phd013 != null and phd013 !='' " >
            and phd013 = #{phd013,jdbcType=VARCHAR}
        </if>
        and a.aab301 like substr(xzqhbm, 0, #{len1}) || '%'
        group by a.aab301, a.plf001),
        0) 自主创业,
        nvl((SELECT sum(count(plf001)) cun2
        FROM poor_labor_force a
        where a.aae100 = '1'
        and (plf018 in ('01', '02', '05') or
        plf018 is null)
        and (plf008 >= 16 and  plf008 &lt; 60)
        and (plf010 = '2' or plf010 = '1')
        and a.aab301 like substr(xzqhbm, 0, #{len1}) || '%'
        <if test="phd013 != null and phd013 !='' " >
            and phd013 = #{phd013,jdbcType=VARCHAR}
        </if>
        group by a.aab301),
        0) 有就创业意愿人数,
        nvl((SELECT sum(count(a.plf001)) cun2
        FROM poor_labor_force a, TRAINING_SITUATION e
        where a.plf001 = e.tsn010
        and e.aae100 = '1'
        and tsn003 != '4'
        and a.aab301 like substr(xzqhbm, 0, #{len1}) || '%'
        <if test="phd012 != null and phd012 !='' " >
            and substr(tsn007, 0, 4) = #{phd012,jdbcType=VARCHAR}
        </if>
        <if test="phd014 != null and phd014 !='' " >
            <if test="phd014 =='1' " >
                and tsn008 is null
            </if>
            and tsn008=#{phd014,jdbcType=VARCHAR}
        </if>
        <if test="phd013 != null and phd013 !='' " >
            and phd013 = #{phd013,jdbcType=VARCHAR}
        </if>
        group by a.aab301, a.plf001),
        0) 技能培训
        from poor_xzqh d
        where fxzqhbm  = #{aab301,jdbcType=VARCHAR})
        union
        select xzqhbm,
        xzqhmc,
        fxzqhbm,
        sort,
        总户数,
        有贫困劳动力户数,
        最少就业一人的贫困户,
        有就创业意愿户数,
        贫困劳动力,
        转移就业,
        农业就业,
        自主创业,
        有就创业意愿人数,
        技能培训
        from (select xzqhbm,
        xzqhmc,
        fxzqhbm,
        sort,
        总户数,
        有贫困劳动力户数,
        最少就业一人的贫困户,
        有就创业意愿户数,
        贫困劳动力,
        转移就业,
        农业就业,
        自主创业,
        有就创业意愿人数,
        技能培训
        from (select d.xzqhbm,
        d.xzqhmc xzqhmc,
        d.fxzqhbm,
        d.sort,
        nvl((SELECT sum(count(a.aab301)) cun1
        FROM POOR_HOUSEHOLDS a
        where a.aae100 = '1'
        and a.aab301 like substr(xzqhbm,0,2) || '%'
        <if test="phd013 != null and phd013 !='' " >
            and phd013 = #{phd013,jdbcType=VARCHAR}
        </if>
        group by a.aab301),
        0) 总户数,
        nvl((SELECT sum(count(1)) cun1
        FROM POOR_HOUSEHOLDS a
        where a.aae100 = '1'
        and a.aab301 like substr(xzqhbm,0,2) || '%'

        AND A.PHD008 > 0
        <if test="phd013 != null and phd013 !='' " >
            and phd013 = #{phd013,jdbcType=VARCHAR}
        </if>
        group by a.aab301),
        0) 有贫困劳动力户数,
        nvl((select count(plf001)
        from (SELECT d.plf001,
        row_number() over(partition by d.plf002 order by aae036 desc) as sn
        FROM poor_labor_force d
        where d.aae100 = '1'
        and (plf011 = '2' or plf011 = '4')
        and d.aab301 like
        substr(xzqhbm,0,2) || '%')
        <if test="phd013 != null and phd013 !='' " >
            and phd013 = #{phd013,jdbcType=VARCHAR}
        </if>
        where sn = 1),
        0) 最少就业一人的贫困户,
        nvl((SELECT sum(count(phd001)) cun2
        FROM poor_labor_force a, poor_households h
        where a.plf002 = h.phd001
        and a.aae100 = '1'
        and (plf018 in ('01', '02', '05') or
        plf018 is null)
        and (plf008 >= 16 and  plf008 &lt; 60)
        and (plf010 = '2' or plf010 = '1')
        and a.aab301 like substr(xzqhbm,0,2) || '%'

        <if test="phd013 != null and phd013 !='' " >
            and phd013 = #{phd013,jdbcType=VARCHAR}
        </if>
        group by a.aab301, phd001),
        0) 有就创业意愿户数,
        nvl((SELECT sum(count(a.plf001)) cun2
        FROM poor_labor_force a
        where a.aae100 = '1'
        and (plf018 in ('01', '02', '05') or
        plf018 is null)
        and (plf008 >= 16 and  plf008 &lt; 60)
        and a.aab301 like substr(xzqhbm,0,2) || '%'
        <if test="phd013 != null and phd013 !='' " >
            and phd013 = #{phd013,jdbcType=VARCHAR}
        </if>
        group by a.aab301),
        0) 贫困劳动力,
        nvl((SELECT sum(count(a.plf001)) cun2
        FROM poor_labor_force a, EMPLOYMENT_SITUATION e
        where a.plf001 = e.eys002
        and e.aae100 = '1'
        and e.eys004 = '1'
        and a.aab301 like substr(xzqhbm,0,2) || '%'
        <if test="phd013 != null and phd013 !='' " >
            and phd013 = #{phd013,jdbcType=VARCHAR}
        </if>
        <if test="phd012 != null and phd012 !='' " >
            and substr(eys009, 0, 4)  = #{phd012,jdbcType=VARCHAR}
        </if>
        <if test="phd014 != null and phd014 !='' " >
            <if test="phd014 =='1' " >
                and eys010 is null
            </if>
            and tsn008
        </if>

        group by a.aab301, a.plf001),
        0) 转移就业,
        nvl((SELECT sum(count(a.plf001)) cun2
        FROM poor_labor_force a, EMPLOYMENT_SITUATION e
        where a.plf001 = e.eys002
        and e.aae100 = '1'
        and e.eys004 = '3'
        and a.aab301 like substr(xzqhbm,0,2) || '%'
        <if test="phd013 != null and phd013 !='' " >
            and phd013 = #{phd013,jdbcType=VARCHAR}
        </if>
        <if test="phd012 != null and phd012 !='' " >
            and substr(eys009, 0, 4)  = #{phd012,jdbcType=VARCHAR}
        </if>
        <if test="phd014 != null and phd014 !='' " >
            <if test="phd014 =='1' " >
                and eys010 is null
            </if>
            and tsn008
        </if>
        group by a.aab301, a.plf001),
        0) 农业就业,
        nvl((SELECT sum(count(a.plf001)) cun2
        FROM poor_labor_force a, ENTREPRENEURSHIP e
        where a.plf001 = e.epp002
        and e.aae100 = '1'
        <if test="phd012 != null and phd012 !='' " >
            and substr(epp006, 0, 4)  = #{phd012,jdbcType=VARCHAR}
        </if>

        <if test="phd013 != null and phd013 !='' " >
            and phd013 = #{phd013,jdbcType=VARCHAR}
        </if>
        and a.aab301 like substr(xzqhbm,0,2) || '%'
        group by a.aab301, a.plf001),
        0) 自主创业,
        nvl((SELECT sum(count(plf001)) cun2
        FROM poor_labor_force a
        where a.aae100 = '1'
        and (plf018 in ('01', '02', '05') or
        plf018 is null)
        and (plf008 >= 16 and  plf008 &lt; 60)
        and (plf010 = '2' or plf010 = '1')
        and a.aab301 like substr(xzqhbm,0,2) || '%'
        <if test="phd013 != null and phd013 !='' " >
            and phd013 = #{phd013,jdbcType=VARCHAR}
        </if>
        group by a.aab301),
        0) 有就创业意愿人数,
        nvl((SELECT sum(count(a.plf001)) cun2
        FROM poor_labor_force a, TRAINING_SITUATION e
        where a.plf001 = e.tsn010
        and e.aae100 = '1'
        and tsn003 != '4'
        and a.aab301 like substr(xzqhbm,0,2) || '%'
        <if test="phd012 != null and phd012 !='' " >
            and substr(tsn007, 0, 4) = #{phd012,jdbcType=VARCHAR}
        </if>
        <if test="phd014 != null and phd014 !='' " >
            <if test="phd014 =='1' " >
                and tsn008 is null
            </if>
            and tsn008
        </if>
        <if test="phd013 != null and phd013 !='' " >
            and phd013 = #{phd013,jdbcType=VARCHAR}
        </if>
        group by a.aab301, a.plf001),
        0) 技能培训
        from poor_xzqh d
        where xzqhbm = #{aab301,jdbcType=VARCHAR})))
        order by sort

    </select>
    <select id="RelocationqueryAllByAab301Statistics" parameterType="java.lang.String" resultMap="BaseResultMap">
       select xzqhmc AAB301,
                转移就业  PHT001,
                自主创业 PHT002,
                技能培训 PHT003,
                创业培训 PHT004,
                苏陕协作转移就业 PHT005,
                社区工厂 PHT006,
                扶贫基地 PHT007,
                城镇公岗 PHT008,
                公益专岗数 PHT009,
                特设公岗 PHT010,
                苏陕协作培训 PHT011,
                技工院校 PHT012 from(


         select xzqhmc,sort,
                转移就业,
                自主创业,
                技能培训,
                创业培训,
                苏陕协作转移就业,
                社区工厂,
                扶贫基地,
                城镇公岗,
                公益专岗数,
                特设公岗,
                苏陕协作培训,
                技工院校

           from (select xzqhmc,sort,
                        (select count(1)
                           from poor_households p, poor_labor_force l
                          where p.phd001 = l.plf002
                            and phd013 = '1'
                            and PLF011 = '2'

                            and p.aab301 like substr(c.xzqhbm, 0, #{len1}) || '%'

                         ) 转移就业,
                        (select count(1)
                           from poor_households p, poor_labor_force l
                          where p.phd001 = l.plf002
                            and phd013 = '1'
                            and PLF011 = '5'
                            and l.aae100 = '1'

                            and p.aab301 like substr(c.xzqhbm, 0, #{len1}) || '%'

                         ) 自主创业,
                        (select count(1)
                           from poor_households p, poor_labor_force l
                          where p.phd001 = l.plf002
                            and phd013 = '1'
                            and PLF024 = '1'
                            and l.aae100 = '1'

                            and p.aab301 like substr(c.xzqhbm, 0, #{len1}) || '%'

                         ) 技能培训,
                        (select count(1)
                           from poor_households p, poor_labor_force l
                          where p.phd001 = l.plf002
                            and phd013 = '1'
                            and PLF024 = '2'
                            and l.aae100 = '1'

                            and p.aab301 like substr(c.xzqhbm, 0, #{len1}) || '%'

                         ) 创业培训,

                        (select count(1)
                           from poor_households     p,
                                poor_labor_force    l,
                                EMPLOYMENT_SITUATION e

                          where p.phd001 = l.plf002
                            and l.plf001 = e.eys002
                            and e.aae100 = '1'
                            and (eys011 = '3' or eys011 = '4')

                            and p.aab301 like substr(c.xzqhbm, 0, #{len1}) || '%'

                         ) 苏陕协作转移就业,
                        (select count(1)
                           from COMMUNITY_FACTORY p
                          where aae100 = '1'

                            and p.aab301 like substr(c.xzqhbm, 0, #{len1}) || '%'
                            and ctf004 is not null) 社区工厂,
                        (select count(1)
                           from POVERTY_ALLEVIATION_BASE p
                          where aae100 = '1'

                            and p.aab301 like substr(c.xzqhbm, 0, #{len1}) || '%'
                            and pab013 is not null) 扶贫基地,
                        (select count(1)
                           from poor_households     p,
                                poor_labor_force    l,
                                EMPLOYMENT_SITUATION e

                          where p.phd001 = l.plf002
                            and l.plf001 = e.eys002
                            and e.aae100 = '1'
                            and eys011 = '6'

                            and p.aab301 like substr(c.xzqhbm, 0, #{len1}) || '%') 城镇公岗,
                        (select count(1)
                           from poor_households     p,
                                poor_labor_force    l,
                                EMPLOYMENT_SITUATION e

                          where p.phd001 = l.plf002
                            and l.plf001 = e.eys002
                            and e.aae100 = '1'
                            and eys011 = '5'

                            and p.aab301 like substr(c.xzqhbm, 0, #{len1}) || '%') 公益专岗数,
                        (select count(1)
                           from poor_households     p,
                                poor_labor_force    l,
                                EMPLOYMENT_SITUATION e

                          where p.phd001 = l.plf002
                            and l.plf001 = e.eys002
                            and e.aae100 = '1'
                            and eys011 = '7'

                            and p.aab301 like substr(c.xzqhbm, 0, #{len1}) || '%') 特设公岗,
                        (select count(1)
                           from poor_households  p,
                                poor_labor_force l,
                                TRAINING_SITUATION e

                          where p.phd001 = l.plf002
                            and l.plf001 = e.tsn010
                            and e.aae100 = '1'
                            and tsn012 = '1'

                            and p.aab301 like substr(c.xzqhbm, 0, #{len1}) || '%') 苏陕协作培训,

                        (select count(1)
                           from poor_households  p,
                                poor_labor_force l,
                                TECHNICAL_SCHOOLS e

                          where p.phd001 = l.plf002
                            and l.plf001 = e.ths002
                            and e.aae100 = '1'

                            and p.aab301 like substr(c.xzqhbm, 0, #{len1}) || '%') 技工院校
                   from poor_xzqh c
                  where fxzqhbm = #{aab301,jdbcType=VARCHAR}

                 )
         union

         select xzqhmc,sort,
                转移就业,
                自主创业,
                技能培训,
                创业培训,
                苏陕协作转移就业,
                社区工厂,
                扶贫基地,
                城镇公岗,
                公益专岗数,
                特设公岗,
                苏陕协作培训,
                技工院校

           from (select xzqhmc,sort,
                        (select count(1)
                           from poor_households p, poor_labor_force l
                          where p.phd001 = l.plf002
                            and phd013 = '1'
                            and PLF011 = '2'

                            and p.aab301 like substr(c.xzqhbm, 0, #{len2}) || '%'

                         ) 转移就业,
                        (select count(1)
                           from poor_households p, poor_labor_force l
                          where p.phd001 = l.plf002
                            and phd013 = '1'
                            and PLF011 = '5'
                            and l.aae100 = '1'

                            and p.aab301 like substr(c.xzqhbm, 0, #{len2}) || '%'

                         ) 自主创业,
                        (select count(1)
                           from poor_households p, poor_labor_force l
                          where p.phd001 = l.plf002
                            and phd013 = '1'
                            and PLF024 = '1'
                            and l.aae100 = '1'

                            and p.aab301 like substr(c.xzqhbm, 0, #{len2}) || '%'

                         ) 技能培训,
                        (select count(1)
                           from poor_households p, poor_labor_force l
                          where p.phd001 = l.plf002
                            and phd013 = '1'
                            and PLF024 = '2'
                            and l.aae100 = '1'

                            and p.aab301 like substr(c.xzqhbm, 0, #{len2}) || '%'

                         ) 创业培训,

                        (select count(1)
                           from poor_households     p,
                                poor_labor_force    l,
                                EMPLOYMENT_SITUATION e

                          where p.phd001 = l.plf002
                            and l.plf001 = e.eys002
                            and e.aae100 = '1'
                            and (eys011 = '3' or eys011 = '2')

                            and p.aab301 like substr(c.xzqhbm, 0, #{len2}) || '%'

                         ) 苏陕协作转移就业,
                        (select count(1)
                           from COMMUNITY_FACTORY p
                          where aae100 = '1'

                            and p.aab301 like substr(c.xzqhbm, 0, #{len2}) || '%'
                            and ctf002 is not null) 社区工厂,
                        (select count(1)
                           from POVERTY_ALLEVIATION_BASE p
                          where aae100 = '1'

                            and p.aab301 like substr(c.xzqhbm, 0, #{len2}) || '%'
                            and pab013 is not null) 扶贫基地,
                        (select count(1)
                           from poor_households     p,
                                poor_labor_force    l,
                                EMPLOYMENT_SITUATION e

                          where p.phd001 = l.plf002
                            and l.plf001 = e.eys002
                            and e.aae100 = '1'
                            and eys011 = '6'

                            and p.aab301 like substr(c.xzqhbm, 0, #{len2}) || '%') 城镇公岗,
                        (select count(1)
                           from poor_households     p,
                                poor_labor_force    l,
                                EMPLOYMENT_SITUATION e

                          where p.phd001 = l.plf002
                            and l.plf001 = e.eys002
                            and e.aae100 = '1'
                            and eys011 = '5'

                            and p.aab301 like substr(c.xzqhbm, 0, #{len2}) || '%') 公益专岗数,
                        (select count(1)
                           from poor_households     p,
                                poor_labor_force    l,
                                EMPLOYMENT_SITUATION e

                          where p.phd001 = l.plf002
                            and l.plf001 = e.eys002
                            and e.aae100 = '1'
                            and eys011 = '7'

                            and p.aab301 like substr(c.xzqhbm, 0, #{len2}) || '%') 特设公岗,
                        (select count(1)
                           from poor_households  p,
                                poor_labor_force l,
                                TRAINING_SITUATION e

                          where p.phd001 = l.plf002
                            and l.plf001 = e.tsn010
                            and e.aae100 = '1'
                            and tsn012 = '1'

                            and p.aab301 like substr(c.xzqhbm, 0, #{len2}) || '%') 苏陕协作培训,

                        (select count(1)
                           from poor_households  p,
                                poor_labor_force l,
                                TECHNICAL_SCHOOLS e
                          where p.phd001 = l.plf002
                            and l.plf001 = e.ths002
                            and e.aae100 = '1'

                            and p.aab301 like substr(c.xzqhbm, 0, #{len2}) || '%') 技工院校
                   from poor_xzqh c
                  where xzqhbm  = #{aab301,jdbcType=VARCHAR}
                  )
         )order by sort

    </select>
    <select id="EploymentqueryAllByAab301Statistics" resultType="com.tdkj.model.PoorHouseholdTranslation">

        select xzqhmc aab301,

        转移就业总数 pht001,
        镇内 pht002,
        镇外县内 pht003,
        县外市内 pht004,
        市外省内 pht005,
        省外 pht006,
        国外 pht007,
        国企 pht008,
        民企 pht009,
        个体户 pht010,
        党政机关 pht011,
        事业单位 pht012,
        合作社 pht013,
        合计 pht014,
        社区工厂 pht015,
        就业扶贫基地 pht016,
        公岗小计 pht017,
        城镇公岗 pht018,
        公益专岗 pht019,
        特设公岗 pht020,
        苏陕协作 pht021,
        在苏就业 pht022,
        在陕就业 pht023,
        易地搬迁 pht024
        from (

        select xzqhmc,
        sort,
        转移就业总数,
        镇内,
        镇外县内,
        县外市内,
        市外省内,
        省外,
        国外,
        国企,
        民企,
        个体户,
        党政机关,
        事业单位,
        合作社,
        合计,
        社区工厂,
        就业扶贫基地,
        公岗小计,
        城镇公岗,
        公益专岗,
        特设公岗,
        苏陕协作,
        在苏就业,
        在陕就业,
        易地搬迁

        from (select xzqhmc,
        sort,
        (select count(1)
        from (select s.eys001,

        row_number() over(partition by s.eys002 order by eys009 desc) as sn
        from EMPLOYMENT_SITUATION s
        where s.aae100 = '1'
        <if test="phd012 != null and phd012 !='' " >
            and substr(eys009, 0, 4)  = #{phd012,jdbcType=VARCHAR}
        </if>
        and s.aab301 like
        substr(c.xzqhbm, 0, #{len1}) || '%')

        where sn = 1

        ) 转移就业总数,
        (select count(1)
        from (select s.eys001,

        row_number() over(partition by s.eys002 order by eys009 desc) as sn
        from EMPLOYMENT_SITUATION s
        where s.aae100 = '1'
        <if test="phd012 != null and phd012 !='' " >
            and substr(eys009, 0, 4)  = #{phd012,jdbcType=VARCHAR}
        </if>
        and eys012 = '1'
        and s.aab301 like
        substr(c.xzqhbm, 0, #{len1}) || '%')

        where sn = 1

        ) 镇内,

        (select count(1)
        from (select s.eys001,

        row_number() over(partition by s.eys002 order by eys009 desc) as sn
        from EMPLOYMENT_SITUATION s
        where s.aae100 = '1'
        <if test="phd012 != null and phd012 !='' " >
            and substr(eys009, 0, 4)  = #{phd012,jdbcType=VARCHAR}
        </if>
        and eys012 = '2'
        and s.aab301 like
        substr(c.xzqhbm, 0, #{len1}) || '%')

        where sn = 1

        ) 镇外县内,

        (select count(1)
        from (select s.eys001,

        row_number() over(partition by s.eys002 order by eys009 desc) as sn
        from EMPLOYMENT_SITUATION s
        where s.aae100 = '1'
        <if test="phd012 != null and phd012 !='' " >
            and substr(eys009, 0, 4)  = #{phd012,jdbcType=VARCHAR}
        </if>
        and eys012 = '3'
        and s.aab301 like
        substr(c.xzqhbm, 0, #{len1}) || '%')

        where sn = 1

        ) 县外市内,

        (select count(1)
        from (select s.eys001,

        row_number() over(partition by s.eys002 order by eys009 desc) as sn
        from EMPLOYMENT_SITUATION s
        where s.aae100 = '1'
        <if test="phd012 != null and phd012 !='' " >
            and substr(eys009, 0, 4)  = #{phd012,jdbcType=VARCHAR}
        </if>
        and eys012 = '4'
        and s.aab301 like
        substr(c.xzqhbm, 0, #{len1}) || '%')

        where sn = 1

        ) 市外省内,

        (select count(1)
        from (select s.eys001,

        row_number() over(partition by s.eys002 order by eys009 desc) as sn
        from EMPLOYMENT_SITUATION s
        where s.aae100 = '1'
        <if test="phd012 != null and phd012 !='' " >
            and substr(eys009, 0, 4)  = #{phd012,jdbcType=VARCHAR}
        </if>
        and eys012 = '5'
        and s.aab301 like
        substr(c.xzqhbm, 0, #{len1}) || '%')

        where sn = 1

        ) 省外,

        (select count(1)
        from (select s.eys001,

        row_number() over(partition by s.eys002 order by eys009 desc) as sn
        from EMPLOYMENT_SITUATION s
        where s.aae100 = '1'
        <if test="phd012 != null and phd012 !='' " >
            and substr(eys009, 0, 4)  = #{phd012,jdbcType=VARCHAR}
        </if>
        and eys012 = '6'
        and s.aab301 like
        substr(c.xzqhbm, 0, #{len1}) || '%')

        where sn = 1

        ) 国外,

        (select count(1)
        from (select s.eys001,

        row_number() over(partition by s.eys002 order by eys009 desc) as sn
        from EMPLOYMENT_SITUATION s
        where s.aae100 = '1'
        <if test="phd012 != null and phd012 !='' " >
            and substr(eys009, 0, 4)  = #{phd012,jdbcType=VARCHAR}
        </if>
        and eys007 = '001'
        and s.aab301 like
        substr(c.xzqhbm, 0, #{len1}) || '%')

        where sn = 1

        ) 国企,
        (select count(1)
        from (select s.eys001,

        row_number() over(partition by s.eys002 order by eys009 desc) as sn
        from EMPLOYMENT_SITUATION s
        where s.aae100 = '1'
        <if test="phd012 != null and phd012 !='' " >
            and substr(eys009, 0, 4)  = #{phd012,jdbcType=VARCHAR}
        </if>
        and eys007 = '002'
        and s.aab301 like
        substr(c.xzqhbm, 0, #{len1}) || '%')

        where sn = 1

        ) 民企,
        (select count(1)
        from (select s.eys001,

        row_number() over(partition by s.eys002 order by eys009 desc) as sn
        from EMPLOYMENT_SITUATION s
        where s.aae100 = '1'
        <if test="phd012 != null and phd012 !='' " >
            and substr(eys009, 0, 4)  = #{phd012,jdbcType=VARCHAR}
        </if>
        and eys007 = '003'
        and s.aab301 like
        substr(c.xzqhbm, 0, #{len1}) || '%')

        where sn = 1

        ) 个体户,
        (select count(1)
        from (select s.eys001,

        row_number() over(partition by s.eys002 order by eys009 desc) as sn
        from EMPLOYMENT_SITUATION s
        where s.aae100 = '1'
        <if test="phd012 != null and phd012 !='' " >
            and substr(eys009, 0, 4)  = #{phd012,jdbcType=VARCHAR}
        </if>
        and eys007 = '004'
        and s.aab301 like
        substr(c.xzqhbm, 0, #{len1}) || '%')

        where sn = 1

        ) 党政机关,
        (select count(1)
        from (select s.eys001,

        row_number() over(partition by s.eys002 order by eys009 desc) as sn
        from EMPLOYMENT_SITUATION s
        where s.aae100 = '1'
        <if test="phd012 != null and phd012 !='' " >
            and substr(eys009, 0, 4)  = #{phd012,jdbcType=VARCHAR}
        </if>
        and eys007 = '005'
        and s.aab301 like
        substr(c.xzqhbm, 0, #{len1}) || '%')

        where sn = 1

        ) 事业单位,
        (select count(1)
        from (select s.eys001,

        row_number() over(partition by s.eys002 order by eys009 desc) as sn
        from EMPLOYMENT_SITUATION s
        where s.aae100 = '1'
        <if test="phd012 != null and phd012 !='' " >
            and substr(eys009, 0, 4)  = #{phd012,jdbcType=VARCHAR}
        </if>
        and eys007 = '006'
        and s.aab301 like
        substr(c.xzqhbm, 0, #{len1}) || '%')

        where sn = 1

        ) 合作社,
        (select count(1)
        from (select s.eys001,

        row_number() over(partition by s.eys002 order by eys009 desc) as sn
        from EMPLOYMENT_SITUATION s
        where s.aae100 = '1'
        <if test="phd012 != null and phd012 !='' " >
            and substr(eys009, 0, 4)  = #{phd012,jdbcType=VARCHAR}
        </if>
        and eys011 is not null
        and s.aab301 like
        substr(c.xzqhbm, 0, #{len1}) || '%')

        where sn = 1

        ) 合计,
        (select count(1)
        from (select s.eys001,

        row_number() over(partition by s.eys002 order by eys009 desc) as sn
        from EMPLOYMENT_SITUATION s
        where s.aae100 = '1'
        <if test="phd012 != null and phd012 !='' " >
            and substr(eys009, 0, 4)  = #{phd012,jdbcType=VARCHAR}
        </if>
        and eys011 = '1'
        and s.aab301 like
        substr(c.xzqhbm, 0, #{len1}) || '%')

        where sn = 1

        ) 社区工厂,

        (select count(1)
        from (select s.eys001,

        row_number() over(partition by s.eys002 order by eys009 desc) as sn
        from EMPLOYMENT_SITUATION s
        where s.aae100 = '1'
        <if test="phd012 != null and phd012 !='' " >
            and substr(eys009, 0, 4)  = #{phd012,jdbcType=VARCHAR}
        </if>
        and eys011 = '2'
        and s.aab301 like
        substr(c.xzqhbm, 0, #{len1}) || '%')

        where sn = 1

        ) 就业扶贫基地,

        (select count(1)
        from (select s.eys001,

        row_number() over(partition by s.eys002 order by eys009 desc) as sn
        from EMPLOYMENT_SITUATION s
        where s.aae100 = '1'
        <if test="phd012 != null and phd012 !='' " >
            and substr(eys009, 0, 4)  = #{phd012,jdbcType=VARCHAR}
        </if>
        and (eys011 = '5' or eys011 = '6' or
        eys011 = '7')
        and s.aab301 like
        substr(c.xzqhbm, 0, #{len1}) || '%')

        where sn = 1

        ) 公岗小计,

        (select count(1)
        from (select s.eys001,

        row_number() over(partition by s.eys002 order by eys009 desc) as sn
        from EMPLOYMENT_SITUATION s
        where s.aae100 = '1'
        <if test="phd012 != null and phd012 !='' " >
            and substr(eys009, 0, 4)  = #{phd012,jdbcType=VARCHAR}
        </if>
        and eys011 = '6'
        and s.aab301 like
        substr(c.xzqhbm, 0, #{len1}) || '%')

        where sn = 1

        ) 城镇公岗,

        (select count(1)
        from (select s.eys001,

        row_number() over(partition by s.eys002 order by eys009 desc) as sn
        from EMPLOYMENT_SITUATION s
        where s.aae100 = '1'
        <if test="phd012 != null and phd012 !='' " >
            and substr(eys009, 0, 4)  = #{phd012,jdbcType=VARCHAR}
        </if>
        and eys011 = '5'
        and s.aab301 like
        substr(c.xzqhbm, 0, #{len1}) || '%')

        where sn = 1

        ) 公益专岗,

        (select count(1)
        from (select s.eys001,

        row_number() over(partition by s.eys002 order by eys009 desc) as sn
        from EMPLOYMENT_SITUATION s
        where s.aae100 = '1'
        <if test="phd012 != null and phd012 !='' " >
            and substr(eys009, 0, 4)  = #{phd012,jdbcType=VARCHAR}
        </if>
        and eys011 = '7'
        and s.aab301 like
        substr(c.xzqhbm, 0, #{len1}) || '%')

        where sn = 1

        ) 特设公岗,

        (select count(1)
        from (select s.eys001,

        row_number() over(partition by s.eys002 order by eys009 desc) as sn
        from EMPLOYMENT_SITUATION s
        where s.aae100 = '1'
        <if test="phd012 != null and phd012 !='' " >
            and substr(eys009, 0, 4)  = #{phd012,jdbcType=VARCHAR}
        </if>
        and (eys011 = '3' or eys011 = '4')
        and s.aab301 like
        substr(c.xzqhbm, 0, #{len1}) || '%')

        where sn = 1

        ) 苏陕协作,

        (select count(1)
        from (select s.eys001,

        row_number() over(partition by s.eys002 order by eys009 desc) as sn
        from EMPLOYMENT_SITUATION s
        where s.aae100 = '1'
        <if test="phd012 != null and phd012 !='' " >
            and substr(eys009, 0, 4)  = #{phd012,jdbcType=VARCHAR}
        </if>
        and eys011 = '3'
        and s.aab301 like
        substr(c.xzqhbm, 0, #{len1}) || '%')

        where sn = 1

        ) 在苏就业,

        (select count(1)
        from (select s.eys001,

        row_number() over(partition by s.eys002 order by eys009 desc) as sn
        from EMPLOYMENT_SITUATION s
        where s.aae100 = '1'
        <if test="phd012 != null and phd012 !='' " >
            and substr(eys009, 0, 4)  = #{phd012,jdbcType=VARCHAR}
        </if>
        and eys011 = '4'
        and s.aab301 like
        substr(c.xzqhbm, 0, #{len1}) || '%')

        where sn = 1

        ) 在陕就业,

        (select count(1)
        from (select s.eys001,

        row_number() over(partition by s.eys002 order by eys009 desc) as sn
        from poor_households      p,
        poor_labor_force     l,
        EMPLOYMENT_SITUATION s
        where p.phd001 = l.plf002
        and l.plf001 = s.eys002
        and phd013 = '1'
        and PLF011 = '2'
        and s.aae100 = '1'
        <if test="phd012 != null and phd012 !='' " >
            and substr(eys009, 0, 4)  = #{phd012,jdbcType=VARCHAR}
        </if>
        and eys011 = '4'
        and s.aab301 like
        substr(c.xzqhbm, 0, #{len1}) || '%')

        where sn = 1

        ) 易地搬迁

        from poor_xzqh c
        where fxzqhbm = #{aab301,jdbcType=VARCHAR})

        union
        select xzqhmc,
        sort,
        转移就业总数,
        镇内,
        镇外县内,
        县外市内,
        市外省内,
        省外,
        国外,
        国企,
        民企,
        个体户,
        党政机关,
        事业单位,
        合作社,
        合计,
        社区工厂,
        就业扶贫基地,
        公岗小计,
        城镇公岗,
        公益专岗,
        特设公岗,
        苏陕协作,
        在苏就业,
        在陕就业,
        易地搬迁

        from (select xzqhmc,
        sort,
        (select count(1)
        from (select s.eys001,

        row_number() over(partition by s.eys002 order by eys009 desc) as sn
        from EMPLOYMENT_SITUATION s
        where s.aae100 = '1'
        <if test="phd012 != null and phd012 !='' " >
            and substr(eys009, 0, 4)  = #{phd012,jdbcType=VARCHAR}
        </if>
        and s.aab301 like
        substr(c.xzqhbm, 0, 2) || '%')

        where sn = 1

        ) 转移就业总数,
        (select count(1)
        from (select s.eys001,

        row_number() over(partition by s.eys002 order by eys009 desc) as sn
        from EMPLOYMENT_SITUATION s
        where s.aae100 = '1'
        <if test="phd012 != null and phd012 !='' " >
            and substr(eys009, 0, 4)  = #{phd012,jdbcType=VARCHAR}
        </if>
        and eys012 = '1'
        and s.aab301 like
        substr(c.xzqhbm, 0, 2) || '%')

        where sn = 1

        ) 镇内,

        (select count(1)
        from (select s.eys001,

        row_number() over(partition by s.eys002 order by eys009 desc) as sn
        from EMPLOYMENT_SITUATION s
        where s.aae100 = '1'
        <if test="phd012 != null and phd012 !='' " >
            and substr(eys009, 0, 4)  = #{phd012,jdbcType=VARCHAR}
        </if>
        and eys012 = '2'
        and s.aab301 like
        substr(c.xzqhbm, 0, 2) || '%')

        where sn = 1

        ) 镇外县内,

        (select count(1)
        from (select s.eys001,

        row_number() over(partition by s.eys002 order by eys009 desc) as sn
        from EMPLOYMENT_SITUATION s
        where s.aae100 = '1'
        <if test="phd012 != null and phd012 !='' " >
            and substr(eys009, 0, 4)  = #{phd012,jdbcType=VARCHAR}
        </if>
        and eys012 = '3'
        and s.aab301 like
        substr(c.xzqhbm, 0, 2) || '%')

        where sn = 1

        ) 县外市内,

        (select count(1)
        from (select s.eys001,

        row_number() over(partition by s.eys002 order by eys009 desc) as sn
        from EMPLOYMENT_SITUATION s
        where s.aae100 = '1'
        <if test="phd012 != null and phd012 !='' " >
            and substr(eys009, 0, 4)  = #{phd012,jdbcType=VARCHAR}
        </if>
        and eys012 = '4'
        and s.aab301 like
        substr(c.xzqhbm, 0, 2) || '%')

        where sn = 1

        ) 市外省内,

        (select count(1)
        from (select s.eys001,

        row_number() over(partition by s.eys002 order by eys009 desc) as sn
        from EMPLOYMENT_SITUATION s
        where s.aae100 = '1'
        <if test="phd012 != null and phd012 !='' " >
            and substr(eys009, 0, 4)  = #{phd012,jdbcType=VARCHAR}
        </if>
        and eys012 = '5'
        and s.aab301 like
        substr(c.xzqhbm, 0, 2) || '%')

        where sn = 1

        ) 省外,

        (select count(1)
        from (select s.eys001,

        row_number() over(partition by s.eys002 order by eys009 desc) as sn
        from EMPLOYMENT_SITUATION s
        where s.aae100 = '1'
        <if test="phd012 != null and phd012 !='' " >
            and substr(eys009, 0, 4)  = #{phd012,jdbcType=VARCHAR}
        </if>
        and eys012 = '6'
        and s.aab301 like
        substr(c.xzqhbm, 0, 2) || '%')

        where sn = 1

        ) 国外,

        (select count(1)
        from (select s.eys001,

        row_number() over(partition by s.eys002 order by eys009 desc) as sn
        from EMPLOYMENT_SITUATION s
        where s.aae100 = '1'
        <if test="phd012 != null and phd012 !='' " >
            and substr(eys009, 0, 4)  = #{phd012,jdbcType=VARCHAR}
        </if>
        and eys007 = '001'
        and s.aab301 like
        substr(c.xzqhbm, 0, 2) || '%')

        where sn = 1

        ) 国企,
        (select count(1)
        from (select s.eys001,

        row_number() over(partition by s.eys002 order by eys009 desc) as sn
        from EMPLOYMENT_SITUATION s
        where s.aae100 = '1'
        <if test="phd012 != null and phd012 !='' " >
            and substr(eys009, 0, 4)  = #{phd012,jdbcType=VARCHAR}
        </if>
        and eys007 = '002'
        and s.aab301 like
        substr(c.xzqhbm, 0, 2) || '%')

        where sn = 1

        ) 民企,
        (select count(1)
        from (select s.eys001,

        row_number() over(partition by s.eys002 order by eys009 desc) as sn
        from EMPLOYMENT_SITUATION s
        where s.aae100 = '1'
        <if test="phd012 != null and phd012 !='' " >
            and substr(eys009, 0, 4)  = #{phd012,jdbcType=VARCHAR}
        </if>
        and eys007 = '003'
        and s.aab301 like
        substr(c.xzqhbm, 0, 2) || '%')

        where sn = 1

        ) 个体户,
        (select count(1)
        from (select s.eys001,

        row_number() over(partition by s.eys002 order by eys009 desc) as sn
        from EMPLOYMENT_SITUATION s
        where s.aae100 = '1'
        <if test="phd012 != null and phd012 !='' " >
            and substr(eys009, 0, 4)  = #{phd012,jdbcType=VARCHAR}
        </if>
        and eys007 = '004'
        and s.aab301 like
        substr(c.xzqhbm, 0, 2) || '%')

        where sn = 1

        ) 党政机关,
        (select count(1)
        from (select s.eys001,

        row_number() over(partition by s.eys002 order by eys009 desc) as sn
        from EMPLOYMENT_SITUATION s
        where s.aae100 = '1'
        <if test="phd012 != null and phd012 !='' " >
            and substr(eys009, 0, 4)  = #{phd012,jdbcType=VARCHAR}
        </if>
        and eys007 = '005'
        and s.aab301 like
        substr(c.xzqhbm, 0, 2) || '%')

        where sn = 1

        ) 事业单位,
        (select count(1)
        from (select s.eys001,

        row_number() over(partition by s.eys002 order by eys009 desc) as sn
        from EMPLOYMENT_SITUATION s
        where s.aae100 = '1'
        <if test="phd012 != null and phd012 !='' " >
            and substr(eys009, 0, 4)  = #{phd012,jdbcType=VARCHAR}
        </if>
        and eys007 = '006'
        and s.aab301 like
        substr(c.xzqhbm, 0, 2) || '%')

        where sn = 1

        ) 合作社,
        (select count(1)
        from (select s.eys001,

        row_number() over(partition by s.eys002 order by eys009 desc) as sn
        from EMPLOYMENT_SITUATION s
        where s.aae100 = '1'
        <if test="phd012 != null and phd012 !='' " >
            and substr(eys009, 0, 4)  = #{phd012,jdbcType=VARCHAR}
        </if>
        and eys011 is not null
        and s.aab301 like
        substr(c.xzqhbm, 0, 2) || '%')

        where sn = 1

        ) 合计,
        (select count(1)
        from (select s.eys001,

        row_number() over(partition by s.eys002 order by eys009 desc) as sn
        from EMPLOYMENT_SITUATION s
        where s.aae100 = '1'
        <if test="phd012 != null and phd012 !='' " >
            and substr(eys009, 0, 4)  = #{phd012,jdbcType=VARCHAR}
        </if>
        and eys011 = '1'
        and s.aab301 like
        substr(c.xzqhbm, 0, 2) || '%')

        where sn = 1

        ) 社区工厂,

        (select count(1)
        from (select s.eys001,

        row_number() over(partition by s.eys002 order by eys009 desc) as sn
        from EMPLOYMENT_SITUATION s
        where s.aae100 = '1'
        <if test="phd012 != null and phd012 !='' " >
            and substr(eys009, 0, 4)  = #{phd012,jdbcType=VARCHAR}
        </if>
        and eys011 = '2'
        and s.aab301 like
        substr(c.xzqhbm, 0, 2) || '%')

        where sn = 1

        ) 就业扶贫基地,

        (select count(1)
        from (select s.eys001,

        row_number() over(partition by s.eys002 order by eys009 desc) as sn
        from EMPLOYMENT_SITUATION s
        where s.aae100 = '1'
        <if test="phd012 != null and phd012 !='' " >
            and substr(eys009, 0, 4)  = #{phd012,jdbcType=VARCHAR}
        </if>
        and (eys011 = '5' or eys011 = '6' or
        eys011 = '7')
        and s.aab301 like
        substr(c.xzqhbm, 0, 2) || '%')

        where sn = 1

        ) 公岗小计,

        (select count(1)
        from (select s.eys001,

        row_number() over(partition by s.eys002 order by eys009 desc) as sn
        from EMPLOYMENT_SITUATION s
        where s.aae100 = '1'
        <if test="phd012 != null and phd012 !='' " >
            and substr(eys009, 0, 4)  = #{phd012,jdbcType=VARCHAR}
        </if>
        and eys011 = '6'
        and s.aab301 like
        substr(c.xzqhbm, 0, 2) || '%')

        where sn = 1

        ) 城镇公岗,

        (select count(1)
        from (select s.eys001,

        row_number() over(partition by s.eys002 order by eys009 desc) as sn
        from EMPLOYMENT_SITUATION s
        where s.aae100 = '1'
        <if test="phd012 != null and phd012 !='' " >
            and substr(eys009, 0, 4)  = #{phd012,jdbcType=VARCHAR}
        </if>
        and eys011 = '5'
        and s.aab301 like
        substr(c.xzqhbm, 0, 2) || '%')

        where sn = 1

        ) 公益专岗,

        (select count(1)
        from (select s.eys001,

        row_number() over(partition by s.eys002 order by eys009 desc) as sn
        from EMPLOYMENT_SITUATION s
        where s.aae100 = '1'
        <if test="phd012 != null and phd012 !='' " >
            and substr(eys009, 0, 4)  = #{phd012,jdbcType=VARCHAR}
        </if>
        and eys011 = '7'
        and s.aab301 like
        substr(c.xzqhbm, 0, 2) || '%')

        where sn = 1

        ) 特设公岗,

        (select count(1)
        from (select s.eys001,

        row_number() over(partition by s.eys002 order by eys009 desc) as sn
        from EMPLOYMENT_SITUATION s
        where s.aae100 = '1'
        <if test="phd012 != null and phd012 !='' " >
            and substr(eys009, 0, 4)  = #{phd012,jdbcType=VARCHAR}
        </if>
        and (eys011 = '3' or eys011 = '4')
        and s.aab301 like
        substr(c.xzqhbm, 0, 2) || '%')

        where sn = 1

        ) 苏陕协作,

        (select count(1)
        from (select s.eys001,

        row_number() over(partition by s.eys002 order by eys009 desc) as sn
        from EMPLOYMENT_SITUATION s
        where s.aae100 = '1'
        <if test="phd012 != null and phd012 !='' " >
            and substr(eys009, 0, 4)  = #{phd012,jdbcType=VARCHAR}
        </if>
        and eys011 = '3'
        and s.aab301 like
        substr(c.xzqhbm, 0, 2) || '%')

        where sn = 1

        ) 在苏就业,

        (select count(1)
        from (select s.eys001,

        row_number() over(partition by s.eys002 order by eys009 desc) as sn
        from EMPLOYMENT_SITUATION s
        where s.aae100 = '1'
        <if test="phd012 != null and phd012 !='' " >
            and substr(eys009, 0, 4)  = #{phd012,jdbcType=VARCHAR}
        </if>
        and eys011 = '4'
        and s.aab301 like
        substr(c.xzqhbm, 0, 2) || '%')

        where sn = 1

        ) 在陕就业,

        (select count(1)
        from (select s.eys001,

        row_number() over(partition by s.eys002 order by eys009 desc) as sn
        from poor_households      p,
        poor_labor_force     l,
        EMPLOYMENT_SITUATION s
        where p.phd001 = l.plf002
        and l.plf001 = s.eys002
        and phd013 = '1'
        and PLF011 = '2'
        and s.aae100 = '1'
        <if test="phd012 != null and phd012 !='' " >
            and substr(eys009, 0, 4)  = #{phd012,jdbcType=VARCHAR}
        </if>
        and eys011 = '4'
        and s.aab301 like
        substr(c.xzqhbm, 0, 2) || '%')

        where sn = 1

        ) 易地搬迁

        from poor_xzqh c
        where xzqhbm = #{aab301,jdbcType=VARCHAR})
        )
        order by sort


    </select>
    <select id="CooperationqueryAllByAab301Statistics" resultType="com.tdkj.model.PoorHouseholdTranslation">


        select xzqhmc AAB301,苏陕协作 pht001,在苏就业 pht002, 在陕就业 pht003, 协作培训 pht004 from (
        select xzqhmc ,sort,苏陕协作 ,在苏就业 , 在陕就业 , 协作培训  from (

        select c.xzqhmc,c.sort,  (


        select count(1)
        from (select s.eys001,

        row_number() over(partition by s.eys002 order by eys009 desc) as sn
        from EMPLOYMENT_SITUATION s
        where s.aae100 = '1'
        <if test="phd012 != null and phd012 !='' " >
            and substr(eys009, 0, 4)  = #{phd012,jdbcType=VARCHAR}
        </if>
        and (eys011 = '3' or eys011 = '4')
        and s.aab301 like
        substr(c.xzqhbm, 0, #{len1}) || '%')

        where sn = 1

        ) 苏陕协作 ,

        (select count(1)
        from (select s.eys001,

        row_number() over(partition by s.eys002 order by eys009 desc) as sn
        from EMPLOYMENT_SITUATION s
        where s.aae100 = '1'
        <if test="phd012 != null and phd012 !='' " >
            and substr(eys009, 0, 4)  = #{phd012,jdbcType=VARCHAR}
        </if>
        and eys011 = '3'
        and s.aab301 like
        substr(c.xzqhbm, 0, #{len1}) || '%')

        where sn = 1

        ) 在苏就业 ,

        (select count(1)
        from (select s.eys001,

        row_number() over(partition by s.eys002 order by eys009 desc) as sn
        from EMPLOYMENT_SITUATION s
        where s.aae100 = '1'
        <if test="phd012 != null and phd012 !='' " >
            and substr(eys009, 0, 4)  = #{phd012,jdbcType=VARCHAR}
        </if>
        and eys011 = '4'
        and s.aab301 like
        substr(c.xzqhbm, 0, #{len1}) || '%')

        where sn = 1

        ) 在陕就业 ,
        (select count(1)
        from (select s.tsn001 ,

        row_number() over(partition by s.tsn010  order by tsn007  desc) as sn
        from TRAINING_SITUATION s
        where s.aae100 = '1'
        <if test="phd012 != null and phd012 !='' " >
            and substr(tsn007 , 0, 4)  = #{phd012,jdbcType=VARCHAR}
        </if>
        and tsn012 = '1'
        and s.aab301 like
        substr(c.xzqhbm, 0, #{len1}) || '%')

        where sn = 1

        )协作培训

        from poor_xzqh c
        where fxzqhbm = #{aab301,jdbcType=VARCHAR}


        )union


        select xzqhmc ,sort,苏陕协作 ,在苏就业 , 在陕就业 , 协作培训  from (

        select c.xzqhmc,c.sort,  (select count(1)
        from (select s.eys001,

        row_number() over(partition by s.eys002 order by eys009 desc) as sn
        from EMPLOYMENT_SITUATION s
        where s.aae100 = '1'
        <if test="phd012 != null and phd012 !='' " >
            and substr(eys009, 0, 4)  = #{phd012,jdbcType=VARCHAR}
        </if>
        and (eys011 = '3' or eys011 = '4')
        and s.aab301 like
        substr(c.xzqhbm, 0, #{len2}) || '%')

        where sn = 1

        ) 苏陕协作 ,

        (select count(1)
        from (select s.eys001,

        row_number() over(partition by s.eys002 order by eys009 desc) as sn
        from EMPLOYMENT_SITUATION s
        where s.aae100 = '1'
        <if test="phd012 != null and phd012 !='' " >
            and substr(eys009, 0, 4)  = #{phd012,jdbcType=VARCHAR}
        </if>
        and eys011 = '3'
        and s.aab301 like
        substr(c.xzqhbm, 0, #{len2}) || '%')

        where sn = 1

        ) 在苏就业 ,

        (select count(1)
        from (select s.eys001,

        row_number() over(partition by s.eys002 order by eys009 desc) as sn
        from EMPLOYMENT_SITUATION s
        where s.aae100 = '1'
        <if test="phd012 != null and phd012 !='' " >
            and substr(eys009, 0, 4)  = #{phd012,jdbcType=VARCHAR}
        </if>
        and eys011 = '4'
        and s.aab301 like
        substr(c.xzqhbm, 0, #{len2}) || '%')

        where sn = 1

        ) 在陕就业 ,
        (select count(1)
        from (select s.tsn001 ,

        row_number() over(partition by s.tsn010  order by tsn007  desc) as sn
        from TRAINING_SITUATION s
        where s.aae100 = '1'
        <if test="phd012 != null and phd012 !='' " >
            and substr(tsn007 , 0, 4)  = #{phd012,jdbcType=VARCHAR}
        </if>
        and tsn012 = '1'
        and s.aab301 like
        substr(c.xzqhbm, 0, #{len2}) || '%')

        where sn = 1

        ) 协作培训


        from poor_xzqh c
        where xzqhbm = #{aab301,jdbcType=VARCHAR}

        )
        )
        order by sort


    </select>
    <select id="ComprehensivequeryAllByAab301Statistics" resultType="com.tdkj.model.PoorHouseholdTranslation">

        select xzqhmc AAB301,

        社区工厂               pht001,
        就业扶贫基地合计       pht002,
        就业扶贫基地国家级     pht003,
        就业扶贫基地省级       pht004,
        就业扶贫基地市级       pht005,
        就业扶贫基地县级       pht006,
        创业孵化基地合计       pht007,
        创业孵化基地国家级     pht008,
        创业孵化基地省级       pht009,
        创业孵化基地市级       pht010,
        创业孵化基地县级       pht011,
        返乡创业示范园区合计   pht012,
        返乡创业示范园区国家级 pht013,
        返乡创业示范园区省级   pht014,
        返乡创业示范园区市级   pht015,
        返乡创业示范园区县级   pht016,
        标准化创业中心合计     pht017,
        标准化创业中心国家级   pht018,
        标准化创业中心省级     pht019,
        标准化创业中心市级     pht020,
        标准化创业中心县级     pht021,
        信用乡村               pht022,
        劳务经纪人             pht023,
        贫困村创业致富带头人   pht024,
        返乡创业致富带头人     pht025,
        创业培训师资           pht026,
        公益性劳务输出站       pht027
        from (select xzqhmc ,
        sort,
        社区工厂,
        就业扶贫基地合计,
        就业扶贫基地国家级,
        就业扶贫基地省级,
        就业扶贫基地市级,
        就业扶贫基地县级,
        创业孵化基地合计,
        创业孵化基地国家级,
        创业孵化基地省级,
        创业孵化基地市级,
        创业孵化基地县级,
        返乡创业示范园区合计,
        返乡创业示范园区国家级,
        返乡创业示范园区省级,
        返乡创业示范园区市级,
        返乡创业示范园区县级,
        标准化创业中心合计,
        标准化创业中心国家级,
        标准化创业中心省级,
        标准化创业中心市级,
        标准化创业中心县级,
        信用乡村,
        劳务经纪人,
        贫困村创业致富带头人,
        返乡创业致富带头人,
        创业培训师资,
        公益性劳务输出站
        from (select c.xzqhmc,
        c.sort,
        (select count(1)
        from COMMUNITY_FACTORY s
        where s.aae100 = '1'
        <if test = "phd012 != null and phd012 !='' " >
            and substr(ctf005, 0, 4) = #{phd012,jdbcType = VARCHAR}
        </if>
        and s.aab301 like
        substr(c.xzqhbm, 0, #{len1}) || '%') 社区工厂,
        (select count(1)
        from POVERTY_ALLEVIATION_BASE s
        where s.aae100 = '1'
        <if test = "phd012 != null and phd012 !='' " >
            and substr(pab005, 0, 4) = #{phd012,jdbcType = VARCHAR}
        </if>
        and s.pab010 is not null
        and s.aab301 like
        substr(c.xzqhbm, 0, #{len1}) || '%') 就业扶贫基地合计,
        (select count(1)
        from POVERTY_ALLEVIATION_BASE s
        where s.aae100 = '1'
        <if test = "phd012 != null and phd012 !='' " >
            and substr(pab005, 0, 4) = #{phd012,jdbcType = VARCHAR}
        </if>
        and s.pab010 = '1'
        and s.aab301 like
        substr(c.xzqhbm, 0, #{len1}) || '%') 就业扶贫基地国家级,
        (select count(1)
        from POVERTY_ALLEVIATION_BASE s
        where s.aae100 = '1'
        <if test = "phd012 != null and phd012 !='' " >
            and substr(pab005, 0, 4) = #{phd012, jdbcType = VARCHAR}
        </if>
        and s.pab010 = '2'
        and s.aab301 like
        substr(c.xzqhbm, 0, #{len1}) || '%') 就业扶贫基地省级,
        (select count(1)
        from POVERTY_ALLEVIATION_BASE s
        where s.aae100 = '1'
        <if test = "phd012 != null and phd012 !='' " >
            and substr(pab005, 0, 4) = #{phd012, jdbcType = VARCHAR}
        </if>
        and s.pab010 = '3'
        and s.aab301 like
        substr(c.xzqhbm, 0, #{len1}) || '%') 就业扶贫基地市级,
        (select count(1)
        from POVERTY_ALLEVIATION_BASE s
        where s.aae100 = '1'
        <if test = "phd012 != null and phd012 !='' " >
            and substr(pab005, 0, 4) = #{phd012, jdbcType = VARCHAR}
        </if>
        and s.pab010 = '4'
        and s.aab301 like
        substr(c.xzqhbm, 0, #{len1}) || '%') 就业扶贫基地县级,
        (select count(1)
        from INCUBATOR_BASE s
        where s.aae100 = '1'
        <if test = "phd012 != null and phd012 !='' " >
            and substr(ibb008, 0, 4) = #{phd012, jdbcType = VARCHAR}
        </if>
        and s.ibb006 is not null
        and s.ibb005 = '1'
        and s.aab301 like
        substr(c.xzqhbm, 0, #{len1}) || '%') 创业孵化基地合计,
        (select count(1)
        from INCUBATOR_BASE s
        where s.aae100 = '1'
        <if test = "phd012 != null and phd012 !='' " >
            and substr(ibb008, 0, 4) = #{phd012,jdbcType = VARCHAR}
        </if>
        and s.ibb006 = '1'
        and s.ibb005 = '1'
        and s.aab301 like
        substr(c.xzqhbm, 0, #{len1}) || '%') 创业孵化基地国家级,
        (select count(1)
        from INCUBATOR_BASE s
        where s.aae100 = '1'
        <if test = "phd012 != null and phd012 !='' " >
            and substr(ibb008, 0, 4) = #{phd012,jdbcType = VARCHAR}
        </if>
        and s.ibb006 = '2'
        and s.ibb005 = '1'
        and s.aab301 like
        substr(c.xzqhbm, 0, #{len1}) || '%') 创业孵化基地省级,
        (select count(1)
        from INCUBATOR_BASE s
        where s.aae100 = '1'
        <if test = "phd012 != null and phd012 !='' " >
            and substr(ibb008, 0, 4) = #{phd012, jdbcType = VARCHAR}
        </if>
        and s.ibb006 = '3'
        and s.ibb005 = '1'
        and s.aab301 like
        substr(c.xzqhbm, 0, #{len1}) || '%') 创业孵化基地市级,
        (select count(1)
        from INCUBATOR_BASE s
        where s.aae100 = '1'
        <if test = "phd012 != null and phd012 !='' " >
            and substr(ibb008, 0, 4) = #{phd012,jdbcType = VARCHAR}
        </if>
        and s.ibb006 = '4'
        and s.ibb005 = '1'
        and s.aab301 like
        substr(c.xzqhbm, 0, #{len1}) || '%') 创业孵化基地县级,
        (select count(1)
        from INCUBATOR_BASE s
        where s.aae100 = '1'
        <if test = "phd012 != null and phd012 !='' " >
            and substr(ibb008, 0, 4) = #{phd012,jdbcType = VARCHAR}
        </if>
        and s.ibb006 is not null
        and s.ibb005 = '2'
        and s.aab301 like
        substr(c.xzqhbm, 0, #{len1}) || '%') 返乡创业示范园区合计,
        (select count(1)
        from INCUBATOR_BASE s
        where s.aae100 = '1'
        <if test = "phd012 != null and phd012 !='' " >
            and substr(ibb008, 0, 4) = #{phd012, jdbcType = VARCHAR}
        </if>
        and s.ibb006 = '1'
        and s.ibb005 = '2'
        and s.aab301 like
        substr(c.xzqhbm, 0, #{len1}) || '%') 返乡创业示范园区国家级,
        (select count(1)
        from INCUBATOR_BASE s
        where s.aae100 = '1'
        <if test = "phd012 != null and phd012 !='' " >
            and substr(ibb008, 0, 4) = #{phd012, jdbcType = VARCHAR}
        </if>
        and s.ibb006 = '2'
        and s.ibb005 = '2'
        and s.aab301 like
        substr(c.xzqhbm, 0, #{len1}) || '%') 返乡创业示范园区省级,
        (select count(1)
        from INCUBATOR_BASE s
        where s.aae100 = '1'
        <if test = "phd012 != null and phd012 !='' " >
            and substr(ibb008, 0, 4) = #{phd012, jdbcType = VARCHAR}
        </if>
        and s.ibb006 = '3'
        and s.ibb005 = '2'
        and s.aab301 like
        substr(c.xzqhbm, 0, #{len1}) || '%') 返乡创业示范园区市级,
        (select count(1)
        from INCUBATOR_BASE s
        where s.aae100 = '1'
        <if  test = "phd012 != null and phd012 !='' " >
            and substr(ibb008, 0, 4) = #{phd012,jdbcType = VARCHAR}
        </if>
        and s.ibb006 = '4'
        and s.ibb005 = '2'
        and s.aab301 like
        substr(c.xzqhbm, 0, #{len1}) || '%') 返乡创业示范园区县级,
        (select count(1)
        from INCUBATOR_BASE s
        where s.aae100 = '1'
        <if test = "phd012 != null and phd012 !='' " >
            and substr(ibb008, 0, 4) = #{phd012,jdbcType = VARCHAR}
        </if>
        and s.ibb006 is not null
        and s.ibb005 = '3'
        and s.aab301 like
        substr(c.xzqhbm, 0, #{len1}) || '%') 标准化创业中心合计,
        (select count(1)
        from INCUBATOR_BASE s
        where s.aae100 = '1'
        <if  test = "phd012 != null and phd012 !='' " >
            and substr(ibb008, 0, 4) = #{phd012, jdbcType = VARCHAR}
        </if>
        and s.ibb006 = '1'
        and s.ibb005 = '3'
        and s.aab301 like
        substr(c.xzqhbm, 0, #{len1}) || '%') 标准化创业中心国家级,
        (select count(1)
        from INCUBATOR_BASE s
        where s.aae100 = '1'
        <if test = "phd012 != null and phd012 !='' " >
            and substr(ibb008, 0, 4) = #{phd012, jdbcType = VARCHAR}
        </if>
        and s.ibb006 = '2'
        and s.ibb005 = '3'
        and s.aab301 like
        substr(c.xzqhbm, 0, #{len1}) || '%') 标准化创业中心省级,
        (select count(1)
        from INCUBATOR_BASE s
        where s.aae100 = '1'
        <if test = "phd012 != null and phd012 !='' " >
            and substr(ibb008, 0, 4) = #{phd012,jdbcType = VARCHAR}
        </if>
        and s.ibb006 = '3'
        and s.ibb005 = '3'
        and s.aab301 like
        substr(c.xzqhbm, 0, #{len1}) || '%') 标准化创业中心市级,
        (select count(1)
        from INCUBATOR_BASE s
        where s.aae100 = '1'
        <if  test = "phd012 != null and phd012 !='' " >
            and substr(ibb008, 0, 4) = #{phd012,jdbcType = VARCHAR}
        </if>
        and s.ibb006 = '4'
        and s.ibb005 = '3'
        and s.aab301 like
        substr(c.xzqhbm, 0, #{len1}) || '%') 标准化创业中心县级,
        (select count(1)
        from CREDIT_VILLAGE s
        where s.aae100 = '1'
        <if test = "phd012 != null and phd012 !='' " >
            and substr(cvg004, 0, 4) = #{phd012,jdbcType = VARCHAR}
        </if>
        and s.aab301 like
        substr(c.xzqhbm, 0, #{len1}) || '%') 信用乡村,
        (select count(1)
        from LABOR_BROKERING s
        where s.aae100 = '1'
        <if test = "phd012 != null and phd012 !='' " >
            and substr(lbk008, 0, 4) = #{phd012,jdbcType = VARCHAR}
        </if>
        and s.aab301 like
        substr(c.xzqhbm, 0, #{len1}) || '%') 劳务经纪人,
        (select count(1)
        from TAKE_THE_LEAD s
        where s.aae100 = '1'
        <if test = "phd012 != null and phd012 !='' " >
            and substr(thl012, 0, 4) = #{phd012,jdbcType = VARCHAR}
        </if>
        and thl002 = '2'
        and s.aab301 like
        substr(c.xzqhbm, 0, #{len1}) || '%') 贫困村创业致富带头人,
        (select count(1)
        from TAKE_THE_LEAD s
        where s.aae100 = '1'
        <if test = "phd012 != null and phd012 !='' " >
            and substr(thl012, 0, 4) = #{phd012,jdbcType = VARCHAR}
        </if>
        and thl002 = '1'
        and s.aab301 like
        substr(c.xzqhbm, 0, #{len1}) || '%') 返乡创业致富带头人,
        (select count(1)
        from ENTREPRENEURIAL_TEACHERS s
        where s.aae100 = '1'
        <if test = "phd012 != null and phd012 !='' " >
            and substr(ets007, 0, 4) = #{phd012,jdbcType = VARCHAR}
        </if>
        and s.aab301 like
        substr(c.xzqhbm, 0, #{len1}) || '%') 创业培训师资,
        (select count(1)
        from PUBLIC_SERVICE_WORKSTATION s
        where s.aae100 = '1'
        <if test = "phd012 != null and phd012 !='' " >
            and substr(to_char(aae036, 'yyyy-mm-dd'), 0, 4) = #{phd012, jdbcType = VARCHAR}
        </if>
        and s.aab301 like
        substr(c.xzqhbm, 0, #{len1}) || '%') 公益性劳务输出站
        from poor_xzqh c
        where fxzqhbm = #{aab301, jdbcType = VARCHAR})
        union

        select xzqhmc ,
        sort,
        社区工厂,
        就业扶贫基地合计,
        就业扶贫基地国家级,
        就业扶贫基地省级,
        就业扶贫基地市级,
        就业扶贫基地县级,
        创业孵化基地合计,
        创业孵化基地国家级,
        创业孵化基地省级,
        创业孵化基地市级,
        创业孵化基地县级,
        返乡创业示范园区合计,
        返乡创业示范园区国家级,
        返乡创业示范园区省级,
        返乡创业示范园区市级,
        返乡创业示范园区县级,
        标准化创业中心合计,
        标准化创业中心国家级,
        标准化创业中心省级,
        标准化创业中心市级,
        标准化创业中心县级,
        信用乡村,
        劳务经纪人,
        贫困村创业致富带头人,
        返乡创业致富带头人,
        创业培训师资,
        公益性劳务输出站
        from (select c.xzqhmc,
        c.sort,
        (select count(1)
        from COMMUNITY_FACTORY s
        where s.aae100 = '1'
        <if test = "phd012 != null and phd012 !='' " >
            and substr(ctf005, 0, 4) = #{phd012,jdbcType = VARCHAR}
        </if>
        and s.aab301 like
        substr(c.xzqhbm, 0, #{len2}) || '%') 社区工厂,
        (select count(1)
        from POVERTY_ALLEVIATION_BASE s
        where s.aae100 = '1'
        <if test = "phd012 != null and phd012 !='' " >
            and substr(pab005, 0, 4) = #{phd012,jdbcType = VARCHAR}
        </if>
        and s.pab010 is not null
        and s.aab301 like
        substr(c.xzqhbm, 0, #{len2}) || '%') 就业扶贫基地合计,
        (select count(1)
        from POVERTY_ALLEVIATION_BASE s
        where s.aae100 = '1'
        <if test = "phd012 != null and phd012 !='' " >
            and substr(pab005, 0, 4) = #{phd012,jdbcType = VARCHAR}
        </if>
        and s.pab010 = '1'
        and s.aab301 like
        substr(c.xzqhbm, 0, #{len2}) || '%') 就业扶贫基地国家级,
        (select count(1)
        from POVERTY_ALLEVIATION_BASE s
        where s.aae100 = '1'
        <if test = "phd012 != null and phd012 !='' " >
            and substr(pab005, 0, 4) = #{phd012, jdbcType = VARCHAR}
        </if>
        and s.pab010 = '2'
        and s.aab301 like
        substr(c.xzqhbm, 0, #{len2}) || '%') 就业扶贫基地省级,
        (select count(1)
        from POVERTY_ALLEVIATION_BASE s
        where s.aae100 = '1'
        <if test = "phd012 != null and phd012 !='' " >
            and substr(pab005, 0, 4) = #{phd012, jdbcType = VARCHAR}
        </if>
        and s.pab010 = '3'
        and s.aab301 like
        substr(c.xzqhbm, 0, #{len2}) || '%') 就业扶贫基地市级,
        (select count(1)
        from POVERTY_ALLEVIATION_BASE s
        where s.aae100 = '1'
        <if test = "phd012 != null and phd012 !='' " >
            and substr(pab005, 0, 4) = #{phd012, jdbcType = VARCHAR}
        </if>
        and s.pab010 = '4'
        and s.aab301 like
        substr(c.xzqhbm, 0, #{len2}) || '%') 就业扶贫基地县级,
        (select count(1)
        from INCUBATOR_BASE s
        where s.aae100 = '1'
        <if test = "phd012 != null and phd012 !='' " >
            and substr(ibb008, 0, 4) = #{phd012, jdbcType = VARCHAR}
        </if>
        and s.ibb006 is not null
        and s.ibb005 = '1'
        and s.aab301 like
        substr(c.xzqhbm, 0, #{len2}) || '%') 创业孵化基地合计,
        (select count(1)
        from INCUBATOR_BASE s
        where s.aae100 = '1'
        <if test = "phd012 != null and phd012 !='' " >
            and substr(ibb008, 0, 4) = #{phd012,jdbcType = VARCHAR}
        </if>
        and s.ibb006 = '1'
        and s.ibb005 = '1'
        and s.aab301 like
        substr(c.xzqhbm, 0, #{len2}) || '%') 创业孵化基地国家级,
        (select count(1)
        from INCUBATOR_BASE s
        where s.aae100 = '1'
        <if test = "phd012 != null and phd012 !='' " >
            and substr(ibb008, 0, 4) = #{phd012,jdbcType = VARCHAR}
        </if>
        and s.ibb006 = '2'
        and s.ibb005 = '1'
        and s.aab301 like
        substr(c.xzqhbm, 0, #{len2}) || '%') 创业孵化基地省级,
        (select count(1)
        from INCUBATOR_BASE s
        where s.aae100 = '1'
        <if test = "phd012 != null and phd012 !='' " >
            and substr(ibb008, 0, 4) = #{phd012, jdbcType = VARCHAR}
        </if>
        and s.ibb006 = '3'
        and s.ibb005 = '1'
        and s.aab301 like
        substr(c.xzqhbm, 0, #{len2}) || '%') 创业孵化基地市级,
        (select count(1)
        from INCUBATOR_BASE s
        where s.aae100 = '1'
        <if test = "phd012 != null and phd012 !='' " >
            and substr(ibb008, 0, 4) = #{phd012,jdbcType = VARCHAR}
        </if>
        and s.ibb006 = '4'
        and s.ibb005 = '1'
        and s.aab301 like
        substr(c.xzqhbm, 0, #{len2}) || '%') 创业孵化基地县级,
        (select count(1)
        from INCUBATOR_BASE s
        where s.aae100 = '1'
        <if test = "phd012 != null and phd012 !='' " >
            and substr(ibb008, 0, 4) = #{phd012,jdbcType = VARCHAR}
        </if>
        and s.ibb006 is not null
        and s.ibb005 = '2'
        and s.aab301 like
        substr(c.xzqhbm, 0, #{len2}) || '%') 返乡创业示范园区合计,
        (select count(1)
        from INCUBATOR_BASE s
        where s.aae100 = '1'
        <if test = "phd012 != null and phd012 !='' " >
            and substr(ibb008, 0, 4) = #{phd012, jdbcType = VARCHAR}
        </if>
        and s.ibb006 = '1'
        and s.ibb005 = '2'
        and s.aab301 like
        substr(c.xzqhbm, 0, #{len2}) || '%') 返乡创业示范园区国家级,
        (select count(1)
        from INCUBATOR_BASE s
        where s.aae100 = '1'
        <if test = "phd012 != null and phd012 !='' " >
            and substr(ibb008, 0, 4) = #{phd012, jdbcType = VARCHAR}
        </if>
        and s.ibb006 = '2'
        and s.ibb005 = '2'
        and s.aab301 like
        substr(c.xzqhbm, 0, #{len2}) || '%') 返乡创业示范园区省级,
        (select count(1)
        from INCUBATOR_BASE s
        where s.aae100 = '1'
        <if test = "phd012 != null and phd012 !='' " >
            and substr(ibb008, 0, 4) = #{phd012, jdbcType = VARCHAR}
        </if>
        and s.ibb006 = '3'
        and s.ibb005 = '2'
        and s.aab301 like
        substr(c.xzqhbm, 0, #{len2}) || '%') 返乡创业示范园区市级,
        (select count(1)
        from INCUBATOR_BASE s
        where s.aae100 = '1'
        <if  test = "phd012 != null and phd012 !='' " >
            and substr(ibb008, 0, 4) = #{phd012,jdbcType = VARCHAR}
        </if>
        and s.ibb006 = '4'
        and s.ibb005 = '2'
        and s.aab301 like
        substr(c.xzqhbm, 0, #{len2}) || '%') 返乡创业示范园区县级,
        (select count(1)
        from INCUBATOR_BASE s
        where s.aae100 = '1'
        <if test = "phd012 != null and phd012 !='' " >
            and substr(ibb008, 0, 4) = #{phd012,jdbcType = VARCHAR}
        </if>
        and s.ibb006 is not null
        and s.ibb005 = '3'
        and s.aab301 like
        substr(c.xzqhbm, 0, #{len2}) || '%') 标准化创业中心合计,
        (select count(1)
        from INCUBATOR_BASE s
        where s.aae100 = '1'
        <if  test = "phd012 != null and phd012 !='' " >
            and substr(ibb008, 0, 4) = #{phd012, jdbcType = VARCHAR}
        </if>
        and s.ibb006 = '1'
        and s.ibb005 = '3'
        and s.aab301 like
        substr(c.xzqhbm, 0, #{len2}) || '%') 标准化创业中心国家级,
        (select count(1)
        from INCUBATOR_BASE s
        where s.aae100 = '1'
        <if test = "phd012 != null and phd012 !='' " >
            and substr(ibb008, 0, 4) = #{phd012, jdbcType = VARCHAR}
        </if>
        and s.ibb006 = '2'
        and s.ibb005 = '3'
        and s.aab301 like
        substr(c.xzqhbm, 0, #{len2}) || '%') 标准化创业中心省级,
        (select count(1)
        from INCUBATOR_BASE s
        where s.aae100 = '1'
        <if test = "phd012 != null and phd012 !='' " >
            and substr(ibb008, 0, 4) = #{phd012,jdbcType = VARCHAR}
        </if>
        and s.ibb006 = '3'
        and s.ibb005 = '3'
        and s.aab301 like
        substr(c.xzqhbm, 0, #{len2}) || '%') 标准化创业中心市级,
        (select count(1)
        from INCUBATOR_BASE s
        where s.aae100 = '1'
        <if  test = "phd012 != null and phd012 !='' " >
            and substr(ibb008, 0, 4) = #{phd012,jdbcType = VARCHAR}
        </if>
        and s.ibb006 = '4'
        and s.ibb005 = '3'
        and s.aab301 like
        substr(c.xzqhbm, 0, #{len2}) || '%') 标准化创业中心县级,
        (select count(1)
        from CREDIT_VILLAGE s
        where s.aae100 = '1'
        <if test = "phd012 != null and phd012 !='' " >
            and substr(cvg004, 0, 4) = #{phd012,jdbcType = VARCHAR}
        </if>
        and s.aab301 like
        substr(c.xzqhbm, 0, #{len2}) || '%') 信用乡村,
        (select count(1)
        from LABOR_BROKERING s
        where s.aae100 = '1'
        <if test = "phd012 != null and phd012 !='' " >
            and substr(lbk008, 0, 4) = #{phd012,jdbcType = VARCHAR}
        </if>
        and s.aab301 like
        substr(c.xzqhbm, 0, #{len2}) || '%') 劳务经纪人,
        (select count(1)
        from TAKE_THE_LEAD s
        where s.aae100 = '1'
        <if test = "phd012 != null and phd012 !='' " >
            and substr(thl012, 0, 4) = #{phd012,jdbcType = VARCHAR}
        </if>
        and thl002 = '2'
        and s.aab301 like
        substr(c.xzqhbm, 0, #{len2}) || '%') 贫困村创业致富带头人,
        (select count(1)
        from TAKE_THE_LEAD s
        where s.aae100 = '1'
        <if test = "phd012 != null and phd012 !='' " >
            and substr(thl012, 0, 4) = #{phd012,jdbcType = VARCHAR}
        </if>
        and thl002 = '1'
        and s.aab301 like
        substr(c.xzqhbm, 0, #{len2}) || '%') 返乡创业致富带头人,
        (select count(1)
        from ENTREPRENEURIAL_TEACHERS s
        where s.aae100 = '1'
        <if test = "phd012 != null and phd012 !='' " >
            and substr(ets007, 0, 4) = #{phd012,jdbcType = VARCHAR}
        </if>
        and s.aab301 like
        substr(c.xzqhbm, 0, #{len2}) || '%') 创业培训师资,
        (select count(1)
        from PUBLIC_SERVICE_WORKSTATION s
        where s.aae100 = '1'
        <if test = "phd012 != null and phd012 !='' " >
            and substr(to_char(aae036, 'yyyy-mm-dd'), 0, 4) = #{phd012, jdbcType = VARCHAR}
        </if>
        and s.aab301 like
        substr(c.xzqhbm, 0, #{len2}) || '%') 公益性劳务输出站
        from poor_xzqh c
        where xzqhbm = #{aab301, jdbcType = VARCHAR}))
        order by sort


    </select>



    <!--查询综合信息 information 里面的信息-->
    <select id="queryInformationByAab301" resultMap="BaseResultMap" parameterType="java.lang.String" >
        select xzqhmc aab301,
        (select count(1)
        from TAKE_THE_LEAD p,
        RECURSION r
        where p.aab301 = r.aab301
        and r.parentid = xzqhbm) chuangyedaitouren,
        (select count(1)
        from LABOR_BROKERING p,
        RECURSION r
        where p.aab301 = r.aab301
        and r.parentid = xzqhbm) laowujingjiren,
        (select count(1)
        from ENTREPRENEURIAL_TEACHERS p,
        RECURSION r
        where p.aab301 = r.aab301
        and r.parentid = xzqhbm) chuangyeshizililiang,
        (select count(1)
        from LABOR_EXPORT_AGENCY p,
        RECURSION r
        where p.aab301 = r.aab301
        and r.parentid = xzqhbm) paizhushurudilaowugongzuozhan,
        (select count(1)
        from LABOR_ALLEVIATION_COMPANY p,
        RECURSION r
        where p.aab301 = r.aab301
        and r.parentid = xzqhbm) laowufuwujigou,
        (select count(1)
        from EX_SITU_POVERTY p,
        RECURSION r
        where p.aab301 = r.aab301
        and r.parentid = xzqhbm) yidifupinjiuyefuwuzhan
        from poor_xzqh
        where fxzqhbm = #{poorXzqh.aab301, jdbcType = VARCHAR} order by XZQHBM

    </select>





</mapper>