<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.tdkj.dao.PovertyAlleviationBase.PovertyAlleviationBaseMapper" >
  <resultMap id="BaseResultMap" type="com.tdkj.model.PovertyAlleviationBase" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    <id column="PAB001" property="pab001" jdbcType="VARCHAR" />
    <result column="AAB301" property="aab301" jdbcType="VARCHAR" />
    <result column="PAB003" property="pab003" jdbcType="VARCHAR" />
    <result column="PAB004" property="pab004" jdbcType="VARCHAR" />
    <result column="PAB007" property="pab007" jdbcType="DECIMAL" />
    <result column="PAB008" property="pab008" jdbcType="DECIMAL" />
    <result column="PAB009" property="pab009" jdbcType="VARCHAR" />
    <result column="PAB010" property="pab010" jdbcType="VARCHAR" />
    <result column="PAB006" property="pab006" jdbcType="VARCHAR" />
    <result column="PAB005" property="pab005" jdbcType="VARCHAR" />
    <result column="PAB015" property="pab015" jdbcType="VARCHAR" />
    <result column="PAB016" property="pab016" jdbcType="VARCHAR" />
    <result column="PAB017" property="pab017" jdbcType="VARCHAR" />
    <result column="PAB018" property="pab018" jdbcType="VARCHAR" />
    <result column="PAB019" property="pab019" jdbcType="VARCHAR" />
    <result column="PAB020" property="pab020" jdbcType="VARCHAR" />
    <result column="AAE036" property="aae036" jdbcType="TIMESTAMP" />
    <result column="AAE011" property="aae011" jdbcType="VARCHAR" />
    <result column="DATASOURCE" property="datasource" jdbcType="VARCHAR" />
    <result column="AAE100" property="aae100" jdbcType="VARCHAR" />
    <result column="UPDATEDATE" property="updatedate" jdbcType="TIMESTAMP" />
    <result column="UPDATEBY" property="updateby" jdbcType="VARCHAR" />
    <result column="CREATEBY" property="createby" jdbcType="VARCHAR" />
    <result column="AAE012" property="aae012" jdbcType="VARCHAR" />
    <result column="PAB011" property="pab011" jdbcType="NUMERIC" />
    <result column="PAB012" property="pab012" jdbcType="NUMERIC" />
    <result column="PAB013" property="pab013" jdbcType="VARCHAR" />
    <result column="PAB014" property="pab014" jdbcType="VARCHAR" />
    <result column="DELETEBY" property="deleteby" jdbcType="VARCHAR" />
    <result column="DELETEDATE" property="deletedate" jdbcType="TIMESTAMP" />
  </resultMap>
  <sql id="Base_Column_List" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    PAB001, AAB301, PAB003, PAB004, PAB007, PAB008, PAB009, PAB010, PAB006, PAB005, PAB015, PAB016,PAB017,PAB018,PAB019,PAB020,AAE036,
    AAE011,DATASOURCE,AAE100,UPDATEDATE,UPDATEBY,CREATEBY,AAE012,PAB011,PAB012,PAB013,PAB014,DELETEBY,DELETEDATE
  </sql>
  <select id="selectByPrimaryKey" resultMap="BaseResultMap" parameterType="java.lang.String" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    select 
    <include refid="Base_Column_List" />
    from poverty_alleviation_base
    where PAB001 = #{pab001,jdbcType=VARCHAR}
  </select>
  <!--<delete id="deleteByPrimaryKey" parameterType="java.lang.String" >
    &lt;!&ndash;
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    &ndash;&gt;
    delete from poverty_alleviation_base
    where PAB001 = #{pab001,jdbcType=VARCHAR}
  </delete>-->

  <update id="deleteByPrimaryKey" parameterType="java.lang.String" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    update  poverty_alleviation_base set aae100='0'
    where PAB001 = #{pab001,jdbcType=VARCHAR}
  </update>

  <insert id="insert" parameterType="com.tdkj.model.PovertyAlleviationBase" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    insert into poverty_alleviation_base (PAB001, AAB301, PAB003, 
      PAB004, PAB007, PAB008, 
      PAB009, PAB010, PAB006, 
      PAB005, PAB015,PAB016,PAB017,PAB018,PAB019,PAB020,
    AAE036, AAE011,DATASOURCE,AAE100,UPDATEDATE,UPDATEBY,CREATEBY,AAE012,PAB011,PAB012,PAB013,PAB014,DELETEBY,DELETEDATE
      )
    values (#{pab001,jdbcType=VARCHAR}, #{aab301,jdbcType=VARCHAR}, #{pab003,jdbcType=VARCHAR}, 
      #{pab004,jdbcType=VARCHAR}, #{pab007,jdbcType=DECIMAL}, #{pab008,jdbcType=DECIMAL}, 
      #{pab009,jdbcType=VARCHAR}, #{pab010,jdbcType=VARCHAR}, #{pab006,jdbcType=VARCHAR}, 
      #{pab005,jdbcType=VARCHAR},#{pab015,jdbcType=VARCHAR}, #{pab016,jdbcType=VARCHAR},
    #{pab017,jdbcType=VARCHAR},#{pab018,jdbcType=VARCHAR},#{pab019,jdbcType=VARCHAR},#{pab020,jdbcType=VARCHAR},#{aae036,jdbcType=TIMESTAMP}, #{aae011,jdbcType=VARCHAR},
      #{datasource,jdbcType=VARCHAR},#{aae100,jdbcType=VARCHAR},#{updatedate,jdbcType=TIMESTAMP},#{updateby,jdbcType=VARCHAR},
      #{createby,jdbcType=VARCHAR},#{aae012,jdbcType=VARCHAR},#{pab011,jdbcType=NUMERIC},#{pab012,jdbcType=NUMERIC},#{pab013,jdbcType=VARCHAR},#{pab014,jdbcType=VARCHAR},
      #{deleteby,jdbcType=VARCHAR},#{deletedate,jdbcType=TIMESTAMP}
      )
  </insert>
  <insert id="insertSelective" parameterType="com.tdkj.model.PovertyAlleviationBase" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    insert into poverty_alleviation_base
    <trim prefix="(" suffix=")" suffixOverrides="," >
      <if test="pab001 != null" >
        PAB001,
      </if>
      <if test="aab301 != null" >
        AAB301,
      </if>
      <if test="pab003 != null" >
        PAB003,
      </if>
      <if test="pab004 != null" >
        PAB004,
      </if>
      <if test="pab007 != null" >
        PAB007,
      </if>
      <if test="pab008 != null" >
        PAB008,
      </if>
      <if test="pab009 != null" >
        PAB009,
      </if>
      <if test="pab010 != null" >
        PAB010,
      </if>
      <if test="pab006 != null" >
        PAB006,
      </if>
      <if test="pab005 != null" >
        PAB005,
      </if>
      <if test="pab015 != null" >
        PAB015,
      </if>
      <if test="aae036 != null" >
        AAE036,
      </if>
      <if test="aae011 != null" >
        AAE011,
      </if>
      <if test="datasource != null" >
        DATASOURCE,
      </if>
      <if test="aae100 != null" >
        AAE100,
      </if>
      <if test="updatedate != null" >
        UPDATEDATE,
      </if>
      <if test="updateby != null" >
        UPDATEBY,
      </if>
      <if test="createby != null" >
        CREATEBY,
      </if>
      <if test="aae012 != null" >
        AAE012,
      </if>
      <if test="pab011 != null" >
        PAB011,
      </if>
      <if test="pab012 != null" >
        PAB012,
      </if>
      <if test="pab013 != null" >
        PAB013,
      </if>
      <if test="pab014 != null" >
        PAB014,
      </if>
      <if test="pab016 != null" >
        PAB016,
      </if>
      <if test="pab017 != null" >
        PAB017,
      </if>
      <if test="pab018 != null" >
        PAB018,
      </if>
      <if test="pab019 != null" >
        PAB019,
      </if>
      <if test="pab020 != null" >
        PAB020,
      </if>
      <if test="deleteby != null" >
        DELETEBY,
      </if>
      <if test="deletedate != null" >
        DELETEDATE,
      </if>
    </trim>
    <trim prefix="values (" suffix=")" suffixOverrides="," >
      <if test="pab001 != null" >
        #{pab001,jdbcType=VARCHAR},
      </if>
      <if test="aab301 != null" >
        #{aab301,jdbcType=VARCHAR},
      </if>
      <if test="pab003 != null" >
        #{pab003,jdbcType=VARCHAR},
      </if>
      <if test="pab004 != null" >
        #{pab004,jdbcType=VARCHAR},
      </if>
      <if test="pab007 != null" >
        #{pab007,jdbcType=DECIMAL},
      </if>
      <if test="pab008 != null" >
        #{pab008,jdbcType=DECIMAL},
      </if>
      <if test="pab009 != null" >
        #{pab009,jdbcType=VARCHAR},
      </if>
      <if test="pab010 != null" >
        #{pab010,jdbcType=VARCHAR},
      </if>
      <if test="pab006 != null" >
        #{pab006,jdbcType=VARCHAR},
      </if>
      <if test="pab005 != null" >
        #{pab005,jdbcType=VARCHAR},
      </if>
      <if test="pab015 != null" >
        #{pab015,jdbcType=VARCHAR},
      </if>
      <if test="aae036 != null" >
        #{aae036,jdbcType=TIMESTAMP},
      </if>
      <if test="aae011 != null" >
        #{aae011,jdbcType=VARCHAR},
      </if>
      <if test="datasource != null" >
        #{datasource,jdbcType=VARCHAR},
      </if>
      <if test="aae100 != null" >
        #{aae100,jdbcType=VARCHAR},
      </if>
      <if test="updatedate != null" >
        #{updatedate,jdbcType=TIMESTAMP},
      </if>
      <if test="updateby != null" >
        #{updateby,jdbcType=VARCHAR},
      </if>
      <if test="createby != null" >
        #{createby,jdbcType=VARCHAR},
      </if>
      <if test="aae012 != null" >
        #{aae012,jdbcType=VARCHAR},
      </if>
      <if test="pab011 != null" >
        #{pab011,jdbcType=NUMERIC},
      </if>
      <if test="pab012 != null" >
        #{pab012,jdbcType=NUMERIC},
      </if>
      <if test="pab013 != null" >
        #{pab013,jdbcType=VARCHAR},
      </if>
      <if test="pab014 != null" >
        #{pab014,jdbcType=VARCHAR},
      </if>
      <if test="pab016 != null" >
        #{pab016,jdbcType=VARCHAR},
      </if>
      <if test="pab017 != null" >
        #{pab017,jdbcType=VARCHAR},
      </if>
      <if test="pab018 != null" >
        #{pab018,jdbcType=VARCHAR},
      </if>
      <if test="pab019 != null" >
        #{pab019,jdbcType=VARCHAR},
      </if>
      <if test="pab020 != null" >
        #{pab020,jdbcType=VARCHAR},
      </if>
      <if test="deleteby != null" >
        #{deleteby,jdbcType=VARCHAR},
      </if>
      <if test="deletedate != null" >
        #{deletedate,jdbcType=TIMESTAMP},
      </if>
    </trim>
  </insert>
  <update id="updateByPrimaryKeySelective" parameterType="com.tdkj.model.PovertyAlleviationBase" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    update poverty_alleviation_base
    <set >
      <if test="aab301 != null" >
        AAB301 = #{aab301,jdbcType=VARCHAR},
      </if>
      <if test="pab003 != null" >
        PAB003 = #{pab003,jdbcType=VARCHAR},
      </if>
      <if test="pab004 != null" >
        PAB004 = #{pab004,jdbcType=VARCHAR},
      </if>
      <if test="pab007 != null" >
        PAB007 = #{pab007,jdbcType=DECIMAL},
      </if>
      <if test="pab008 != null" >
        PAB008 = #{pab008,jdbcType=DECIMAL},
      </if>
      <if test="pab009 != null" >
        PAB009 = #{pab009,jdbcType=VARCHAR},
      </if>
      <if test="pab010 != null" >
        PAB010 = #{pab010,jdbcType=VARCHAR},
      </if>
      <if test="pab006 != null" >
        PAB006 = #{pab006,jdbcType=VARCHAR},
      </if>
      <if test="pab005 != null" >
        PAB005 = #{pab005,jdbcType=VARCHAR},
      </if>
      <if test="pab015 != null" >
        PAB015 = #{pab015,jdbcType=VARCHAR},
      </if>
      <if test="aae036 != null" >
        AAE036 = #{aae036,jdbcType=TIMESTAMP},
      </if>
      <if test="aae011 != null" >
        AAE011 = #{aae011,jdbcType=VARCHAR},
      </if>
      <if test="datasource != null" >
        DATASOURCE = #{datasource,jdbcType=VARCHAR},
      </if>
      <if test="aae100 != null" >
        AAE100 = #{aae100,jdbcType=VARCHAR},
      </if>
      <if test="updatedate != null" >
        UPDATEDATE = #{updatedate,jdbcType=TIMESTAMP},
      </if>
      <if test="updateby != null" >
        UPDATEBY = #{updateby,jdbcType=VARCHAR},
      </if>
      <if test="createby != null" >
        CREATEBY = #{createby,jdbcType=VARCHAR},
      </if>
      <if test="aae012 != null" >
        AAE012 = #{aae012,jdbcType=VARCHAR},
      </if>
      <if test="pab011 != null" >
        PAB011 = #{pab011,jdbcType=NUMERIC},
      </if>
      <if test="pab012 != null" >
        PAB012 = #{pab012,jdbcType=NUMERIC},
      </if>
      <if test="pab013 != null" >
        PAB013 = #{pab013,jdbcType=VARCHAR},
      </if>
      <if test="pab014 != null" >
        PAB014 = #{pab014,jdbcType=VARCHAR},
      </if>
      <if test="pab016 != null" >
        PAB016 = #{pab016,jdbcType=VARCHAR},
      </if>
      <if test="pab017 != null" >
        PAB017 = #{pab017,jdbcType=VARCHAR},
      </if>
      <if test="pab018 != null" >
        PAB018 = #{pab018,jdbcType=VARCHAR},
      </if>
      <if test="pab019 != null" >
        PAB019 = #{pab019,jdbcType=VARCHAR},
      </if>
      <if test="pab020 != null" >
        PAB020 = #{pab020,jdbcType=VARCHAR},
      </if>
      <if test="deleteby != null" >
        DELETEBY = #{deleteby,jdbcType=VARCHAR},
      </if>
      <if test="deletedate != null" >
        DELETEDATE = #{deletedate,jdbcType=TIMESTAMP},
      </if>
    </set>
    where PAB001 = #{pab001,jdbcType=VARCHAR}
  </update>
  <update id="updateByPrimaryKey" parameterType="com.tdkj.model.PovertyAlleviationBase" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    update poverty_alleviation_base
    set AAB301 = #{aab301,jdbcType=VARCHAR},
      PAB003 = #{pab003,jdbcType=VARCHAR},
      PAB004 = #{pab004,jdbcType=VARCHAR},
      PAB007 = #{pab007,jdbcType=DECIMAL},
      PAB008 = #{pab008,jdbcType=DECIMAL},
      PAB009 = #{pab009,jdbcType=VARCHAR},
      PAB010 = #{pab010,jdbcType=VARCHAR},
      PAB011 = #{pab011,jdbcType=NUMERIC},
      PAB012 = #{pab012,jdbcType=NUMERIC},
      PAB013 = #{pab013,jdbcType=VARCHAR},
      PAB014 = #{pab014,jdbcType=VARCHAR},
      PAB006 = #{pab006,jdbcType=VARCHAR},
      PAB005 = #{pab005,jdbcType=VARCHAR},
    PAB015 = #{pab015,jdbcType=VARCHAR},
    PAB016 = #{pab016,jdbcType=VARCHAR},
    PAB017 = #{pab017,jdbcType=VARCHAR},
    PAB018 = #{pab018,jdbcType=VARCHAR},
    PAB019 = #{pab019,jdbcType=VARCHAR},
    PAB020 = #{pab020,jdbcType=VARCHAR},
      AAE036 = #{aae036,jdbcType=TIMESTAMP},
      AAE011 = #{aae011,jdbcType=VARCHAR},
    DATASOURCE = #{datasource,jdbcType=VARCHAR},
    AAE100 = #{aae100,jdbcType=VARCHAR},
    UPDATEDATE = #{updatedate,jdbcType=TIMESTAMP},
    UPDATEBY = #{updateby,jdbcType=VARCHAR},
    CREATEBY = #{createby,jdbcType=VARCHAR},
    AAE012 = #{aae012,jdbcType=VARCHAR},
    DELETEBY = #{deleteby,jdbcType=VARCHAR},
    DELETEDATE = #{deletedate,jdbcType=TIMESTAMP}
    where PAB001 = #{pab001,jdbcType=VARCHAR}
  </update>


  <!--根据行政区划查询扶贫基地信息  待完善-->
  <select id="queryPovertyAlleviationBaseByAab301" resultMap="BaseResultMap" parameterType="java.lang.String" >
    select PAB001, AAB301, PAB003, PAB004, PAB007, PAB008, PAB009, PAB010, PAB006, PAB005,PAB015, AAE036,
    AAE011,DATASOURCE,AAE100,UPDATEDATE,UPDATEBY,CREATEBY,AAE012,PAB011,PAB012,PAB013,PAB014,PAB016,PAB017,PAB018,PAB019,PAB020,rn
    from (select PAB001, AAB301, PAB003, PAB004, PAB007, PAB008, PAB009, PAB010, PAB006, PAB005,PAB015, AAE036,
    AAE011,DATASOURCE,AAE100,UPDATEDATE,UPDATEBY,CREATEBY,AAE012,PAB011,PAB012,PAB013,PAB014,PAB016,PAB017,PAB018,PAB019,PAB020, rownum rn
    from ( select PAB001,
    t.INFO AAB301, PAB003, PAB004, PAB007, PAB008, PAB009,
    f_getcodename('AAA009', PAB010)PAB010,
    PAB006, PAB005,PAB015, AAE036,
    AAE011,DATASOURCE,AAE100,UPDATEDATE,UPDATEBY,CREATEBY,AAE012,PAB011,PAB012,
    (select cts002 from centralized_settlements where cts001=PAB013)PAB013,
    f_getcodename('EDC441', PAB014)PAB014,f_getcodename('EDC441', PAB016)PAB016,PAB017,PAB018,PAB019,PAB020
    from poverty_alleviation_base,POOR_XZQH t
    where AAB301=t.XZQHBM and AAE100='1'
    <if test="povertyAlleviationBase.taizhang != null and povertyAlleviationBase.taizhang !='' " >
      and (select count(r.companyid) from relation r,poor_labor_force p where r.peopleid=p.plf001 and  r.aae100 = '1'and p.aae100='1'
      and PAB001 =r.companyid)>=1
      and pab006 is null
    </if>
    /*待完善条件 */
    <if test="povertyAlleviationBase.istobecomplete != null  and povertyAlleviationBase.istobecomplete !='' ">
      and (PAB005 is null or PAB014 is null or (PAB014 ='1' and PAB013 is null))
    </if>
    <if test="povertyAlleviationBase.aab301 != null and povertyAlleviationBase.aab301 !='' " >
      and AAB301 like #{povertyAlleviationBase.aab301,jdbcType=VARCHAR}
    </if>
    <if test="povertyAlleviationBase.pab003 != null and povertyAlleviationBase.pab003 !='' " >
      and PAB003 like #{povertyAlleviationBase.pab003,jdbcType=VARCHAR}
    </if>
    <if test="povertyAlleviationBase.pab004 != null and povertyAlleviationBase.pab004 !='' " >
      and PAB004 = #{povertyAlleviationBase.pab004,jdbcType=VARCHAR}
    </if>
    <if test="povertyAlleviationBase.pab007 != null and povertyAlleviationBase.pab007 !='' " >
      and PAB007 = #{povertyAlleviationBase.pab007,jdbcType=DECIMAL}
    </if>
    <if test="povertyAlleviationBase.pab008 != null and povertyAlleviationBase.pab008 !='' " >
      and  PAB008 = #{povertyAlleviationBase.pab008,jdbcType=DECIMAL}
    </if>
    <if test="povertyAlleviationBase.pab009 != null and povertyAlleviationBase.pab009 !='' " >
      and PAB009 = #{povertyAlleviationBase.pab009,jdbcType=VARCHAR}
    </if>
    <if test="povertyAlleviationBase.pab010 != null and povertyAlleviationBase.pab010 !='' " >
      and PAB010 = #{povertyAlleviationBase.pab010,jdbcType=VARCHAR}
    </if>
    <if test="povertyAlleviationBase.pab006 != null and povertyAlleviationBase.pab006 !='' " >
      and PAB006 = #{povertyAlleviationBase.pab006,jdbcType=VARCHAR}
    </if>
    <if test="povertyAlleviationBase.pab005 != null and povertyAlleviationBase.pab005 !='' " >
      and substr(PAB005,0,4) = #{povertyAlleviationBase.pab005,jdbcType=VARCHAR}
    </if>
    <if test="povertyAlleviationBase.aae036 != null and povertyAlleviationBase.aae036 !='' " >
      and AAE036 = #{povertyAlleviationBase.aae036,jdbcType=TIMESTAMP}
    </if>
    <if test="povertyAlleviationBase.aae011 != null and povertyAlleviationBase.aae011 !='' " >
      and  AAE011 = #{povertyAlleviationBase.aae011,jdbcType=VARCHAR}
    </if>
    <if test="povertyAlleviationBase.datasource != null and povertyAlleviationBase.datasource !='' " >
      and  DATASOURCE = #{povertyAlleviationBase.datasource,jdbcType=VARCHAR}
    </if>
    <if test="povertyAlleviationBase.aae100 != null and povertyAlleviationBase.aae100 !='' " >
      and  AAE100 = #{povertyAlleviationBase.aae100,jdbcType=VARCHAR}
    </if>
    <if test="povertyAlleviationBase.updatedate != null and povertyAlleviationBase.updatedate !='' " >
      and UPDATEDATE = #{povertyAlleviationBase.updatedate,jdbcType=TIMESTAMP}
    </if>
    <if test="povertyAlleviationBase.updateby != null and povertyAlleviationBase.updateby !='' " >
      and  UPDATEBY = #{povertyAlleviationBase.updateby,jdbcType=VARCHAR}
    </if>
    <if test="povertyAlleviationBase.createby != null and povertyAlleviationBase.createby !='' " >
      and CREATEBY = #{povertyAlleviationBase.createby,jdbcType=VARCHAR}
    </if>
    <if test="povertyAlleviationBase.aae012 != null and povertyAlleviationBase.aae012 !='' " >
      and  AAE012 = #{povertyAlleviationBase.aae012,jdbcType=VARCHAR}
    </if>
    <if test="povertyAlleviationBase.pab011 != null and povertyAlleviationBase.pab011 !='' " >
      and PAB011 = #{povertyAlleviationBase.pab011,jdbcType=NUMERIC}
    </if>
    <if test="povertyAlleviationBase.pab012 != null and povertyAlleviationBase.pab012 !='' " >
      and  PAB012 = #{povertyAlleviationBase.pab012,jdbcType=NUMERIC}
    </if>
    <if test="povertyAlleviationBase.pab013 != null and povertyAlleviationBase.pab013 !=''  " >
      and  PAB013 = #{povertyAlleviationBase.pab014,jdbcType=VARCHAR}
    </if>
    <if test="povertyAlleviationBase.pab014 != null and povertyAlleviationBase.pab014 !='' " >
      and  pab014 = #{povertyAlleviationBase.pab014,jdbcType=VARCHAR}
    </if>
    <if test="povertyAlleviationBase.pab015 != null and povertyAlleviationBase.pab015 !='' " >
      and  pab015 = #{povertyAlleviationBase.pab015,jdbcType=VARCHAR}
    </if>
    <if test="povertyAlleviationBase.pab016 != null and povertyAlleviationBase.pab016 !='' " >
      and  pab016 = #{povertyAlleviationBase.pab016,jdbcType=VARCHAR}
    </if>
    <if test="povertyAlleviationBase.pab017 != null and povertyAlleviationBase.pab017 !='' " >
      and  pab017 = #{povertyAlleviationBase.pab017,jdbcType=VARCHAR}
    </if>
    <if test="povertyAlleviationBase.pab018 != null and povertyAlleviationBase.pab018 !='' " >
      and  pab018 = #{povertyAlleviationBase.pab018,jdbcType=VARCHAR}
    </if>
    <if test="povertyAlleviationBase.pab019 != null and povertyAlleviationBase.pab019 !='' " >
      and  pab019 = #{povertyAlleviationBase.pab019,jdbcType=VARCHAR}
    </if>
    <if test="povertyAlleviationBase.pab020 != null and povertyAlleviationBase.pab020 !='' " >
      and  pab020 = #{povertyAlleviationBase.pab020,jdbcType=VARCHAR}
    </if>
    ) a1
    where rownum &lt;= #{pageSize})
    where rn &gt;= #{startRecord}

  </select>

  <!--根据行政区划查询信用乡村信息总条数-->
  <select id="queryAllByAab301" resultType="java.lang.String" parameterType="java.lang.String" >
    select count(1)
    from poverty_alleviation_base
    where  aae100='1' and AAB301 like #{povertyAlleviationBase.aab301,jdbcType=VARCHAR}
    <if test="povertyAlleviationBase.taizhang != null and povertyAlleviationBase.taizhang !='' " >
      and (select count(r.companyid) from relation r,poor_labor_force p where r.peopleid=p.plf001 and  r.aae100 = '1'and p.aae100='1'
      and PAB001 =r.companyid)>=1
      and pab006 is null
    </if>
    /*待完善条件 */
    <if test="povertyAlleviationBase.istobecomplete != null  and povertyAlleviationBase.istobecomplete !='' ">
      and (PAB005 is null or PAB014 is null or (PAB014 ='1' and PAB013 is null))
    </if>
    <if test="povertyAlleviationBase.pab003 != null and povertyAlleviationBase.pab003 !='' " >
      and PAB003 like #{povertyAlleviationBase.pab003,jdbcType=VARCHAR}
    </if>
    <if test="povertyAlleviationBase.pab004 != null and povertyAlleviationBase.pab004 !='' " >
      and PAB004 = #{povertyAlleviationBase.pab004,jdbcType=VARCHAR}
    </if>
    <if test="povertyAlleviationBase.pab007 != null and povertyAlleviationBase.pab007 !='' " >
      and PAB007 = #{povertyAlleviationBase.pab007,jdbcType=DECIMAL}
    </if>
    <if test="povertyAlleviationBase.pab008 != null and povertyAlleviationBase.pab008 !='' " >
      and  PAB008 = #{povertyAlleviationBase.pab008,jdbcType=DECIMAL}
    </if>
    <if test="povertyAlleviationBase.pab009 != null and povertyAlleviationBase.pab009 !='' " >
      and PAB009 = #{povertyAlleviationBase.pab009,jdbcType=VARCHAR}
    </if>
    <if test="povertyAlleviationBase.pab010 != null and povertyAlleviationBase.pab010 !='' " >
      and PAB010 = #{povertyAlleviationBase.pab010,jdbcType=VARCHAR}
    </if>
    <if test="povertyAlleviationBase.pab006 != null and povertyAlleviationBase.pab006 !='' " >
      and PAB006 = #{povertyAlleviationBase.pab006,jdbcType=VARCHAR}
    </if>
    <if test="povertyAlleviationBase.pab005 != null and povertyAlleviationBase.pab005 !='' " >
      and substr(PAB005,0,4) = #{povertyAlleviationBase.pab005,jdbcType=VARCHAR}
    </if>
    <if test="povertyAlleviationBase.aae036 != null and povertyAlleviationBase.aae036 !='' " >
      and AAE036 = #{povertyAlleviationBase.aae036,jdbcType=TIMESTAMP}
    </if>
    <if test="povertyAlleviationBase.aae011 != null and povertyAlleviationBase.aae011 !='' " >
      and  AAE011 = #{povertyAlleviationBase.aae011,jdbcType=VARCHAR}
    </if>
    <if test="povertyAlleviationBase.datasource != null and povertyAlleviationBase.datasource !='' " >
      and  DATASOURCE = #{povertyAlleviationBase.datasource,jdbcType=VARCHAR}
    </if>
    <if test="povertyAlleviationBase.aae100 != null and povertyAlleviationBase.aae100 !='' " >
      and  AAE100 = #{povertyAlleviationBase.aae100,jdbcType=VARCHAR}
    </if>
    <if test="povertyAlleviationBase.updatedate != null and povertyAlleviationBase.updatedate !='' " >
      and UPDATEDATE = #{povertyAlleviationBase.updatedate,jdbcType=TIMESTAMP}
    </if>
    <if test="povertyAlleviationBase.updateby != null and povertyAlleviationBase.updateby !='' " >
      and  UPDATEBY = #{povertyAlleviationBase.updateby,jdbcType=VARCHAR}
    </if>
    <if test="povertyAlleviationBase.createby != null and povertyAlleviationBase.createby !='' " >
      and CREATEBY = #{povertyAlleviationBase.createby,jdbcType=VARCHAR}
    </if>
    <if test="povertyAlleviationBase.aae012 != null and povertyAlleviationBase.aae012 !='' " >
      and  AAE012 = #{povertyAlleviationBase.aae012,jdbcType=VARCHAR}
    </if>
    <if test="povertyAlleviationBase.pab011 != null and povertyAlleviationBase.pab011 !='' " >
      and PAB011 = #{povertyAlleviationBase.pab011,jdbcType=NUMERIC}
    </if>
    <if test="povertyAlleviationBase.pab012 != null and povertyAlleviationBase.pab012 !='' " >
      and  PAB012 = #{povertyAlleviationBase.pab012,jdbcType=NUMERIC}
    </if>
    <if test="povertyAlleviationBase.pab013 != null and povertyAlleviationBase.pab013 !=''  " >
      and  PAB013 = #{povertyAlleviationBase.pab014,jdbcType=VARCHAR}
    </if>
    <if test="povertyAlleviationBase.pab014 != null and povertyAlleviationBase.pab014 !='' " >
      and  pab014 = #{povertyAlleviationBase.pab014,jdbcType=VARCHAR}
    </if>
    <if test="povertyAlleviationBase.pab015 != null and povertyAlleviationBase.pab015 !='' " >
      and  pab015 = #{povertyAlleviationBase.pab015,jdbcType=VARCHAR}
    </if>
    <if test="povertyAlleviationBase.pab016 != null and povertyAlleviationBase.pab016 !='' " >
      and  pab016 = #{povertyAlleviationBase.pab016,jdbcType=VARCHAR}
    </if>
    <if test="povertyAlleviationBase.pab017 != null and povertyAlleviationBase.pab017 !='' " >
      and  pab017 = #{povertyAlleviationBase.pab017,jdbcType=VARCHAR}
    </if>
    <if test="povertyAlleviationBase.pab018 != null and povertyAlleviationBase.pab018 !='' " >
      and  pab018 = #{povertyAlleviationBase.pab018,jdbcType=VARCHAR}
    </if>
    <if test="povertyAlleviationBase.pab019 != null and povertyAlleviationBase.pab019 !='' " >
      and  pab019 = #{povertyAlleviationBase.pab019,jdbcType=VARCHAR}
    </if>
    <if test="povertyAlleviationBase.pab020 != null and povertyAlleviationBase.pab020 !='' " >
      and  pab020 = #{povertyAlleviationBase.pab020,jdbcType=VARCHAR}
    </if>
  </select>



<!--查询待完善的   扶贫基地信息-->

  <!--根据行政区划查询扶贫基地信息-->
  <select id="querytobeCompletePovertyAlleviationBaseByAab301" resultMap="BaseResultMap" parameterType="java.lang.String" >
    select PAB001, AAB301, PAB003, PAB004, PAB007, PAB008, PAB009, PAB010, PAB006, PAB005,PAB015, AAE036,
    AAE011,DATASOURCE,AAE100,UPDATEDATE,UPDATEBY,CREATEBY,AAE012,PAB011,PAB012,PAB013,PAB014,PAB016,PAB017,PAB018,PAB019,PAB020,rn
    from (select PAB001, AAB301, PAB003, PAB004, PAB007, PAB008, PAB009, PAB010, PAB006, PAB005,PAB015, AAE036,
    AAE011,DATASOURCE,AAE100,UPDATEDATE,UPDATEBY,CREATEBY,AAE012,PAB011,PAB012,PAB013,PAB014, PAB016,PAB017,PAB018,PAB019,PAB020,rownum rn
    from ( select PAB001,
    t.INFO AAB301, PAB003, PAB004, PAB007, PAB008, PAB009,
    f_getcodename('AAA009', PAB010)PAB010,
    PAB006, PAB005,PAB015, AAE036,
    AAE011,DATASOURCE,AAE100,UPDATEDATE,UPDATEBY,CREATEBY,AAE012,PAB011,PAB012,
    (select cts002 from centralized_settlements where cts001=PAB013)PAB013,
    f_getcodename('EDC441', PAB014)PAB014,f_getcodename('EDC441', PAB016)PAB016,PAB017,PAB018,PAB019,PAB020
    from poverty_alleviation_base,POOR_XZQH t
    where AAB301=t.XZQHBM and AAE100='1'  and pab001 not in (select r.companyid from relation r where r.aae100 = '1')
    <if test="povertyAlleviationBase.aab301 != null and povertyAlleviationBase.aab301 !='' " >
      and AAB301 like #{povertyAlleviationBase.aab301,jdbcType=VARCHAR}
    </if>
    <if test="povertyAlleviationBase.pab003 != null and povertyAlleviationBase.pab003 !='' " >
      and PAB003 like #{povertyAlleviationBase.pab003,jdbcType=VARCHAR}
    </if>
    <if test="povertyAlleviationBase.pab004 != null and povertyAlleviationBase.pab004 !='' " >
      and PAB004 = #{povertyAlleviationBase.pab004,jdbcType=VARCHAR}
    </if>
    <if test="povertyAlleviationBase.pab007 != null and povertyAlleviationBase.pab007 !='' " >
      and PAB007 = #{povertyAlleviationBase.pab007,jdbcType=DECIMAL}
    </if>
    <if test="povertyAlleviationBase.pab008 != null and povertyAlleviationBase.pab008 !='' " >
      and  PAB008 = #{povertyAlleviationBase.pab008,jdbcType=DECIMAL}
    </if>
    <if test="povertyAlleviationBase.pab009 != null and povertyAlleviationBase.pab009 !='' " >
      and PAB009 = #{povertyAlleviationBase.pab009,jdbcType=VARCHAR}
    </if>
    <if test="povertyAlleviationBase.pab010 != null and povertyAlleviationBase.pab010 !='' " >
      and PAB010 = #{povertyAlleviationBase.pab010,jdbcType=VARCHAR}
    </if>
    <if test="povertyAlleviationBase.pab006 != null and povertyAlleviationBase.pab006 !='' " >
      and PAB006 = #{povertyAlleviationBase.pab006,jdbcType=VARCHAR}
    </if>
    <if test="povertyAlleviationBase.pab005 != null and povertyAlleviationBase.pab005 !='' " >
      and substr(PAB005,0,4) = #{povertyAlleviationBase.pab005,jdbcType=VARCHAR}
    </if>
    <if test="povertyAlleviationBase.aae036 != null and povertyAlleviationBase.aae036 !='' " >
      and AAE036 = #{povertyAlleviationBase.aae036,jdbcType=TIMESTAMP}
    </if>
    <if test="povertyAlleviationBase.aae011 != null and povertyAlleviationBase.aae011 !='' " >
      and  AAE011 = #{povertyAlleviationBase.aae011,jdbcType=VARCHAR}
    </if>
    <if test="povertyAlleviationBase.datasource != null and povertyAlleviationBase.datasource !='' " >
      and  DATASOURCE = #{povertyAlleviationBase.datasource,jdbcType=VARCHAR}
    </if>
    <if test="povertyAlleviationBase.aae100 != null and povertyAlleviationBase.aae100 !='' " >
      and  AAE100 = #{povertyAlleviationBase.aae100,jdbcType=VARCHAR}
    </if>
    <if test="povertyAlleviationBase.updatedate != null and povertyAlleviationBase.updatedate !='' " >
      and UPDATEDATE = #{povertyAlleviationBase.updatedate,jdbcType=TIMESTAMP}
    </if>
    <if test="povertyAlleviationBase.updateby != null and povertyAlleviationBase.updateby !='' " >
      and  UPDATEBY = #{povertyAlleviationBase.updateby,jdbcType=VARCHAR}
    </if>
    <if test="povertyAlleviationBase.createby != null and povertyAlleviationBase.createby !='' " >
      and CREATEBY = #{povertyAlleviationBase.createby,jdbcType=VARCHAR}
    </if>
    <if test="povertyAlleviationBase.aae012 != null and povertyAlleviationBase.aae012 !='' " >
      and  AAE012 = #{povertyAlleviationBase.aae012,jdbcType=VARCHAR}
    </if>
    <if test="povertyAlleviationBase.pab011 != null and povertyAlleviationBase.pab011 !='' " >
      and PAB011 = #{povertyAlleviationBase.pab011,jdbcType=NUMERIC}
    </if>
    <if test="povertyAlleviationBase.pab012 != null and povertyAlleviationBase.pab012 !='' " >
      and  PAB012 = #{povertyAlleviationBase.pab012,jdbcType=NUMERIC}
    </if>
    <if test="povertyAlleviationBase.pab013 != null and povertyAlleviationBase.pab013 !=''  " >
      and  PAB013 = #{povertyAlleviationBase.pab014,jdbcType=VARCHAR}
    </if>
    <if test="povertyAlleviationBase.pab014 != null and povertyAlleviationBase.pab014 !='' " >
      and  pab014 = #{povertyAlleviationBase.pab014,jdbcType=VARCHAR}
    </if>
    <if test="povertyAlleviationBase.pab015 != null and povertyAlleviationBase.pab015 !='' " >
      and  pab015 = #{povertyAlleviationBase.pab015,jdbcType=VARCHAR}
    </if>
    <if test="povertyAlleviationBase.pab016 != null and povertyAlleviationBase.pab016 !='' " >
      and  pab016 = #{povertyAlleviationBase.pab016,jdbcType=VARCHAR}
    </if>
    <if test="povertyAlleviationBase.pab017 != null and povertyAlleviationBase.pab017 !='' " >
      and  pab017 = #{povertyAlleviationBase.pab017,jdbcType=VARCHAR}
    </if>
    <if test="povertyAlleviationBase.pab018 != null and povertyAlleviationBase.pab018 !='' " >
      and  pab018 = #{povertyAlleviationBase.pab018,jdbcType=VARCHAR}
    </if>
    <if test="povertyAlleviationBase.pab019 != null and povertyAlleviationBase.pab019 !='' " >
      and  pab019 = #{povertyAlleviationBase.pab019,jdbcType=VARCHAR}
    </if>
    <if test="povertyAlleviationBase.pab020 != null and povertyAlleviationBase.pab020 !='' " >
      and  pab020 = #{povertyAlleviationBase.pab020,jdbcType=VARCHAR}
    </if>
    ) a1
    where rownum &lt;= #{pageSize})
    where rn &gt;= #{startRecord}

  </select>

  <!--根据行政区划查询信用乡村信息总条数-->
  <select id="queryAlltobeCompleteByAab301" resultType="java.lang.String" parameterType="java.lang.String" >
    select count(1)
    from poverty_alleviation_base
    where  aae100='1' and pab001 not in
    (select r.companyid from relation r where r.aae100 = '1') and AAB301 like #{povertyAlleviationBase.aab301,jdbcType=VARCHAR}
    <if test="povertyAlleviationBase.pab003 != null and povertyAlleviationBase.pab003 !='' " >
      and PAB003 like #{povertyAlleviationBase.pab003,jdbcType=VARCHAR}
    </if>
    <if test="povertyAlleviationBase.pab004 != null and povertyAlleviationBase.pab004 !='' " >
      and PAB004 = #{povertyAlleviationBase.pab004,jdbcType=VARCHAR}
    </if>
    <if test="povertyAlleviationBase.pab007 != null and povertyAlleviationBase.pab007 !='' " >
      and PAB007 = #{povertyAlleviationBase.pab007,jdbcType=DECIMAL}
    </if>
    <if test="povertyAlleviationBase.pab008 != null and povertyAlleviationBase.pab008 !='' " >
      and  PAB008 = #{povertyAlleviationBase.pab008,jdbcType=DECIMAL}
    </if>
    <if test="povertyAlleviationBase.pab009 != null and povertyAlleviationBase.pab009 !='' " >
      and PAB009 = #{povertyAlleviationBase.pab009,jdbcType=VARCHAR}
    </if>
    <if test="povertyAlleviationBase.pab010 != null and povertyAlleviationBase.pab010 !='' " >
      and PAB010 = #{povertyAlleviationBase.pab010,jdbcType=VARCHAR}
    </if>
    <if test="povertyAlleviationBase.pab006 != null and povertyAlleviationBase.pab006 !='' " >
      and PAB006 = #{povertyAlleviationBase.pab006,jdbcType=VARCHAR}
    </if>
    <if test="povertyAlleviationBase.pab005 != null and povertyAlleviationBase.pab005 !='' " >
      and substr(PAB005,0,4) = #{povertyAlleviationBase.pab005,jdbcType=VARCHAR}
    </if>
    <if test="povertyAlleviationBase.aae036 != null and povertyAlleviationBase.aae036 !='' " >
      and AAE036 = #{povertyAlleviationBase.aae036,jdbcType=TIMESTAMP}
    </if>
    <if test="povertyAlleviationBase.aae011 != null and povertyAlleviationBase.aae011 !='' " >
      and  AAE011 = #{povertyAlleviationBase.aae011,jdbcType=VARCHAR}
    </if>
    <if test="povertyAlleviationBase.datasource != null and povertyAlleviationBase.datasource !='' " >
      and  DATASOURCE = #{povertyAlleviationBase.datasource,jdbcType=VARCHAR}
    </if>
    <if test="povertyAlleviationBase.aae100 != null and povertyAlleviationBase.aae100 !='' " >
      and  AAE100 = #{povertyAlleviationBase.aae100,jdbcType=VARCHAR}
    </if>
    <if test="povertyAlleviationBase.updatedate != null and povertyAlleviationBase.updatedate !='' " >
      and UPDATEDATE = #{povertyAlleviationBase.updatedate,jdbcType=TIMESTAMP}
    </if>
    <if test="povertyAlleviationBase.updateby != null and povertyAlleviationBase.updateby !='' " >
      and  UPDATEBY = #{povertyAlleviationBase.updateby,jdbcType=VARCHAR}
    </if>
    <if test="povertyAlleviationBase.createby != null and povertyAlleviationBase.createby !='' " >
      and CREATEBY = #{povertyAlleviationBase.createby,jdbcType=VARCHAR}
    </if>
    <if test="povertyAlleviationBase.aae012 != null and povertyAlleviationBase.aae012 !='' " >
      and  AAE012 = #{povertyAlleviationBase.aae012,jdbcType=VARCHAR}
    </if>
    <if test="povertyAlleviationBase.pab011 != null and povertyAlleviationBase.pab011 !='' " >
      and PAB011 = #{povertyAlleviationBase.pab011,jdbcType=NUMERIC}
    </if>
    <if test="povertyAlleviationBase.pab012 != null and povertyAlleviationBase.pab012 !='' " >
      and  PAB012 = #{povertyAlleviationBase.pab012,jdbcType=NUMERIC}
    </if>
    <if test="povertyAlleviationBase.pab013 != null and povertyAlleviationBase.pab013 !=''  " >
      and  PAB013 = #{povertyAlleviationBase.pab014,jdbcType=VARCHAR}
    </if>
    <if test="povertyAlleviationBase.pab014 != null and povertyAlleviationBase.pab014 !='' " >
      and  pab014 = #{povertyAlleviationBase.pab014,jdbcType=VARCHAR}
    </if>
    <if test="povertyAlleviationBase.pab015 != null and povertyAlleviationBase.pab015 !='' " >
      and  pab015 = #{povertyAlleviationBase.pab015,jdbcType=VARCHAR}
    </if>
    <if test="povertyAlleviationBase.pab016 != null and povertyAlleviationBase.pab016 !='' " >
      and  pab016 = #{povertyAlleviationBase.pab016,jdbcType=VARCHAR}
    </if>
    <if test="povertyAlleviationBase.pab017 != null and povertyAlleviationBase.pab017 !='' " >
      and  pab017 = #{povertyAlleviationBase.pab017,jdbcType=VARCHAR}
    </if>
    <if test="povertyAlleviationBase.pab018 != null and povertyAlleviationBase.pab018 !='' " >
      and  pab018 = #{povertyAlleviationBase.pab018,jdbcType=VARCHAR}
    </if>
    <if test="povertyAlleviationBase.pab019 != null and povertyAlleviationBase.pab019 !='' " >
      and  pab019 = #{povertyAlleviationBase.pab019,jdbcType=VARCHAR}
    </if>
    <if test="povertyAlleviationBase.pab020 != null and povertyAlleviationBase.pab020 !='' " >
      and  pab020 = #{povertyAlleviationBase.pab020,jdbcType=VARCHAR}
    </if>
  </select>

</mapper>