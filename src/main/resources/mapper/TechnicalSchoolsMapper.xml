<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.tdkj.dao.InformationCollection.TechnicalSchoolsMapper" >
  <resultMap id="BaseResultMap" type="com.tdkj.model.TechnicalSchools" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    <id column="THS001" property="ths001" jdbcType="VARCHAR" />
    <result column="AAB301" property="aab301" jdbcType="VARCHAR" />
    <result column="THS003" property="ths003" jdbcType="VARCHAR" />
    <result column="THS004" property="ths004" jdbcType="VARCHAR" />
    <result column="THS005" property="ths005" jdbcType="VARCHAR" />
    <result column="THS006" property="ths006" jdbcType="VARCHAR" />
    <result column="THS007" property="ths007" jdbcType="VARCHAR" />
    <result column="THS008" property="ths008" jdbcType="VARCHAR" />
    <result column="THS009" property="ths009" jdbcType="VARCHAR" />
    <result column="THS010" property="ths010" jdbcType="VARCHAR" />
    <result column="THS011" property="ths011" jdbcType="VARCHAR" />
    <result column="THS012" property="ths012" jdbcType="VARCHAR" />
    <result column="THS013" property="ths013" jdbcType="VARCHAR" />
    <result column="THS014" property="ths014" jdbcType="VARCHAR" />
    <result column="THS015" property="ths015" jdbcType="VARCHAR" />
    <result column="AAE036" property="aae036" jdbcType="TIMESTAMP" />
    <result column="THS016" property="ths016" jdbcType="VARCHAR" />
    <result column="AAE011" property="aae011" jdbcType="VARCHAR" />
    <result column="THS002" property="ths002" jdbcType="VARCHAR" />
    <result column="DATASOURCE" property="datasource" jdbcType="VARCHAR" />
    <result column="AAE100" property="aae100" jdbcType="VARCHAR" />
    <result column="UPDATEDATE" property="updatedate" jdbcType="TIMESTAMP" />
    <result column="UPDATEBY" property="updateby" jdbcType="VARCHAR" />
    <result column="CREATEBY" property="createby" jdbcType="VARCHAR" />
    <result column="AAE012" property="aae012" jdbcType="VARCHAR" />
    <result column="ISNEW" property="isnew" jdbcType="VARCHAR" />
    <result column="DELETEBY" property="deleteby" jdbcType="VARCHAR" />
    <result column="DELETEDATE" property="deletedate" jdbcType="TIMESTAMP" />

  </resultMap>

  <resultMap id="ThsPlfResultMap" type="com.tdkj.model.ThsPlf" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    <id column="THS001" property="ths001" jdbcType="VARCHAR" />
    <result column="AAB301" property="aab301" jdbcType="VARCHAR" />
    <result column="THS003" property="ths003" jdbcType="VARCHAR" />
    <result column="THS004" property="ths004" jdbcType="VARCHAR" />
    <result column="THS005" property="ths005" jdbcType="VARCHAR" />
    <result column="THS006" property="ths006" jdbcType="VARCHAR" />
    <result column="THS007" property="ths007" jdbcType="VARCHAR" />
    <result column="THS008" property="ths008" jdbcType="VARCHAR" />
    <result column="THS009" property="ths009" jdbcType="VARCHAR" />
    <result column="THS010" property="ths010" jdbcType="VARCHAR" />
    <result column="THS011" property="ths011" jdbcType="VARCHAR" />
    <result column="THS012" property="ths012" jdbcType="VARCHAR" />
    <result column="THS013" property="ths013" jdbcType="VARCHAR" />
    <result column="THS014" property="ths014" jdbcType="VARCHAR" />
    <result column="THS015" property="ths015" jdbcType="VARCHAR" />
    <result column="AAE036" property="aae036" jdbcType="TIMESTAMP" />
    <result column="THS016" property="ths016" jdbcType="VARCHAR" />
    <result column="AAE011" property="aae011" jdbcType="VARCHAR" />
    <result column="THS002" property="ths002" jdbcType="VARCHAR" />
    <result column="DATASOURCE" property="datasource" jdbcType="VARCHAR" />
    <result column="AAE100" property="aae100" jdbcType="VARCHAR" />
    <result column="UPDATEDATE" property="updatedate" jdbcType="TIMESTAMP" />
    <result column="UPDATEBY" property="updateby" jdbcType="VARCHAR" />
    <result column="CREATEBY" property="createby" jdbcType="VARCHAR" />
    <result column="AAE012" property="aae012" jdbcType="VARCHAR" />
    <result column="ISNEW" property="isnew" jdbcType="VARCHAR" />

    <result column="PLF001" property="plf001" jdbcType="VARCHAR" />
    <result column="PLF002" property="plf002" jdbcType="VARCHAR" />
    <result column="PLF004" property="plf004" jdbcType="VARCHAR" />
    <result column="PLF005" property="plf005" jdbcType="VARCHAR" />
    <result column="PLF006" property="plf006" jdbcType="VARCHAR" />
    <result column="PLF007" property="plf007" jdbcType="VARCHAR" />
    <result column="PLF008" property="plf008" jdbcType="VARCHAR" />
    <result column="PLF009" property="plf009" jdbcType="VARCHAR" />
    <result column="PLF010" property="plf010" jdbcType="VARCHAR" />
    <result column="PLF011" property="plf011" jdbcType="VARCHAR" />
    <result column="PLF012" property="plf012" jdbcType="VARCHAR" />
    <result column="PLF013" property="plf013" jdbcType="VARCHAR" />
    <result column="PLF014" property="plf014" jdbcType="VARCHAR" />
    <result column="AAE011" property="aae011" jdbcType="VARCHAR" />
    <result column="AAE036" property="aae036" jdbcType="TIMESTAMP" />
    <result column="PLF016" property="plf016" jdbcType="VARCHAR" />
    <result column="PLF015" property="plf015" jdbcType="VARCHAR" />
    <result column="PLF017" property="plf017" jdbcType="VARCHAR" />
    <result column="PLF018" property="plf018" jdbcType="VARCHAR" />
    <result column="PLF019" property="plf019" jdbcType="VARCHAR" />
    <result column="PLF020" property="plf020" jdbcType="VARCHAR" />
    <result column="PLF021" property="plf021" jdbcType="VARCHAR" />
    <result column="PLF022" property="plf022" jdbcType="VARCHAR" />
    <result column="PLF023" property="plf023" jdbcType="VARCHAR" />
    <result column="PLF024" property="plf024" jdbcType="VARCHAR" />
    <result column="DELETEBY" property="deleteby" jdbcType="VARCHAR" />
    <result column="DELETEDATE" property="deletedate" jdbcType="TIMESTAMP" />

  </resultMap>

  <sql id="Base_Column_List" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    THS001, AAB301, THS003, THS004, THS005, THS006, THS007, THS008, THS009, THS010, THS011, 
    THS012, AAE036, AAE011, THS002,DATASOURCE,AAE100,UPDATEDATE,UPDATEBY,CREATEBY,AAE012,THS013,THS014,THS015,THS016,ISNEW,DELETEBY,DELETEDATE
  </sql>
  <select id="selectByPrimaryKey" resultMap="BaseResultMap" parameterType="java.lang.String" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    select 
    <include refid="Base_Column_List" />
    from technical_schools
    where THS001 = #{ths001,jdbcType=VARCHAR}
  </select>
  <!--<delete id="deleteByPrimaryKey" parameterType="java.lang.String" >
    &lt;!&ndash;
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    &ndash;&gt;
    delete from technical_schools
    where THS001 = #{ths001,jdbcType=VARCHAR}
  </delete>-->

  <update id="deleteByPrimaryKey" parameterType="java.lang.String" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    update technical_schools set aae100='0'
    where THS001 = #{ths001,jdbcType=VARCHAR}
  </update>

  <!--根据劳动力id 修改是否最新字段-->
  <update id="updateIsNewByThs002" parameterType="java.lang.String" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    update  technical_schools set isnew='0'
    where THS002 = #{ths002,jdbcType=VARCHAR}
  </update>

  <insert id="insert" parameterType="com.tdkj.model.TechnicalSchools" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    insert into technical_schools (THS001, AAB301, THS003, 
      THS004, THS005, THS006, 
      THS007, THS008, THS009, 
      THS010, THS011, THS012, THS013，THS014，THS015，THS016，
      AAE036, AAE011, THS002,DATASOURCE,AAE100,UPDATEDATE,UPDATEBY,CREATEBY,AAE012,ISNEW,DELETEBY,DELETEDATE
      )
    values (#{ths001,jdbcType=VARCHAR}, #{aab301,jdbcType=VARCHAR}, #{ths003,jdbcType=VARCHAR}, 
      #{ths004,jdbcType=VARCHAR}, #{ths005,jdbcType=VARCHAR}, #{ths006,jdbcType=VARCHAR},
      #{ths007,jdbcType=VARCHAR}, #{ths008,jdbcType=VARCHAR}, #{ths009,jdbcType=VARCHAR}, 
      #{ths010,jdbcType=VARCHAR}, #{ths011,jdbcType=VARCHAR}, #{ths012,jdbcType=VARCHAR},
      #{ths013,jdbcType=VARCHAR},#{ths014,jdbcType=VARCHAR},#{ths015,jdbcType=VARCHAR},#{ths016,jdbcType=VARCHAR},
      #{aae036,jdbcType=TIMESTAMP}, #{aae011,jdbcType=VARCHAR}, #{ths002,jdbcType=VARCHAR},
      #{datasource,jdbcType=VARCHAR},#{aae100,jdbcType=VARCHAR},#{updatedate,jdbcType=TIMESTAMP},#{updateby,jdbcType=VARCHAR},
      #{createby,jdbcType=VARCHAR},#{aae012,jdbcType=VARCHAR},#{isnew,jdbcType=VARCHAR},#{deleteby,jdbcType=VARCHAR},#{deletedate,jdbcType=TIMESTAMP}
      )
  </insert>

    <insert id="addList" parameterType="java.util.List" useGeneratedKeys="false">
        INSERT INTO TECHNICAL_SCHOOLS

        (THS001, AAB301, THS003,
        THS004, THS005, THS006,
        THS007, THS008, THS009,
        THS010, THS011, THS012,
        AAE036, AAE011, THS002,
        DATASOURCE, AAE100, UPDATEDATE,
        UPDATEBY, CREATEBY, AAE012,
        THS013, THS014, THS015,
        THS016, BATCH, IDENTIFICATION,
        MESSAGE, ISNEW, AAC003,DELETEBY,DELETEDATE)

        <foreach item="bean" index="index" collection="list" separator="union all">
            (

            select #{bean.ths001,jdbcType=VARCHAR}, #{bean.aab301,jdbcType=VARCHAR}, #{bean.ths003,jdbcType=VARCHAR},
            #{bean.ths004,jdbcType=VARCHAR}, #{bean.ths005,jdbcType=VARCHAR}, #{bean.ths006,jdbcType=VARCHAR},
            #{bean.ths007,jdbcType=VARCHAR}, #{bean.ths008,jdbcType=VARCHAR}, #{bean.ths009,jdbcType=VARCHAR},
            #{bean.ths010,jdbcType=VARCHAR}, #{bean.ths011,jdbcType=VARCHAR}, #{bean.ths012,jdbcType=VARCHAR},
            #{bean.aae036,jdbcType=TIMESTAMP}, #{bean.aae011,jdbcType=VARCHAR}, #{bean.ths002,jdbcType=VARCHAR},
            #{bean.datasource,jdbcType=VARCHAR}, #{bean.aae100,jdbcType=VARCHAR}, #{bean.updatedate,jdbcType=TIMESTAMP},
            #{bean.updateby,jdbcType=VARCHAR}, #{bean.createby,jdbcType=VARCHAR}, #{bean.aae012,jdbcType=VARCHAR},
            #{bean.ths013,jdbcType=VARCHAR}, #{bean.ths014,jdbcType=VARCHAR}, #{bean.ths015,jdbcType=VARCHAR},
            #{bean.ths016,jdbcType=VARCHAR}, #{bean.batch,jdbcType=VARCHAR}, #{bean.identification,jdbcType=VARCHAR},
            #{bean.message,jdbcType=VARCHAR}, #{bean.isnew,jdbcType=VARCHAR}, #{bean.aac003,jdbcType=VARCHAR},#{bean.deleteby,jdbcType=VARCHAR},#{bean.deletedate,jdbcType=TIMESTAMP}
            from dual

            )
        </foreach>
    </insert>

  <insert id="insertSelective" parameterType="com.tdkj.model.TechnicalSchools" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    insert into technical_schools
    <trim prefix="(" suffix=")" suffixOverrides="," >
      <if test="ths001 != null" >
        THS001,
      </if>
      <if test="aab301 != null" >
        AAB301,
      </if>
      <if test="ths003 != null" >
        THS003,
      </if>
      <if test="ths004 != null" >
        THS004,
      </if>
      <if test="ths005 != null" >
        THS005,
      </if>
      <if test="ths006 != null" >
        THS006,
      </if>
      <if test="ths007 != null" >
        THS007,
      </if>
      <if test="ths008 != null" >
        THS008,
      </if>
      <if test="ths009 != null" >
        THS009,
      </if>
      <if test="ths010 != null" >
        THS010,
      </if>
      <if test="ths011 != null" >
        THS011,
      </if>
      <if test="ths012 != null" >
        THS012,
      </if>
      <if test="aae036 != null" >
        AAE036,
      </if>
      <if test="aae011 != null" >
        AAE011,
      </if>
      <if test="ths002 != null" >
        THS002,
      </if>
      <if test="datasource != null" >
        DATASOURCE,
      </if>
      <if test="aae100 != null" >
        AAE100,
      </if>
      <if test="updatedate != null" >
        UPDATEDATE,
      </if>
      <if test="updateby != null" >
        UPDATEBY,
      </if>
      <if test="createby != null" >
        CREATEBY,
      </if>
      <if test="aae012 != null" >
        AAE012,
      </if>
      <if test="ths013 != null" >
        THS013,
      </if>
      <if test="ths014 != null" >
        THS014,
      </if>
      <if test="ths015 != null" >
        THS015,
      </if>
      <if test="ths016 != null" >
        THS016,
      </if>
      <if test="isnew != null" >
        ISNEW,
      </if>
      <if test="deleteby != null" >
        DELETEBY,
      </if>
      <if test="deletedate != null" >
        DELETEDATE,
      </if>
    </trim>
    <trim prefix="values (" suffix=")" suffixOverrides="," >
      <if test="ths001 != null" >
        #{ths001,jdbcType=VARCHAR},
      </if>
      <if test="aab301 != null" >
        #{aab301,jdbcType=VARCHAR},
      </if>
      <if test="ths003 != null" >
        #{ths003,jdbcType=VARCHAR},
      </if>
      <if test="ths004 != null" >
        #{ths004,jdbcType=VARCHAR},
      </if>
      <if test="ths005 != null" >
        #{ths005,jdbcType=VARCHAR},
      </if>
      <if test="ths006 != null" >
        #{ths006,jdbcType=VARCHAR},
      </if>
      <if test="ths007 != null" >
        #{ths007,jdbcType=VARCHAR},
      </if>
      <if test="ths008 != null" >
        #{ths008,jdbcType=VARCHAR},
      </if>
      <if test="ths009 != null" >
        #{ths009,jdbcType=VARCHAR},
      </if>
      <if test="ths010 != null" >
        #{ths010,jdbcType=VARCHAR},
      </if>
      <if test="ths011 != null" >
        #{ths011,jdbcType=VARCHAR},
      </if>
      <if test="ths012 != null" >
        #{ths012,jdbcType=VARCHAR},
      </if>
      <if test="aae036 != null" >
        #{aae036,jdbcType=TIMESTAMP},
      </if>
      <if test="aae011 != null" >
        #{aae011,jdbcType=VARCHAR},
      </if>
      <if test="ths002 != null" >
        #{ths002,jdbcType=VARCHAR},
      </if>
      <if test="datasource != null" >
        #{datasource,jdbcType=VARCHAR},
      </if>
      <if test="aae100 != null" >
        #{aae100,jdbcType=VARCHAR},
      </if>
      <if test="updatedate != null" >
        #{updatedate,jdbcType=TIMESTAMP},
      </if>
      <if test="updateby != null" >
        #{updateby,jdbcType=VARCHAR},
      </if>
      <if test="createby != null" >
        #{createby,jdbcType=VARCHAR},
      </if>
      <if test="aae012 != null" >
        #{aae012,jdbcType=VARCHAR},
      </if>
      <if test="ths013 != null" >
        #{ths013,jdbcType=VARCHAR},
      </if>
      <if test="ths014 != null" >
        #{ths014,jdbcType=VARCHAR},
      </if>
      <if test="ths015 != null" >
        #{ths015,jdbcType=VARCHAR},
      </if>
      <if test="ths016 != null" >
        #{ths016,jdbcType=VARCHAR},
      </if>
      <if test="isnew != null" >
        #{isnew,jdbcType=VARCHAR},
      </if>
      <if test="deleteby != null" >
        #{deleteby,jdbcType=VARCHAR},
      </if>
      <if test="deletedate != null" >
        #{deletedate,jdbcType=TIMESTAMP},
      </if>
    </trim>
  </insert>
  <update id="updateByPrimaryKeySelective" parameterType="com.tdkj.model.TechnicalSchools" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    update technical_schools
    <set >
      <if test="aab301 != null" >
        AAB301 = #{aab301,jdbcType=VARCHAR},
      </if>
      <if test="ths003 != null" >
        THS003 = #{ths003,jdbcType=VARCHAR},
      </if>
      <if test="ths004 != null" >
        THS004 = #{ths004,jdbcType=VARCHAR},
      </if>
      <if test="ths005 != null" >
        THS005 = #{ths005,jdbcType=VARCHAR},
      </if>
      <if test="ths006 != null" >
        THS006 = #{ths006,jdbcType=VARCHAR},
      </if>
      <if test="ths007 != null" >
        THS007 = #{ths007,jdbcType=VARCHAR},
      </if>
      <if test="ths008 != null" >
        THS008 = #{ths008,jdbcType=VARCHAR},
      </if>
      <if test="ths009 != null" >
        THS009 = #{ths009,jdbcType=VARCHAR},
      </if>
      <if test="ths010 != null" >
        THS010 = #{ths010,jdbcType=VARCHAR},
      </if>
      <if test="ths011 != null" >
        THS011 = #{ths011,jdbcType=VARCHAR},
      </if>
      <if test="ths012 != null" >
        THS012 = #{ths012,jdbcType=VARCHAR},
      </if>
      <if test="aae036 != null" >
        AAE036 = #{aae036,jdbcType=TIMESTAMP},
      </if>
      <if test="aae011 != null" >
        AAE011 = #{aae011,jdbcType=VARCHAR},
      </if>
      <if test="ths002 != null" >
        THS002 = #{ths002,jdbcType=VARCHAR},
      </if>
      <if test="datasource != null" >
        DATASOURCE = #{datasource,jdbcType=VARCHAR},
      </if>
      <if test="aae100 != null" >
        AAE100 = #{aae100,jdbcType=VARCHAR},
      </if>
      <if test="updatedate != null" >
        UPDATEDATE = #{updatedate,jdbcType=TIMESTAMP},
      </if>
      <if test="updateby != null" >
        UPDATEBY = #{updateby,jdbcType=VARCHAR},
      </if>
      <if test="createby != null" >
        CREATEBY = #{createby,jdbcType=VARCHAR},
      </if>
      <if test="aae012 != null" >
        AAE012 = #{aae012,jdbcType=VARCHAR},
      </if>
      <if test="ths013 != null" >
        THS013 = #{ths013,jdbcType=VARCHAR},
      </if>
      <if test="ths014 != null" >
        THS014 = #{ths014,jdbcType=VARCHAR},
      </if>
      <if test="ths015 != null" >
        THS015 = #{ths015,jdbcType=VARCHAR},
      </if>
      <if test="ths016 != null" >
        THS016 = #{ths016,jdbcType=VARCHAR},
      </if>
      <if test="isnew != null" >
        ISNEW = #{isnew,jdbcType=VARCHAR},
      </if>
      <if test="deleteby != null" >
        DELETEBY = #{deleteby,jdbcType=VARCHAR},
      </if>
      <if test="deletedate != null" >
        DELETEDATE = #{deletedate,jdbcType=TIMESTAMP},
      </if>
    </set>
    where THS001 = #{ths001,jdbcType=VARCHAR}
  </update>
  <update id="updateByPrimaryKey" parameterType="com.tdkj.model.TechnicalSchools" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    update technical_schools
    set AAB301 = #{aab301,jdbcType=VARCHAR},
      THS003 = #{ths003,jdbcType=VARCHAR},
      THS004 = #{ths004,jdbcType=VARCHAR},
      THS005 = #{ths005,jdbcType=VARCHAR},
      THS006 = #{ths006,jdbcType=VARCHAR},
      THS007 = #{ths007,jdbcType=VARCHAR},
      THS008 = #{ths008,jdbcType=VARCHAR},
      THS009 = #{ths009,jdbcType=VARCHAR},
      THS010 = #{ths010,jdbcType=VARCHAR},
      THS011 = #{ths011,jdbcType=VARCHAR},
      THS012 = #{ths012,jdbcType=VARCHAR},
      AAE036 = #{aae036,jdbcType=TIMESTAMP},
      AAE011 = #{aae011,jdbcType=VARCHAR},
      THS002 = #{ths002,jdbcType=VARCHAR},
    DATASOURCE = #{datasource,jdbcType=VARCHAR},
    AAE100 = #{aae100,jdbcType=VARCHAR},
    UPDATEDATE = #{updatedate,jdbcType=TIMESTAMP},
    UPDATEBY = #{updateby,jdbcType=VARCHAR},
    CREATEBY = #{createby,jdbcType=VARCHAR},
    AAE012 = #{aae012,jdbcType=VARCHAR},
    ISNEW = #{isnew,jdbcType=VARCHAR},
    DELETEBY = #{deleteby,jdbcType=VARCHAR},
    DELETEDATE = #{deletedate,jdbcType=TIMESTAMP}
    where THS001 = #{ths001,jdbcType=VARCHAR}
  </update>

  <!--根据劳动力id 查询劳动力技工院校情况信息-->
  <select id="queryTechnicalSchoolsByThs002" resultMap="BaseResultMap" parameterType="java.lang.String" >
    select
     THS001, AAB301, THS003, THS004, THS005, THS006, THS007, THS008, THS009, THS010, THS011,
    THS012,THS013,THS014,THS015,THS016, AAE036, AAE011, THS002,DATASOURCE,AAE100,UPDATEDATE,UPDATEBY,CREATEBY,AAE012,ISNEW
    from technical_schools
    where  THS002 = #{ths002,jdbcType=VARCHAR} and aae100='1'
  </select>

  <!--根据劳动力id 删除技工院校情况信息-->
  <update id="deleteTechnicalSchoolsByThs002" parameterType="java.lang.String" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    update  technical_schools set aae100='0',DELETEBY=#{realname,jdbcType=VARCHAR},DELETEDATE=sysdate
    where THS002 = #{ths002,jdbcType=VARCHAR}
  </update>


  <!--*************************************以下是台账信息查询***********************************************************************************-->


  <!--根据行政区划查询劳动力技工院校台账信息-->
    <!--<if test="thsPlf.showscope != null and thsPlf.showscope !='' ">
        and plf.plf018 in ('01','02')    and plf.ispoor='1'  and plf.plf025='0' and plf.plf015 ='0'
    </if>-->
  <select id="queryTechnicalSchoolAccountByAab301" resultMap="ThsPlfResultMap" parameterType="java.lang.String" >
    select plf001,plf002,
    plf004,plf005,plf006,plf007,plf008,
    plf009,plf010,plf011,plf012,plf013,plf015,plf016,plf017,plf018,
    plf023,plf024,phd013,phd007,rn,phd014,
    THS001, AAB301, THS003, THS004, THS005, THS006, THS007, THS008, THS009, THS010, THS011,
    THS012,THS013,THS014,THS015,THS016, AAE036, AAE011, THS002,DATASOURCE,AAE100,UPDATEDATE,UPDATEBY,CREATEBY,AAE012,ISNEW
    from (select plf001,plf002,
    plf004,plf005,plf006,plf007,plf008,
    plf009,plf010,plf011,plf012,plf013,plf015,plf016,plf017,plf018,
    plf023,plf024,phd013,phd007,phd014,
    THS001, AAB301, THS003, THS004, THS005, THS006, THS007, THS008, THS009, THS010, THS011,
    THS012,THS013,THS014,THS015,THS016, AAE036, AAE011, THS002,DATASOURCE,AAE100,UPDATEDATE,UPDATEBY,CREATEBY,AAE012,ISNEW, rownum rn
    from (select plf.plf001,plf.plf002,plf.plf004,plf.plf005,plf.plf006,
      f_getcodename('AAC004',plf.PLF007) PLF007,plf.PLF008,
      f_getcodename('AAC011',plf.PLF009) PLF009,
      f_getcodename('AAA004',plf.PLF010) PLF010,
      f_getcodename('AAA002',plf.PLF011) PLF011,
      f_getcodename('AAA003',plf.PLF012) PLF012,
      f_getcodename('EDC441',plf.PLF013) PLF013,plf.PLF016,
      f_getcodename('AAA001',plf.PLF014) PLF014,
      (case when plf.plf015 ='1' then '是' else '否' end) plf015,
      f_getcodename('AAA011',plf.PLF017) PLF017,
      f_getcodename('AAA016',plf.PLF018) PLF018,
      f_getcodename('EDC441',plf.plf023) plf023,
      f_getcodename('PLF024',plf.plf024) plf024,
      f_getcodename('EDC441',ts.PHD013) phd013,''phd007, f_getcodename('AAA012',ts.phd014) phd014,
    ts.THS001, t.info AAB301, ts.THS003, ts.THS004, ts.THS005, ts.THS006, ts.THS007, ts.THS008,ts.THS009,  f_getcodename('EDC441',ts.THS010)THS010, ts.THS011,
    ts.THS012,ts.THS013,ts.THS014,ts.THS015,ts.THS016, ts.AAE036, ts.AAE011, ts.THS002,ts.DATASOURCE,ts.AAE100,
    ts.UPDATEDATE,ts.UPDATEBY,ts.CREATEBY,ts.AAE012,ts.ISNEW,
      row_number() over(partition by ts.ths002   order by ths005   desc) as sn
    from  technical_schools ts left join  poor_labor_force plf  on ts.ths002 = plf.plf001 ,POOR_XZQH t
    where plf.AAB301=t.XZQHBM and ts.aae100='1'  and plf.aae100='1'
    /*待完善条件 THS005 入学日期 不能为空*/
    <if test="thsPlf.istobecomplete != null  and thsPlf.istobecomplete !='' ">
      and ts.THS005 is null
    </if>
      <if test="thsPlf.showscope != null  and thsPlf.showscope==1 ">
          and (ths006 is null or to_date(ths006,'yyyy-mm-dd')>sysdate)
      </if>
      <if test="thsPlf.showscope != null  and thsPlf.showscope==2 ">
          and ths006 is not null and sysdate>to_date(ths006,'yyyy-mm-dd')
      </if>
      <if test="thsPlf.helpyear != null and thsPlf.helpyear !='' ">
          and   substr(ts.THS005,0,4) = #{thsPlf.helpyear,jdbcType=VARCHAR}
      </if>
      <!--<if test='thsPlf.isnoduty != null and thsPlf.isnoduty =="1" '>
          and  ts.THS006 is  null
      </if>
      <if test='thsPlf.isnoduty != null and thsPlf.isnoduty =="0" '>
          and  ts.THS006 is  not null
      </if>-->
    <if test="thsPlf.ths003 != null and thsPlf.ths003 != '' " >
      and ts.THS003 = #{thsPlf.ths003,jdbcType=VARCHAR}
    </if>
    <if test="thsPlf.ths004 != null and thsPlf.ths004 != '' " >
      and ts.THS004 = #{thsPlf.ths004,jdbcType=VARCHAR}
    </if>
    <if test="thsPlf.ths005 != null and thsPlf.ths005 != '' " >
      and ts.THS005 = #{thsPlf.ths005,jdbcType=VARCHAR}
    </if>
    <if test="thsPlf.ths006 != null and thsPlf.ths006 != '' " >
      and ts.THS006 = #{thsPlf.ths006,jdbcType=VARCHAR}
    </if>
    <if test="thsPlf.ths007 != null and thsPlf.ths007 != '' " >
      and ts.THS007 = #{thsPlf.ths007,jdbcType=VARCHAR}
    </if>
    <if test="thsPlf.ths008 != null and thsPlf.ths008 != '' " >
      and ts.THS008 = #{thsPlf.ths008,jdbcType=VARCHAR}
    </if>
    <if test="thsPlf.ths009 != null and thsPlf.ths009 != '' " >
      and ts.THS009 = #{thsPlf.ths009,jdbcType=VARCHAR}
    </if>
    <if test="thsPlf.ths010 != null and thsPlf.ths010 != '' " >
      and ts.THS010 = #{thsPlf.ths010,jdbcType=VARCHAR}
    </if>
    <if test="thsPlf.ths011 != null and thsPlf.ths011 != '' " >
      and ts.THS011 = #{thsPlf.ths011,jdbcType=VARCHAR}
    </if>
    <if test="thsPlf.ths012 != null and thsPlf.ths012 != '' " >
      and ts.THS012 = #{thsPlf.ths012,jdbcType=VARCHAR}
    </if>
    <if test="thsPlf.aae036 != null and thsPlf.aae036 != '' " >
      and ts.AAE036 = #{thsPlf.aae036,jdbcType=TIMESTAMP}
    </if>
    <if test="thsPlf.aae011 != null and thsPlf.aae011 != '' " >
      and ts.AAE011 = #{thsPlf.aae011,jdbcType=VARCHAR}
    </if>
    <if test="thsPlf.ths002 != null and thsPlf.ths002 != '' " >
      and ts.THS002 = #{thsPlf.ths002,jdbcType=VARCHAR}
    </if>
    <if test="thsPlf.datasource != null and thsPlf.datasource != '' " >
      and ts.DATASOURCE = #{thsPlf.datasource,jdbcType=VARCHAR}
    </if>
    <if test="thsPlf.aae100 != null and thsPlf.aae100 != '' " >
      and ts.AAE100 = #{thsPlf.aae100,jdbcType=VARCHAR}
    </if>
    <if test="thsPlf.updatedate != null and thsPlf.updatedate != '' " >
      and ts.UPDATEDATE = #{thsPlf.updatedate,jdbcType=TIMESTAMP}
    </if>
    <if test="thsPlf.updateby != null and thsPlf.updateby != '' " >
      and ts.UPDATEBY = #{thsPlf.updateby,jdbcType=VARCHAR}
    </if>
    <if test="thsPlf.createby != null and thsPlf.createby != '' " >
      and ts.CREATEBY = #{thsPlf.createby,jdbcType=VARCHAR}
    </if>
    <if test="thsPlf.aae012 != null and thsPlf.aae012 != '' " >
      and ts.AAE012 = #{thsPlf.aae012,jdbcType=VARCHAR}
    </if>
    <if test="thsPlf.ths013 != null and thsPlf.ths013 != '' " >
      and ts.THS013 = #{thsPlf.ths013,jdbcType=VARCHAR}
    </if>
    <if test="thsPlf.ths014 != null and thsPlf.ths014 != '' " >
      and ts.THS014 is not null
    </if>
    <if test="thsPlf.ths015 != null and thsPlf.ths015 != '' " >
      and ts.THS015 is not null
    </if>
    <if test="thsPlf.ths016 != null and thsPlf.ths016 != '' " >
      and ts.THS016 is not null
    </if>
    <if test="thsPlf.isnew != null and thsPlf.isnew != '' " >
      and ts.ISNEW = #{thsPlf.isnew,jdbcType=VARCHAR}
    </if>
    <if test="thsPlf.aab301 != null and thsPlf.aab301 !='' " >
      and   plf.AAB301 like #{thsPlf.aab301,jdbcType=VARCHAR}
    </if>
    <if test="thsPlf.plf004 != null and thsPlf.plf004 !='' " >
      and  plf.PLF004 like #{thsPlf.plf004,jdbcType=VARCHAR}
    </if>
    <if test="thsPlf.plf005 != null and thsPlf.plf005 !='' " >
      and plf.PLF005 = #{thsPlf.plf005,jdbcType=VARCHAR}
    </if>
    <if test="thsPlf.plf006 != null and thsPlf.plf006 !='' " >
      and plf.PLF006 = #{thsPlf.plf006,jdbcType=VARCHAR}
    </if>
    <if test="thsPlf.plf007 != null and thsPlf.plf007 !='' " >
      and plf.PLF007 = #{thsPlf.plf007,jdbcType=VARCHAR}
    </if>
    <if test="thsPlf.startage != null and thsPlf.startage !='' " >
      and plf.PLF008 >= #{thsPlf.startage,jdbcType=VARCHAR}
    </if>
    <if test="thsPlf.endage != null and thsPlf.endage !='' " >
      and plf.PLF008 &lt; #{thsPlf.endage,jdbcType=VARCHAR}
    </if>
    <if test="thsPlf.plf009 != null and thsPlf.plf009 !='' " >
      and plf.PLF009 = #{thsPlf.plf009,jdbcType=VARCHAR}
    </if>
    <if test="thsPlf.plf010 != null and thsPlf.plf010 !='' " >
      and plf.PLF010 = #{thsPlf.plf010,jdbcType=VARCHAR}
    </if>
    <if test="thsPlf.plf011 != null and thsPlf.plf011 !='' " >
      and plf.PLF011 = #{thsPlf.plf011,jdbcType=VARCHAR}
    </if>
    <if test="thsPlf.plf012 != null and thsPlf.plf012 !='' " >
      and plf.PLF012 = #{thsPlf.plf012,jdbcType=VARCHAR}
    </if>
    <if test="thsPlf.plf013 != null and thsPlf.plf013 !='' " >
      and plf.PLF013 = #{thsPlf.plf013,jdbcType=VARCHAR}
    </if>
    <if test="thsPlf.plf014 != null and thsPlf.plf014 !='' " >
      and  plf.PLF014 = #{thsPlf.plf014,jdbcType=VARCHAR}
    </if>
    <if test="thsPlf.plf016 != null and thsPlf.plf016 !='' " >
      and plf.PLF016 = #{thsPlf.plf016,jdbcType=VARCHAR}
    </if>
    <if test="thsPlf.plf015 != null and thsPlf.plf015 !='' " >
      and plf.PLF015 = #{thsPlf.plf015,jdbcType=VARCHAR}
    </if>
    <if test="thsPlf.plf017 != null and thsPlf.plf017 !='' " >
      and  plf.PLF017 = #{thsPlf.plf017,jdbcType=VARCHAR}
    </if>
    <if test="thsPlf.plf018 != null and thsPlf.plf018 !='' " >
      and  plf.PLF018 = #{thsPlf.plf018,jdbcType=VARCHAR}
    </if>

    <if test="thsPlf.plf023 != null and thsPlf.plf023 !='' " >
      and  plf.PLF023 = #{thsPlf.plf023,jdbcType=VARCHAR}
    </if>
    <if test="thsPlf.plf024 != null and thsPlf.plf024 !='' " >
      and plf.PLF024 = #{thsPlf.plf024,jdbcType=VARCHAR}
    </if>
    <if test="thsPlf.phd013 != null and thsPlf.phd013 !='' " >
      and ts.PHD013 = #{thsPlf.phd013,jdbcType=VARCHAR}
    </if>
    <if test="thsPlf.phd014 != null and thsPlf.phd014 !='' " >
      and ts.phd014 = #{thsPlf.phd014,jdbcType=VARCHAR}
    </if>
    <if test="thsPlf.phd014_19 != null and thsPlf.phd014_19 !='' " >
      and ts.phd014_19 = #{thsPlf.phd014_19,jdbcType=VARCHAR}
    </if>
    ) a1
    where sn=1 and rownum &lt;= #{pageSize})
    where rn &gt;= #{startRecord}
  </select>

  <!--查询所有多少个  根据行政区划   查询台账信息-->
    <!-- <if test="thsPlf.showscope != null and thsPlf.showscope !='' ">
        and plf.plf018 in ('01','02')     and plf.ispoor='1'  and plf.plf025='0' and plf.plf015 ='0'
      </if>-->
  <select id="queryAllTechnicalSchoolByAab301" resultType="java.lang.String" parameterType="java.lang.String" >
    select count(1) from (
    select  row_number() over(partition by ts.ths002   order by ths005   desc) as sn
    from  technical_schools ts left join  poor_labor_force plf  on ts.ths002 = plf.plf001
    where  ts.aae100='1'  and plf.aae100='1'
    /*待完善条件 THS005 入学日期 不能为空*/
    <if test="thsPlf.istobecomplete != null  and thsPlf.istobecomplete !='' ">
      and ts.THS005 is null
    </if>
    <if test="thsPlf.showscope != null  and thsPlf.showscope==1 ">
        and (ths006 is null or to_date(ths006,'yyyy-mm-dd')>sysdate)
    </if>
    <if test="thsPlf.showscope != null  and thsPlf.showscope==2 ">
        and ths006 is not null and sysdate>to_date(ths006,'yyyy-mm-dd')
    </if>
      <if test="thsPlf.helpyear != null and thsPlf.helpyear !='' ">
          and   substr(ts.THS005,0,4) = #{thsPlf.helpyear,jdbcType=VARCHAR}
      </if>
     <!-- <if test='thsPlf.isnoduty != null and thsPlf.isnoduty =="1" '>
          and  ts.THS006 is  null
      </if>
      <if test='thsPlf.isnoduty != null and thsPlf.isnoduty =="0" '>
          and  ts.THS006 is  not null
      </if>-->
    <if test="thsPlf.ths003 != null and thsPlf.ths003 != '' " >
      and ts.THS003 = #{thsPlf.ths003,jdbcType=VARCHAR}
    </if>
    <if test="thsPlf.ths004 != null and thsPlf.ths004 != '' " >
      and ts.THS004 = #{thsPlf.ths004,jdbcType=VARCHAR}
    </if>
    <if test="thsPlf.ths005 != null and thsPlf.ths005 != '' " >
      and ts.THS005 = #{thsPlf.ths005,jdbcType=VARCHAR}
    </if>
    <if test="thsPlf.ths006 != null and thsPlf.ths006 != '' " >
      and ts.THS006 = #{thsPlf.ths006,jdbcType=VARCHAR}
    </if>
    <if test="thsPlf.ths007 != null and thsPlf.ths007 != '' " >
      and ts.THS007 = #{thsPlf.ths007,jdbcType=VARCHAR}
    </if>
    <if test="thsPlf.ths008 != null and thsPlf.ths008 != '' " >
      and ts.THS008 = #{thsPlf.ths008,jdbcType=VARCHAR}
    </if>
    <if test="thsPlf.ths009 != null and thsPlf.ths009 != '' " >
      and ts.THS009 = #{thsPlf.ths009,jdbcType=VARCHAR}
    </if>
    <if test="thsPlf.ths010 != null and thsPlf.ths010 != '' " >
      and ts.THS010 = #{thsPlf.ths010,jdbcType=VARCHAR}
    </if>
    <if test="thsPlf.ths011 != null and thsPlf.ths011 != '' " >
      and ts.THS011 = #{thsPlf.ths011,jdbcType=VARCHAR}
    </if>
    <if test="thsPlf.ths012 != null and thsPlf.ths012 != '' " >
      and ts.THS012 = #{thsPlf.ths012,jdbcType=VARCHAR}
    </if>
    <if test="thsPlf.aae036 != null and thsPlf.aae036 != '' " >
      and ts.AAE036 = #{thsPlf.aae036,jdbcType=TIMESTAMP}
    </if>
    <if test="thsPlf.aae011 != null and thsPlf.aae011 != '' " >
      and ts.AAE011 = #{thsPlf.aae011,jdbcType=VARCHAR}
    </if>
    <if test="thsPlf.ths002 != null and thsPlf.ths002 != '' " >
      and ts.THS002 = #{thsPlf.ths002,jdbcType=VARCHAR}
    </if>
    <if test="thsPlf.datasource != null and thsPlf.datasource != '' " >
      and ts.DATASOURCE = #{thsPlf.datasource,jdbcType=VARCHAR}
    </if>
    <if test="thsPlf.aae100 != null and thsPlf.aae100 != '' " >
      and ts.AAE100 = #{thsPlf.aae100,jdbcType=VARCHAR}
    </if>
    <if test="thsPlf.updatedate != null and thsPlf.updatedate != '' " >
      and ts.UPDATEDATE = #{thsPlf.updatedate,jdbcType=TIMESTAMP}
    </if>
    <if test="thsPlf.updateby != null and thsPlf.updateby != '' " >
      and ts.UPDATEBY = #{thsPlf.updateby,jdbcType=VARCHAR}
    </if>
    <if test="thsPlf.createby != null and thsPlf.createby != '' " >
      and ts.CREATEBY = #{thsPlf.createby,jdbcType=VARCHAR}
    </if>
    <if test="thsPlf.aae012 != null and thsPlf.aae012 != '' " >
      and ts.AAE012 = #{thsPlf.aae012,jdbcType=VARCHAR}
    </if>
    <if test="thsPlf.ths013 != null and thsPlf.ths013 != '' " >
      and ts.THS013 = #{thsPlf.ths013,jdbcType=VARCHAR}
    </if>
    <if test="thsPlf.ths014 != null and thsPlf.ths014 != '' " >
      and ts.THS014 is not null
    </if>
    <if test="thsPlf.ths015 != null and thsPlf.ths015 != '' " >
      and ts.THS015 is not null
    </if>
    <if test="thsPlf.ths016 != null and thsPlf.ths016 != '' " >
      and ts.THS016 is not null
    </if>
    <if test="thsPlf.isnew != null and thsPlf.isnew != '' " >
      and ts.ISNEW = #{thsPlf.isnew,jdbcType=VARCHAR}
    </if>
    <if test="thsPlf.aab301 != null and thsPlf.aab301 !='' " >
      and   plf.AAB301 like #{thsPlf.aab301,jdbcType=VARCHAR}
    </if>
    <if test="thsPlf.plf004 != null and thsPlf.plf004 !='' " >
      and  plf.PLF004 like #{thsPlf.plf004,jdbcType=VARCHAR}
    </if>
    <if test="thsPlf.plf005 != null and thsPlf.plf005 !='' " >
      and plf.PLF005 = #{thsPlf.plf005,jdbcType=VARCHAR}
    </if>
    <if test="thsPlf.plf006 != null and thsPlf.plf006 !='' " >
      and plf.PLF006 = #{thsPlf.plf006,jdbcType=VARCHAR}
    </if>
    <if test="thsPlf.plf007 != null and thsPlf.plf007 !='' " >
      and plf.PLF007 = #{thsPlf.plf007,jdbcType=VARCHAR}
    </if>
    <if test="thsPlf.startage != null and thsPlf.startage !='' " >
      and plf.PLF008 >= #{thsPlf.startage,jdbcType=VARCHAR}
    </if>
    <if test="thsPlf.endage != null and thsPlf.endage !='' " >
      and plf.PLF008 &lt; #{thsPlf.endage,jdbcType=VARCHAR}
    </if>
    <if test="thsPlf.plf009 != null and thsPlf.plf009 !='' " >
      and plf.PLF009 = #{thsPlf.plf009,jdbcType=VARCHAR}
    </if>
    <if test="thsPlf.plf010 != null and thsPlf.plf010 !='' " >
      and plf.PLF010 = #{thsPlf.plf010,jdbcType=VARCHAR}
    </if>
    <if test="thsPlf.plf011 != null and thsPlf.plf011 !='' " >
      and plf.PLF011 = #{thsPlf.plf011,jdbcType=VARCHAR}
    </if>
    <if test="thsPlf.plf012 != null and thsPlf.plf012 !='' " >
      and plf.PLF012 = #{thsPlf.plf012,jdbcType=VARCHAR}
    </if>
    <if test="thsPlf.plf013 != null and thsPlf.plf013 !='' " >
      and plf.PLF013 = #{thsPlf.plf013,jdbcType=VARCHAR}
    </if>
    <if test="thsPlf.plf014 != null and thsPlf.plf014 !='' " >
      and  plf.PLF014 = #{thsPlf.plf014,jdbcType=VARCHAR}
    </if>
    <if test="thsPlf.plf016 != null and thsPlf.plf016 !='' " >
      and plf.PLF016 = #{thsPlf.plf016,jdbcType=VARCHAR}
    </if>
    <if test="thsPlf.plf015 != null and thsPlf.plf015 !='' " >
      and plf.PLF015 = #{thsPlf.plf015,jdbcType=VARCHAR}
    </if>
    <if test="thsPlf.plf017 != null and thsPlf.plf017 !='' " >
      and  plf.PLF017 = #{thsPlf.plf017,jdbcType=VARCHAR}
    </if>
    <if test="thsPlf.plf018 != null and thsPlf.plf018 !='' " >
      and  plf.PLF018 = #{thsPlf.plf018,jdbcType=VARCHAR}
    </if>
    <if test="thsPlf.plf023 != null and thsPlf.plf023 !='' " >
      and  plf.PLF023 = #{thsPlf.plf023,jdbcType=VARCHAR}
    </if>
    <if test="thsPlf.plf024 != null and thsPlf.plf024 !='' " >
      and plf.PLF024 = #{thsPlf.plf024,jdbcType=VARCHAR}
    </if>
    <if test="thsPlf.phd013 != null and thsPlf.phd013 !='' " >
      and ts.PHD013 = #{thsPlf.phd013,jdbcType=VARCHAR}
    </if>
    <if test="thsPlf.phd014 != null and thsPlf.phd014 !='' " >
      and ts.phd014 = #{thsPlf.phd014,jdbcType=VARCHAR}
    </if>
    <if test="thsPlf.phd014_19 != null and thsPlf.phd014_19 !='' " >
      and ts.phd014_19 = #{thsPlf.phd014_19,jdbcType=VARCHAR}
    </if>
      ) where sn=1
  </select>


  <!--根据劳动力id  查询最新的技工院校信息-->
  <select id="queryNewTechnicalSchools" resultMap="BaseResultMap" parameterType="java.lang.String" >
    select ths001,ths002,ths005 from
    (select s.ths001,ths002,ths005,row_number() over(partition by s.ths002 order by ths005 desc) as sn from technical_schools s where  s.aae100='1' and s.ths002 = #{ths002})
    where sn=1
  </select>

</mapper>