<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.tdkj.dao.InformationCollection.EmploymentSituationMapper" >
  <resultMap id="BaseResultMap" type="com.tdkj.model.EmploymentSituation" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    <id column="EYS001" property="eys001" jdbcType="VARCHAR" />
    <result column="EYS002" property="eys002" jdbcType="VARCHAR" />
    <result column="EYS003" property="eys003" jdbcType="VARCHAR" />
    <result column="EYS004" property="eys004" jdbcType="VARCHAR" />
    <result column="EYS005" property="eys005" jdbcType="VARCHAR" />
    <result column="EYS006" property="eys006" jdbcType="VARCHAR" />
    <result column="EYS007" property="eys007" jdbcType="VARCHAR" />
    <result column="EYS008" property="eys008" jdbcType="VARCHAR" />
    <result column="EYS009" property="eys009" jdbcType="VARCHAR" />
    <result column="EYS010" property="eys010" jdbcType="VARCHAR" />
    <result column="EYS011" property="eys011" jdbcType="VARCHAR" />
    <result column="EYS012" property="eys012" jdbcType="VARCHAR" />
    <result column="EYS013" property="eys013" jdbcType="VARCHAR" />
    <result column="EYS014" property="eys014" jdbcType="VARCHAR" />
    <result column="AAB301" property="aab301" jdbcType="VARCHAR" />
    <result column="AAE011" property="aae011" jdbcType="VARCHAR" />
    <result column="AAE036" property="aae036" jdbcType="TIMESTAMP" />
    <result column="EYS015" property="eys015" jdbcType="VARCHAR" />
    <result column="EYS016" property="eys016" jdbcType="VARCHAR" />
    <result column="EYS017" property="eys017" jdbcType="VARCHAR" />
    <result column="EYS018" property="eys018" jdbcType="VARCHAR" />
    <result column="EYS019" property="eys019" jdbcType="VARCHAR" />
    <result column="EYS020" property="eys020" jdbcType="VARCHAR" />
    <result column="EYS021" property="eys021" jdbcType="VARCHAR" />
    <result column="EYS022" property="eys022" jdbcType="VARCHAR" />
    <result column="EYS023" property="eys023" jdbcType="VARCHAR" />
    <result column="EYS024" property="eys024" jdbcType="VARCHAR" />
    <result column="DATASOURCE" property="datasource" jdbcType="VARCHAR" />
    <result column="AAE100" property="aae100" jdbcType="VARCHAR" />
    <result column="UPDATEDATE" property="updatedate" jdbcType="TIMESTAMP" />
    <result column="UPDATEBY" property="updateby" jdbcType="VARCHAR" />
    <result column="CREATEBY" property="createby" jdbcType="VARCHAR" />
    <result column="AAE012" property="aae012" jdbcType="VARCHAR" />
    <result column="ISNEW" property="isnew" jdbcType="VARCHAR" />
    <result column="DELETEBY" property="deleteby" jdbcType="VARCHAR" />
    <result column="DELETEDATE" property="deletedate" jdbcType="TIMESTAMP" />

  </resultMap>

  <resultMap id="EysPlfResultMap" type="com.tdkj.model.EysPlf" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    <id column="EYS001" property="eys001" jdbcType="VARCHAR" />
    <result column="EYS002" property="eys002" jdbcType="VARCHAR" />
    <result column="EYS003" property="eys003" jdbcType="VARCHAR" />
    <result column="EYS004" property="eys004" jdbcType="VARCHAR" />
    <result column="EYS005" property="eys005" jdbcType="VARCHAR" />
    <result column="EYS006" property="eys006" jdbcType="VARCHAR" />
    <result column="EYS007" property="eys007" jdbcType="VARCHAR" />
    <result column="EYS008" property="eys008" jdbcType="VARCHAR" />
    <result column="EYS009" property="eys009" jdbcType="VARCHAR" />
    <result column="EYS010" property="eys010" jdbcType="VARCHAR" />
    <result column="EYS011" property="eys011" jdbcType="VARCHAR" />
    <result column="EYS012" property="eys012" jdbcType="VARCHAR" />
    <result column="EYS013" property="eys013" jdbcType="VARCHAR" />
    <result column="EYS014" property="eys014" jdbcType="VARCHAR" />
    <result column="AAB301" property="aab301" jdbcType="VARCHAR" />
    <result column="AAE011" property="aae011" jdbcType="VARCHAR" />
    <result column="AAE036" property="aae036" jdbcType="TIMESTAMP" />
    <result column="EYS015" property="eys015" jdbcType="VARCHAR" />
    <result column="EYS016" property="eys016" jdbcType="VARCHAR" />
    <result column="EYS017" property="eys017" jdbcType="VARCHAR" />
    <result column="EYS018" property="eys018" jdbcType="VARCHAR" />
    <result column="EYS019" property="eys019" jdbcType="VARCHAR" />
    <result column="EYS020" property="eys020" jdbcType="VARCHAR" />
    <result column="EYS021" property="eys021" jdbcType="VARCHAR" />
    <result column="EYS022" property="eys022" jdbcType="VARCHAR" />
    <result column="EYS023" property="eys023" jdbcType="VARCHAR" />
    <result column="EYS024" property="eys024" jdbcType="VARCHAR" />
    <result column="DATASOURCE" property="datasource" jdbcType="VARCHAR" />
    <result column="AAE100" property="aae100" jdbcType="VARCHAR" />
    <result column="UPDATEDATE" property="updatedate" jdbcType="TIMESTAMP" />
    <result column="UPDATEBY" property="updateby" jdbcType="VARCHAR" />
    <result column="CREATEBY" property="createby" jdbcType="VARCHAR" />
    <result column="AAE012" property="aae012" jdbcType="VARCHAR" />
    <result column="ISNEW" property="isnew" jdbcType="VARCHAR" />

    <result column="PLF001" property="plf001" jdbcType="VARCHAR" />
    <result column="PLF002" property="plf002" jdbcType="VARCHAR" />
    <result column="PLF004" property="plf004" jdbcType="VARCHAR" />
    <result column="PLF005" property="plf005" jdbcType="VARCHAR" />
    <result column="PLF006" property="plf006" jdbcType="VARCHAR" />
    <result column="PLF007" property="plf007" jdbcType="VARCHAR" />
    <result column="PLF008" property="plf008" jdbcType="VARCHAR" />
    <result column="PLF009" property="plf009" jdbcType="VARCHAR" />
    <result column="PLF010" property="plf010" jdbcType="VARCHAR" />
    <result column="PLF011" property="plf011" jdbcType="VARCHAR" />
    <result column="PLF012" property="plf012" jdbcType="VARCHAR" />
    <result column="PLF013" property="plf013" jdbcType="VARCHAR" />
    <result column="PLF014" property="plf014" jdbcType="VARCHAR" />
    <result column="AAE011" property="aae011" jdbcType="VARCHAR" />
    <result column="AAE036" property="aae036" jdbcType="TIMESTAMP" />
    <result column="PLF016" property="plf016" jdbcType="VARCHAR" />
    <result column="PLF015" property="plf015" jdbcType="VARCHAR" />
    <result column="PLF017" property="plf017" jdbcType="VARCHAR" />
    <result column="PLF018" property="plf018" jdbcType="VARCHAR" />
    <result column="PLF019" property="plf019" jdbcType="VARCHAR" />
    <result column="PLF020" property="plf020" jdbcType="VARCHAR" />
    <result column="PLF021" property="plf021" jdbcType="VARCHAR" />
    <result column="PLF022" property="plf022" jdbcType="VARCHAR" />
    <result column="PLF023" property="plf023" jdbcType="VARCHAR" />
    <result column="PLF024" property="plf024" jdbcType="VARCHAR" />
    <result column="DELETEBY" property="deleteby" jdbcType="VARCHAR" />
    <result column="DELETEDATE" property="deletedate" jdbcType="TIMESTAMP" />

  </resultMap>
  <sql id="Base_Column_List" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    EYS001, EYS002, EYS003, EYS004, EYS005, EYS006, EYS007, EYS008, EYS009, EYS010, EYS011,
    EYS012, EYS013, EYS014, EYS015, EYS016, EYS017, EYS018, EYS019,EYS020,EYS021,EYS022,EYS023,EYS024,
     EYS016,AAB301, AAE011, AAE036, DATASOURCE,AAE100,UPDATEDATE,UPDATEBY,CREATEBY,AAE012,ISNEW,DELETEBY,DELETEDATE
  </sql>
  <select id="selectByPrimaryKey" resultMap="BaseResultMap" parameterType="java.lang.String" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    select 
    <include refid="Base_Column_List" />
    from employment_situation
    where EYS001 = #{eys001,jdbcType=VARCHAR}
  </select>
  <!--<delete id="deleteByPrimaryKey" parameterType="java.lang.String" >
    &lt;!&ndash;
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    &ndash;&gt;
    delete from employment_situation
    where EYS001 = #{eys001,jdbcType=VARCHAR}
  </delete>-->

  <update id="deleteByPrimaryKey" parameterType="java.lang.String" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    update  employment_situation set aae100='0'
    where EYS001 = #{eys001,jdbcType=VARCHAR}
  </update>

  <!--根据劳动力id 修改是否最新字段-->
  <update id="updateIsNewByEys002" parameterType="java.lang.String" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    update  employment_situation set isnew='0'
    where EYS002 = #{eys002,jdbcType=VARCHAR}
  </update>

  <insert id="insert" parameterType="com.tdkj.model.EmploymentSituation" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    insert into employment_situation (EYS001, EYS002, EYS003,
      EYS004, EYS005, EYS006, 
      EYS007, EYS008, EYS009, 
      EYS010, EYS011, EYS012, 
      EYS013, EYS014,EYS016, AAB301,
      AAE011, AAE036, EYS015,EYS017, EYS018, EYS019,EYS020,EYS021,EYS022,EYS023,EYS024,DATASOURCE,AAE100,UPDATEDATE,UPDATEBY,CREATEBY,AAE012,ISNEW,DELETEBY,DELETEDATE
      )
    values (#{eys001,jdbcType=VARCHAR}, #{eys002,jdbcType=VARCHAR}, #{eys003,jdbcType=VARCHAR},
      #{eys004,jdbcType=VARCHAR}, #{eys005,jdbcType=VARCHAR}, #{eys006,jdbcType=VARCHAR}, 
      #{eys007,jdbcType=VARCHAR}, #{eys008,jdbcType=VARCHAR}, #{eys009,jdbcType=VARCHAR},
      #{eys010,jdbcType=VARCHAR}, #{eys011,jdbcType=VARCHAR}, #{eys012,jdbcType=VARCHAR},
      #{eys013,jdbcType=VARCHAR}, #{eys014,jdbcType=VARCHAR}, #{eys016,jdbcType=VARCHAR}, #{aab301,jdbcType=VARCHAR},
      #{aae011,jdbcType=VARCHAR}, #{aae036,jdbcType=TIMESTAMP}, #{eys015,jdbcType=VARCHAR},
      #{eys017,jdbcType=VARCHAR}, #{eys018,jdbcType=VARCHAR}, #{eys019,jdbcType=VARCHAR}, #{eys020,jdbcType=VARCHAR},
      #{eys021,jdbcType=VARCHAR},#{eys022,jdbcType=VARCHAR},#{eys023,jdbcType=VARCHAR},#{eys024,jdbcType=VARCHAR},
      #{datasource,jdbcType=VARCHAR},#{aae100,jdbcType=VARCHAR},#{updatedate,jdbcType=TIMESTAMP},#{updateby,jdbcType=VARCHAR},
    #{createby,jdbcType=VARCHAR},#{aae012,jdbcType=VARCHAR},#{isnew,jdbcType=VARCHAR},#{deleteby,jdbcType=VARCHAR},#{deletedate,jdbcType=TIMESTAMP}
      )
  </insert>


    <insert id="addList" parameterType="java.util.List" useGeneratedKeys="false">
        INSERT INTO employment_situation

        (EYS001, EYS002, EYS003,
        EYS004, EYS005, EYS006,
        EYS007, EYS008, EYS009,
        EYS010, EYS011, EYS012,
        EYS013, EYS014,EYS016, AAB301,
        AAE011, AAE036, EYS015,EYS017, EYS018, EYS019,EYS020,EYS021,EYS022,EYS023,EYS024,DATASOURCE,AAE100,UPDATEDATE,UPDATEBY,CREATEBY,AAE012,ISNEW,DELETEBY,DELETEDATE)

        <foreach item="bean" index="index" collection="list" separator="union all">
            (

            select #{bean.eys001,jdbcType=VARCHAR}, #{bean.eys002,jdbcType=VARCHAR}, #{bean.eys003,jdbcType=VARCHAR},
            #{bean.eys004,jdbcType=VARCHAR}, #{bean.eys005,jdbcType=VARCHAR}, #{bean.eys006,jdbcType=VARCHAR},
            #{bean.eys007,jdbcType=VARCHAR}, #{bean.eys008,jdbcType=VARCHAR}, #{bean.eys009,jdbcType=VARCHAR},
            #{bean.eys010,jdbcType=VARCHAR}, #{bean.eys011,jdbcType=VARCHAR}, #{bean.eys012,jdbcType=VARCHAR},
            #{bean.eys013,jdbcType=VARCHAR}, #{bean.eys014,jdbcType=VARCHAR}, #{bean.eys016,jdbcType=VARCHAR}, #{bean.aab301,jdbcType=VARCHAR},
            #{bean.aae011,jdbcType=VARCHAR}, #{bean.aae036,jdbcType=TIMESTAMP}, #{bean.eys015,jdbcType=VARCHAR},
            #{bean.eys017,jdbcType=VARCHAR}, #{bean.eys018,jdbcType=VARCHAR}, #{bean.eys019,jdbcType=VARCHAR}, #{bean.eys020,jdbcType=VARCHAR},
            #{bean.eys021,jdbcType=VARCHAR},#{bean.eys022,jdbcType=VARCHAR},#{bean.eys023,jdbcType=VARCHAR},#{bean.eys024,jdbcType=VARCHAR},
            #{bean.datasource,jdbcType=VARCHAR},#{bean.aae100,jdbcType=VARCHAR},#{bean.updatedate,jdbcType=TIMESTAMP},#{bean.updateby,jdbcType=VARCHAR},
            #{bean.createby,jdbcType=VARCHAR},#{bean.aae012,jdbcType=VARCHAR},#{bean.isnew,jdbcType=VARCHAR},#{bean.deleteby,jdbcType=VARCHAR},#{bean.deletedate,jdbcType=TIMESTAMP}
            from dual

            )
        </foreach>
    </insert>

  <insert id="insertSelective" parameterType="com.tdkj.model.EmploymentSituation" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    insert into employment_situation
    <trim prefix="(" suffix=")" suffixOverrides="," >
      <if test="eys001 != null" >
        EYS001,
      </if>
      <if test="eys002 != null" >
        EYS002,
      </if>
      <if test="eys003 != null" >
        EYS003,
      </if>
      <if test="eys004 != null" >
        EYS004,
      </if>
      <if test="eys005 != null" >
        EYS005,
      </if>
      <if test="eys006 != null" >
        EYS006,
      </if>
      <if test="eys007 != null" >
        EYS007,
      </if>
      <if test="eys008 != null" >
        EYS008,
      </if>
      <if test="eys009 != null" >
        EYS009,
      </if>
      <if test="eys010 != null" >
        EYS010,
      </if>
      <if test="eys011 != null" >
        EYS011,
      </if>
      <if test="eys012 != null" >
        EYS012,
      </if>
      <if test="eys013 != null" >
        EYS013,
      </if>
      <if test="eys014 != null" >
        EYS014,
      </if>
      <if test="eys016 != null" >
        EYS016,
      </if>
      <if test="eys017 != null" >
        EYS017,
      </if>
      <if test="eys018 != null" >
        EYS018,
      </if>
      <if test="eys019 != null" >
        EYS019,
      </if>
      <if test="eys020 != null" >
        EYS020,
      </if>
      <if test="eys021 != null" >
        EYS021,
      </if>
      <if test="eys022 != null" >
        EYS022,
      </if>
      <if test="eys023 != null" >
        EYS023,
      </if>
      <if test="eys024 != null" >
        EYS024,
      </if>
      <if test="aab301 != null" >
        AAB301,
      </if>
      <if test="aae011 != null" >
        AAE011,
      </if>
      <if test="aae036 != null" >
        AAE036,
      </if>
      <if test="eys015 != null" >
        EYS015,
      </if>
      <if test="datasource != null" >
        DATASOURCE,
      </if>
      <if test="aae100 != null" >
        AAE100,
      </if>
      <if test="updatedate != null" >
        UPDATEDATE,
      </if>
      <if test="updateby != null" >
        UPDATEBY,
      </if>
      <if test="createby != null" >
        CREATEBY,
      </if>
      <if test="aae012 != null" >
        AAE012,
      </if>
      <if test="isnew != null" >
        ISNEW,
      </if>
      <if test="deleteby != null" >
        DELETEBY,
      </if>
      <if test="deletedate != null" >
        DELETEDATE,
      </if>
    </trim>
    <trim prefix="values (" suffix=")" suffixOverrides="," >
      <if test="eys001 != null" >
        #{eys001,jdbcType=VARCHAR},
      </if>
      <if test="eys002 != null" >
        #{eys002,jdbcType=VARCHAR},
      </if>
      <if test="eys003 != null" >
        #{eys003,jdbcType=VARCHAR},
      </if>
      <if test="eys004 != null" >
        #{eys004,jdbcType=VARCHAR},
      </if>
      <if test="eys005 != null" >
        #{eys005,jdbcType=VARCHAR},
      </if>
      <if test="eys006 != null" >
        #{eys006,jdbcType=VARCHAR},
      </if>
      <if test="eys007 != null" >
        #{eys007,jdbcType=VARCHAR},
      </if>
      <if test="eys008 != null" >
        #{eys008,jdbcType=VARCHAR},
      </if>
      <if test="eys009 != null" >
        #{eys009,jdbcType=VARCHAR},
      </if>
      <if test="eys010 != null" >
        #{eys010,jdbcType=VARCHAR},
      </if>
      <if test="eys011 != null" >
        #{eys011,jdbcType=VARCHAR},
      </if>
      <if test="eys012 != null" >
        #{eys012,jdbcType=VARCHAR},
      </if>
      <if test="eys013 != null" >
        #{eys013,jdbcType=VARCHAR},
      </if>
      <if test="eys014 != null" >
        #{eys014,jdbcType=VARCHAR},
      </if>

      <if test="eys016 != null" >
        #{eys016,jdbcType=VARCHAR},
      </if>
      <if test="eys017 != null" >
        #{eys017,jdbcType=VARCHAR},
      </if>
      <if test="eys018 != null" >
        #{eys018,jdbcType=VARCHAR},
      </if>
      <if test="eys019 != null" >
        #{eys019,jdbcType=VARCHAR},
      </if>
      <if test="eys020 != null" >
        #{eys020,jdbcType=VARCHAR},
      </if>
      <if test="eys021 != null" >
        #{eys021,jdbcType=VARCHAR},
      </if>
      <if test="eys022 != null" >
        #{eys022,jdbcType=VARCHAR},
      </if>
      <if test="eys023 != null" >
        #{eys023,jdbcType=VARCHAR},
      </if>
      <if test="eys024 != null" >
        #{eys024,jdbcType=VARCHAR},
      </if>
      <if test="aab301 != null" >
        #{aab301,jdbcType=VARCHAR},
      </if>
      <if test="aae011 != null" >
        #{aae011,jdbcType=VARCHAR},
      </if>
      <if test="aae036 != null" >
        #{aae036,jdbcType=TIMESTAMP},
      </if>
      <if test="eys015 != null" >
        #{eys015,jdbcType=VARCHAR},
      </if>
      <if test="datasource != null" >
        #{datasource,jdbcType=VARCHAR},
      </if>
      <if test="aae100 != null" >
        #{aae100,jdbcType=VARCHAR},
      </if>
      <if test="updatedate != null" >
        #{updatedate,jdbcType=TIMESTAMP},
      </if>
      <if test="updateby != null" >
        #{updateby,jdbcType=VARCHAR},
      </if>
      <if test="createby != null" >
        #{createby,jdbcType=VARCHAR},
      </if>
      <if test="aae012 != null" >
        #{aae012,jdbcType=VARCHAR},
      </if>
      <if test="isnew != null" >
        #{isnew,jdbcType=VARCHAR},
      </if>
      <if test="deleteby != null" >
        #{deleteby,jdbcType=VARCHAR},
      </if>
      <if test="deletedate != null" >
        #{deletedate,jdbcType=TIMESTAMP},
      </if>
    </trim>
  </insert>
  <update id="updateByPrimaryKeySelective" parameterType="com.tdkj.model.EmploymentSituation" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    update employment_situation
    <set >
      <if test="eys002 != null" >
        EYS002 = #{eys002,jdbcType=VARCHAR},
      </if>
      <if test="eys003 != null" >
        EYS003 = #{eys003,jdbcType=VARCHAR},
      </if>
      <if test="eys004 != null" >
        EYS004 = #{eys004,jdbcType=VARCHAR},
      </if>
      <if test="eys005 != null" >
        EYS005 = #{eys005,jdbcType=VARCHAR},
      </if>
      <if test="eys006 != null" >
        EYS006 = #{eys006,jdbcType=VARCHAR},
      </if>
      <if test="eys007 != null" >
        EYS007 = #{eys007,jdbcType=VARCHAR},
      </if>
      <if test="eys008 != null" >
        EYS008 = #{eys008,jdbcType=VARCHAR},
      </if>
      <if test="eys009 != null" >
        EYS009 = #{eys009,jdbcType=VARCHAR},
      </if>
      <if test="eys010 != null" >
        EYS010 = #{eys010,jdbcType=VARCHAR},
      </if>
      <if test="eys011 != null" >
        EYS011 = #{eys011,jdbcType=VARCHAR},
      </if>
      <if test="eys012 != null" >
        EYS012 = #{eys012,jdbcType=VARCHAR},
      </if>
      <if test="eys013 != null" >
        EYS013 = #{eys013,jdbcType=VARCHAR},
      </if>
      <if test="eys014 != null" >
        EYS014 = #{eys014,jdbcType=VARCHAR},
      </if>

      <if test="eys016 != null" >
        EYS016 = #{eys016,jdbcType=VARCHAR},
      </if>
      <if test="eys017 != null" >
        EYS017 = #{eys017,jdbcType=VARCHAR},
      </if>
      <if test="eys018 != null" >
        EYS018 = #{eys018,jdbcType=VARCHAR},
      </if>
      <if test="eys019 != null" >
        EYS019 = #{eys019,jdbcType=VARCHAR},
      </if>
      <if test="eys020 != null" >
        EYS020 = #{eys020,jdbcType=VARCHAR},
      </if>
      <if test="eys021 != null" >
        EYS021 = #{eys021,jdbcType=VARCHAR},
      </if>
      <if test="eys022 != null" >
        EYS022 = #{eys022,jdbcType=VARCHAR},
      </if>
      <if test="eys023 != null" >
        EYS023 = #{eys023,jdbcType=VARCHAR},
      </if>
      <if test="eys024 != null" >
        EYS024 = #{eys024,jdbcType=VARCHAR},
      </if>
      <if test="aab301 != null" >
        AAB301 = #{aab301,jdbcType=VARCHAR},
      </if>
      <if test="aae011 != null" >
        AAE011 = #{aae011,jdbcType=VARCHAR},
      </if>
      <if test="aae036 != null" >
        AAE036 = #{aae036,jdbcType=TIMESTAMP},
      </if>
      <if test="eys015 != null" >
        EYS015 = #{eys015,jdbcType=VARCHAR},
      </if>
      <if test="datasource != null" >
        DATASOURCE = #{datasource,jdbcType=VARCHAR},
      </if>
      <if test="aae100 != null" >
        AAE100 = #{aae100,jdbcType=VARCHAR},
      </if>
      <if test="updatedate != null" >
        UPDATEDATE = #{updatedate,jdbcType=TIMESTAMP},
      </if>
      <if test="updateby != null" >
        UPDATEBY = #{updateby,jdbcType=VARCHAR},
      </if>
      <if test="createby != null" >
        CREATEBY = #{createby,jdbcType=VARCHAR},
      </if>
      <if test="aae012 != null" >
        AAE012 = #{aae012,jdbcType=VARCHAR},
      </if>
      <if test="isnew != null" >
        ISNEW = #{isnew,jdbcType=VARCHAR},
      </if>
      <if test="deleteby != null" >
        DELETEBY = #{deleteby,jdbcType=VARCHAR},
      </if>
      <if test="deletedate != null" >
        DELETEDATE = #{deletedate,jdbcType=TIMESTAMP},
      </if>
    </set>
    where EYS001 = #{eys001,jdbcType=VARCHAR}
  </update>

  <update id="updateByPrimaryKey" parameterType="com.tdkj.model.EmploymentSituation" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    update employment_situation
    set eys002 = #{eys002,jdbcType=VARCHAR},
      EYS003 = #{eys003,jdbcType=VARCHAR},
      EYS004 = #{eys004,jdbcType=VARCHAR},
      EYS005 = #{eys005,jdbcType=VARCHAR},
      EYS006 = #{eys006,jdbcType=VARCHAR},
      EYS007 = #{eys007,jdbcType=VARCHAR},
      EYS008 = #{eys008,jdbcType=VARCHAR},
      EYS009 = #{eys009,jdbcType=VARCHAR},
      EYS010 = #{eys010,jdbcType=VARCHAR},
      EYS011 = #{eys011,jdbcType=VARCHAR},
      EYS012 = #{eys012,jdbcType=VARCHAR},
      EYS013 = #{eys013,jdbcType=VARCHAR},
      EYS014 = #{eys014,jdbcType=VARCHAR},
      EYS015 = #{eys015,jdbcType=VARCHAR},
      EYS016 = #{eys016,jdbcType=VARCHAR},
      EYS017 = #{eys017,jdbcType=VARCHAR},
      EYS018 = #{eys018,jdbcType=VARCHAR},
      EYS019 = #{eys019,jdbcType=VARCHAR},
      EYS020 = #{eys020,jdbcType=VARCHAR},
      EYS021 = #{eys021,jdbcType=VARCHAR},
      EYS022 = #{eys022,jdbcType=VARCHAR},
    EYS023 = #{eys023,jdbcType=VARCHAR},
    EYS024 = #{eys024,jdbcType=VARCHAR},
      AAB301 = #{aab301,jdbcType=VARCHAR},
      AAE011 = #{aae011,jdbcType=VARCHAR},
      AAE036 = #{aae036,jdbcType=TIMESTAMP},
    DATASOURCE = #{datasource,jdbcType=VARCHAR},
    AAE100 = #{aae100,jdbcType=VARCHAR},
    UPDATEDATE = #{updatedate,jdbcType=TIMESTAMP},
    UPDATEBY = #{updateby,jdbcType=VARCHAR},
    CREATEBY = #{createby,jdbcType=VARCHAR},
    AAE012 = #{aae012,jdbcType=VARCHAR},
    ISNEW = #{isnew,jdbcType=VARCHAR},
    DELETEBY = #{deleteby,jdbcType=VARCHAR},
    DELETEDATE = #{deletedate,jdbcType=TIMESTAMP}

    where EYS001 = #{eys001,jdbcType=VARCHAR}
  </update>

  <!--根据劳动力id 查询劳动力就业情况信息-->
  <select id="queryEmploymentSituationByEys002" resultMap="BaseResultMap" parameterType="java.lang.String" >
    select
     EYS001, EYS002,
     (select AAA103 from aa10 where aaa100='AAA013' AND AAA102=EYS003)EYS003,
      (select AAA103 from aa10 where aaa100='AAA006' AND AAA102=EYS004)EYS004,
      EYS005, EYS006,
      (select AAA103 from aa10 where aaa100='ECC207' AND AAA102=EYS007) EYS007,
      EYS008, EYS009, EYS010,
      (select AAA103 from aa10 where aaa100='AAA005' AND AAA102=EYS011) EYS011,
    (select AAA103 from aa10 where aaa100='AAA008' AND AAA102=EYS012) EYS012,
     EYS013, EYS014,EYS015,EYS016,EYS017,EYS018,EYS019,EYS020,EYS021,EYS022,EYS023,EYS024, AAB301, AAE011, AAE036,DATASOURCE,AAE100,UPDATEDATE,UPDATEBY,CREATEBY,AAE012,ISNEW,DELETEBY,DELETEDATE
    from employment_situation
    where aae100='1' and EYS002 = #{eys002,jdbcType=VARCHAR}
  </select>


  <!--根据劳动力id 查询劳动力公益性岗位情况信息-->
  <select id="queryEmploymentSituationByEys002Post" resultMap="BaseResultMap" parameterType="java.lang.String" >
    select
    EYS001, EYS002,
    (select AAA103 from aa10 where aaa100='AAA013' AND AAA102=EYS003)EYS003,
    (select AAA103 from aa10 where aaa100='AAA006' AND AAA102=EYS004)EYS004,
    EYS005, EYS006,
    (select AAA103 from aa10 where aaa100='ECC207' AND AAA102=EYS007) EYS007,
    EYS008, EYS009, EYS010,
    (select AAA103 from aa10 where aaa100='AAA005' AND AAA102=EYS011) EYS011,
    (select AAA103 from aa10 where aaa100='AAA008' AND AAA102=EYS012) EYS012,
    EYS013, EYS014,EYS015,EYS016,EYS017,EYS018,EYS019,EYS020,EYS021,EYS022,EYS023,EYS024, AAB301, AAE011, AAE036,DATASOURCE,AAE100,UPDATEDATE,UPDATEBY,CREATEBY,AAE012,ISNEW,DELETEBY,DELETEDATE
    from employment_situation
    where aae100='1' and eys011 in('5','6','7') and EYS002 = #{eys002,jdbcType=VARCHAR}
  </select>


<!--根据劳动力id 删除就业情况信息-->
  <update id="deleteEmploymentSituationByEys002" parameterType="java.lang.String" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    update  employment_situation set aae100='0',DELETEBY=#{realname,jdbcType=VARCHAR},DELETEDATE=sysdate
    where EYS002 = #{eys002,jdbcType=VARCHAR}
  </update>

  <!--根据劳动力id 删除  公益性岗位就业情况信息-->
  <update id="deletePublicPostByEys002" parameterType="java.lang.String" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    update  employment_situation set aae100='0',DELETEBY=#{realname,jdbcType=VARCHAR},DELETEDATE=sysdate
    where EYS002 = #{eys002,jdbcType=VARCHAR} and eys011 in('5','6','7')
  </update>


  <!--*************************************以下是就业台账信息查询***********************************************************************************-->


  <!--根据行政区划查询劳动力就业台账信息-->
  <select id="queryEmploymentSituationAccountByAab301" resultMap="EysPlfResultMap" parameterType="java.lang.String" >
    select
    plf001,plf002,plf004,plf005,plf006,plf007,plf008,
    plf009,plf010,plf011,plf012,plf013,plf015,plf016,plf017,plf018,
    plf019,plf020,plf021,plf022,plf023,plf024,phd014,phd014_19,
    eys001,eys002,eys003,eys004,eys005,eys006,eys007,eys008,eys009,
    eys010,eys011,eys012,eys013,eys014,eys015,eys016,
    eys017,eys018,eys019,eys020,eys021,eys022,eys023,eys024,aae036,monthcount,
    AAB301, AAE011, DATASOURCE,AAE100,UPDATEDATE,UPDATEBY,CREATEBY,AAE012,phd013,phd007,ISNEW,rn,DELETEBY,DELETEDATE
    from (select plf001,plf002,
    plf004,plf005,plf006,plf007,plf008,
    plf009,plf010,plf011,plf012,plf013,plf015,plf016,plf017,plf018,
    plf019,plf020,plf021,plf022,plf023,plf024,phd014,phd014_19,
    eys001,eys002,eys003,eys004,eys005,eys006,eys007,eys008,eys009,
    eys010,eys011,eys012,eys013,eys014,eys015,eys016,
    eys017,eys018,eys019,eys020,eys021,eys022,eys023,eys024,aae036,monthcount,
    AAB301, AAE011, DATASOURCE,AAE100,UPDATEDATE,UPDATEBY,CREATEBY,AAE012,phd013,phd007,ISNEW, rownum rn,DELETEBY,DELETEDATE
    from (select plf.plf001,plf.plf002,plf.plf004,plf.plf005,plf.plf006,
      f_getcodename('AAC004',plf.PLF007) PLF007,plf.PLF008,
      f_getcodename('AAC011',plf.PLF009) PLF009,
      f_getcodename('AAA004',plf.PLF010) PLF010,
      f_getcodename('AAA002',plf.PLF011) PLF011,
      f_getcodename('AAA003',plf.PLF012) PLF012,plf.PLF013,plf.PLF016,
      f_getcodename('AAA001',plf.PLF014) PLF014,
      (case when plf.plf015 ='1' then '是' else '否' end) plf015,
      f_getcodename('AAA011',plf.PLF017) PLF017,
      f_getcodename('AAA016',plf.PLF018) PLF018,
    plf.plf019,plf.plf020,plf.plf021,plf.plf022,
      f_getcodename('EDC441',plf.plf023) plf023,
      f_getcodename('PLF024',plf.plf024) plf024,
    es.eys001,es.eys002,
      f_getcodename('AAA013',es.EYS003)EYS003,
      f_getcodename('AAA006',es.EYS004)EYS004,
      f_getcodename('AAA018',es.EYS005)EYS005,
      f_getcodename('ECC207',es.EYS007)EYS007,
      f_getcodename('AAA005',es.EYS011)EYS011,
      f_getcodename('AAA008',es.EYS012)EYS012,
     es.EYS006,es.EYS008, es.EYS009, es.EYS010,
      f_getcodename('EDC441',plf.PHD013) phd013,
    f_getcodename('AAA012',plf.phd014) phd014,es.phd014_19,
    '' phd007,
      floor(((case
      when is_date_yy(es.eys009)=1 and is_date_yy(es.eys010)=1  then
      to_date(es.eys010, 'yyyy-MM-dd') -
      to_date(es.eys009, 'yyyy-MM-dd')
      when is_date_yy(es.eys009)=1  and es.eys010 is null then
      sysdate - to_date(es.eys009, 'yyyy-MM-dd')
      else
      0
      end) / 30)) monthcount,
    es.eys013,es.eys014,es.eys015,es.eys016,
    es.eys017,es.eys018,es.eys019,es.eys020,es.eys021,es.eys022,es.eys023,es.eys024,
    t.info AAB301 , es.AAE011, es.AAE036,es.DATASOURCE,
    es.AAE100,es.UPDATEDATE,es.UPDATEBY,es.CREATEBY,es.AAE012,es.ISNEW,es.DELETEBY,es.DELETEDATE,
      eys011 eysss
    from   employment_situation es
    left join poor_labor_force plf  on es.eys002 = plf.plf001
    /*是否享受补贴*/
    <if test="eysPlf.enjoysubsidy != null  and eysPlf.enjoysubsidy !=''  and eysPlf.enjoysubsidy=='1'.toString()  ">
      left join EMPLOYMENT_SUBSIDY dy on plf.PLF001 = dy.ETS003
    </if>
    ,POOR_XZQH t
    where plf.AAB301=t.XZQHBM and es.aae100='1' and plf.aae100='1'
      /*待完善条件 必须要有开始日期，结束日期不能大于当前日期  */
      <if test="eysPlf.istobecomplete != null  and eysPlf.istobecomplete !='' ">
        and jy_date(eys009,eys010)=0
      </if>
      <if test="eysPlf.showscope != null and eysPlf.showscope !='' ">
        and  plf.ispoor='1' and success = '1'
      </if>
      <if test="eysPlf.helpyear != null and eysPlf.helpyear !='' ">
          and   substr(es.eys009,0,4) = #{eysPlf.helpyear,jdbcType=VARCHAR}
      </if>
      <if test='eysPlf.isnoduty != null and eysPlf.isnoduty =="1" '>
          and  es.EYS010 is null
      </if>
      <if test='eysPlf.isnoduty != null and eysPlf.isnoduty =="0" '>
          and  es.EYS010 is not null
      </if>
    <if test="eysPlf.enjoysubsidy != null  and eysPlf.enjoysubsidy !=''  and eysPlf.enjoysubsidy=='1'.toString()  ">
      and dy.AAE100='1'
    </if>
    <if test="eysPlf.enjoysubsidy != null  and eysPlf.enjoysubsidy !=''  and eysPlf.enjoysubsidy=='1'.toString()  and eysPlf.helpyear != null and eysPlf.helpyear !='' ">
      and dy.AAE100='1' and dy.ets004 = #{eysPlf.helpyear,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.eys002 != null and eysPlf.eys002 !='' ">
      and   es.EYS002 = #{eys002,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.eys003 != null and eysPlf.eys003 !='' " >
      and   es.EYS003 = #{eysPlf.eys003,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.eys004 != null and eysPlf.eys004 !='' " >
      and   es.EYS004 = #{eysPlf.eys004,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.eys005 != null and eysPlf.eys005 !='' " >
      and   es.EYS005 = #{eysPlf.eys005,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.eys006 != null and eysPlf.eys006 !='' " >
      and   es.EYS006 = #{eysPlf.eys006,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.eys007 != null and eysPlf.eys007 !='' " >
      and   es.EYS007 = #{eysPlf.eys007,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.eys008 != null and eysPlf.eys008 !='' " >
      and   es.EYS008 = #{eysPlf.eys008,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.eys009 != null and eysPlf.eys009 !='' " >
      and to_date(es.EYS009,'yyyy-MM-dd') >= to_date(#{eysPlf.eys009},'yyyy-MM-dd')
    </if>
    <if test="eysPlf.monthcount != null and eysPlf.monthcount !='' " >
      and es.eys009 is not null and instr(es.eys009, '-') > 1 and  floor((to_date(es.eys010,'yyyy-MM-dd')- to_date(es.eys009,'yyyy-MM-dd'))/30) > #{eysPlf.monthcount}
    </if>
    <if test="eysPlf.eys010 != null and eysPlf.eys010 !='' " >
      /*and to_date(es.EYS010,'yyyy-MM-dd') &lt;= to_date(#{eysPlf.eys010},'yyyy-MM-dd')*//*2020-3-20日修改，就业开始时间从什么到什么 用不到结束时间*/
      and to_date(es.EYS009,'yyyy-MM-dd') &lt;= to_date(#{eysPlf.EYS009},'yyyy-MM-dd')
    </if>
    <!-- <if test="eysPlf.eys011 != null and eysPlf.eys011 !='' " >
       and   es.EYS011 = #{eysPlf.eys011,jdbcType=VARCHAR}
     </if>-->
    <if test="eysPlf.eys012 != null and eysPlf.eys012 !='' " >
      and   es.EYS012 = #{eysPlf.eys012,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.eys013 != null and eysPlf.eys013 !='' " >
      and   es.EYS013 = #{eysPlf.eys013,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.eys014 != null and eysPlf.eys014 !='' " >
      and  es.EYS014 = #{eysPlf.eys014,jdbcType=VARCHAR}
    </if>

    <if test="eysPlf.eys016 != null and eysPlf.eys016 !='' " >
      and   es.EYS016 = #{eysPlf.eys016,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.eys017 != null and eysPlf.eys017 !='' " >
      and  es.EYS017 = #{eysPlf.eys017,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.eys018 != null and eysPlf.eys018 !='' " >
      and   es.EYS018 = #{eysPlf.eys018,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.eys019 != null and eysPlf.eys019 !='' " >
      and   es.EYS019 = #{eysPlf.eys019,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.eys020 != null and eysPlf.eys020 !='' " >
      and   es.EYS020 = #{eysPlf.eys020,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.eys021 != null and eysPlf.eys021 !='' " >
      and   es.EYS021 = #{eysPlf.eys021,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.eys022 != null and eysPlf.eys022 !='' " >
      and   es.EYS022 = #{eysPlf.eys022,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.eys023 != null and eysPlf.eys023 !='' " >
      and   es.EYS023 = #{eysPlf.eys023,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.eys024 != null and eysPlf.eys024 !='' " >
      and   es.EYS024 = #{eysPlf.eys024,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.aab301 != null and eysPlf.aab301 !='' " >
      and   plf.AAB301 like #{eysPlf.aab301,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.aae011 != null and eysPlf.aae011 !='' " >
      and   es.AAE011 = #{eysPlf.aae011,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.aae036 != null and eysPlf.aae036 !='' " >
      and   es.AAE036 = #{eysPlf.aae036,jdbcType=TIMESTAMP},
    </if>
    <if test="eysPlf.eys015 != null and eysPlf.eys015 !='' " >
      and   es.EYS015 = #{eysPlf.eys015,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.datasource != null and eysPlf.datasource !='' " >
      and  es.DATASOURCE = #{eysPlf.datasource,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.aae100 != null and eysPlf.aae100 !='' " >
      and   es.AAE100 = #{eysPlf.aae100,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.updatedate != null and eysPlf.updatedate !='' " >
      and  es.UPDATEDATE = #{eysPlf.updatedate,jdbcType=TIMESTAMP}
    </if>
    <if test="eysPlf.updateby != null and eysPlf.updateby !='' " >
      and  es.UPDATEBY = #{eysPlf.updateby,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.createby != null and eysPlf.createby !='' " >
      and   es.CREATEBY = #{eysPlf.createby,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.aae012 != null and eysPlf.aae012 !='' " >
      and  es.AAE012 = #{eysPlf.aae012,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.isnew != null and eysPlf.isnew !='' " >
      and  es.ISNEW = #{eysPlf.isnew,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.plf004 != null and eysPlf.plf004 !='' " >
      and  plf.PLF004 like #{eysPlf.plf004,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.plf005 != null and eysPlf.plf005 !='' " >
      and plf.PLF005 = #{eysPlf.plf005,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.plf006 != null and eysPlf.plf006 !='' " >
      and plf.PLF006 = #{eysPlf.plf006,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.plf007 != null and eysPlf.plf007 !='' " >
      and plf.PLF007 = #{eysPlf.plf007,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.startage != null and eysPlf.startage !='' " >
      and plf.PLF008 >= #{eysPlf.startage,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.endage != null and eysPlf.endage !='' " >
      and plf.PLF008 &lt; #{eysPlf.endage,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.plf009 != null and eysPlf.plf009 !='' " >
      and plf.PLF009 = #{eysPlf.plf009,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.plf010 != null and eysPlf.plf010 !='' " >
      and plf.PLF010 = #{eysPlf.plf010,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.plf011 != null and eysPlf.plf011 !='' " >
      and plf.PLF011 = #{eysPlf.plf011,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.plf012 != null and eysPlf.plf012 !='' " >
      and plf.PLF012 = #{eysPlf.plf012,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.plf013 != null and eysPlf.plf013 !='' " >
      and plf.PLF013 = #{eysPlf.plf013,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.plf014 != null and eysPlf.plf014 !='' " >
      and  plf.PLF014 = #{eysPlf.plf014,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.plf016 != null and eysPlf.plf016 !='' " >
      and plf.PLF016 = #{eysPlf.plf016,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.plf015 != null and eysPlf.plf015 !='' " >
      and plf.PLF015 = #{eysPlf.plf015,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.plf017 != null and eysPlf.plf017 !='' " >
      and  plf.PLF017 = #{eysPlf.plf017,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.plf018 != null and eysPlf.plf018 !='' " >
      and  plf.PLF018 = #{eysPlf.plf018,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.plf019 != null and eysPlf.plf019 !='' " >
      and  plf.PLF019 = #{eysPlf.plf019,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.plf020 != null and eysPlf.plf020 !='' " >
      and plf.PLF020 = #{eysPlf.plf020,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.plf021 != null and eysPlf.plf021 !='' " >
      and  plf.PLF021 = #{eysPlf.plf021,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.plf022 != null and eysPlf.plf022 !='' " >
      and  plf.PLF022 = #{eysPlf.plf022,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.plf023 != null and eysPlf.plf023 !='' " >
      and  plf.PLF023 = #{eysPlf.plf023,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.plf024 != null and eysPlf.plf024 !='' " >
      and plf.PLF024 = #{eysPlf.plf024,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.phd013 != null and eysPlf.phd013 !='' " >
      and es.PHD013 = #{eysPlf.phd013,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.phd014 != null and eysPlf.phd014 !='' " >
      and es.phd014 = #{eysPlf.phd014,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.phd014_19 != null and eysPlf.phd014_19 !='' " >
      and es.phd014_19 = #{eysPlf.phd014_19,jdbcType=VARCHAR}
    </if>
    ) a1
    where  AAE100='1'
      <if test="eysPlf.eys011 != null and eysPlf.eys011 !='' " >
          and   eysss = #{eysPlf.eys011,jdbcType=VARCHAR}
      </if>

    and rownum &lt;= #{pageSize})
    where rn &gt;= #{startRecord}
  </select>

  <!--查询所有多少个  根据行政区划   查询台账信息-->
  <select id="queryAllEmploymentSituationByAab301" resultType="java.lang.String" parameterType="java.lang.String" >

    select
      count(1)
    from employment_situation es
    left join   poor_labor_force plf  on es.eys002 = plf.plf001
    /*是否享受补贴*/
    <if test="eysPlf.enjoysubsidy != null  and eysPlf.enjoysubsidy !='' and eysPlf.enjoysubsidy=='1'.toString() ">
      left join EMPLOYMENT_SUBSIDY dy on plf.PLF001 = dy.ETS003
    </if>
     where  es.aae100='1' and plf.aae100='1'
    /*待完善条件 必须要有开始日期，结束日期不能大于当前日期 */
      <if test="eysPlf.istobecomplete != null  and eysPlf.istobecomplete !='' ">
        and jy_date(eys009,eys010)=0
      </if>
      <if test="eysPlf.showscope != null and eysPlf.showscope !='' ">
         and plf.ispoor='1' and success = '1'
      </if>
      <if test="eysPlf.helpyear != null and eysPlf.helpyear !='' ">
          and   substr(es.eys009,0,4) = #{eysPlf.helpyear,jdbcType=VARCHAR}
      </if>
      <if test='eysPlf.isnoduty != null and eysPlf.isnoduty =="1" '>
          and  es.EYS010 is null
      </if>
      <if test='eysPlf.isnoduty != null and eysPlf.isnoduty =="0" '>
          and  es.EYS010 is not null
      </if>
    <if test="eysPlf.enjoysubsidy != null  and eysPlf.enjoysubsidy !='' and eysPlf.enjoysubsidy=='1'.toString() ">
      and dy.AAE100='1'
    </if>
    <if test="eysPlf.enjoysubsidy != null  and eysPlf.enjoysubsidy !=''  and eysPlf.enjoysubsidy=='1'.toString()  and eysPlf.helpyear != null and eysPlf.helpyear !='' ">
      and dy.AAE100='1' and dy.ets004 = #{eysPlf.helpyear,jdbcType=VARCHAR}
    </if>

    <if test="eysPlf.eys002 != null and eysPlf.eys002 !='' ">
      and   es.EYS002 = #{eys002,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.eys003 != null and eysPlf.eys003 !='' " >
      and   es.EYS003 = #{eysPlf.eys003,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.eys004 != null and eysPlf.eys004 !='' " >
      and   es.EYS004 = #{eysPlf.eys004,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.eys005 != null and eysPlf.eys005 !='' " >
      and   es.EYS005 = #{eysPlf.eys005,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.eys006 != null and eysPlf.eys006 !='' " >
      and   es.EYS006 = #{eysPlf.eys006,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.eys007 != null and eysPlf.eys007 !='' " >
      and   es.EYS007 = #{eysPlf.eys007,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.eys008 != null and eysPlf.eys008 !='' " >
      and   es.EYS008 = #{eysPlf.eys008,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.eys009 != null and eysPlf.eys009 !='' " >
      and to_date(es.EYS009,'yyyy-MM-dd') >= to_date(#{eysPlf.eys009},'yyyy-MM-dd')
    </if>
    <if test="eysPlf.monthcount != null and eysPlf.monthcount !='' " >
      and es.eys009 is not null and instr(es.eys009, '-') > 1 and  floor((to_date(es.eys010,'yyyy-MM-dd')- to_date(es.eys009,'yyyy-MM-dd'))/30) > #{eysPlf.monthcount}
    </if>
    <if test="eysPlf.eys010 != null and eysPlf.eys010 !='' " >
      /*and to_date(es.EYS010,'yyyy-MM-dd') &lt;= to_date(#{eysPlf.eys010},'yyyy-MM-dd')*//*2020-3-20日修改，就业开始时间从什么到什么 用不到结束时间*/
      and to_date(es.EYS009,'yyyy-MM-dd') &lt;= to_date(#{eysPlf.EYS009},'yyyy-MM-dd')
    </if>

    <if test="eysPlf.eys012 != null and eysPlf.eys012 !='' " >
      and   es.EYS012 = #{eysPlf.eys012,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.eys013 != null and eysPlf.eys013 !='' " >
      and   es.EYS013 = #{eysPlf.eys013,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.eys014 != null and eysPlf.eys014 !='' " >
      and  es.EYS014 = #{eysPlf.eys014,jdbcType=VARCHAR}
    </if>

    <if test="eysPlf.eys016 != null and eysPlf.eys016 !='' " >
      and   es.EYS016 = #{eysPlf.eys016,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.eys017 != null and eysPlf.eys017 !='' " >
      and  es.EYS017 = #{eysPlf.eys017,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.eys018 != null and eysPlf.eys018 !='' " >
      and   es.EYS018 = #{eysPlf.eys018,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.eys019 != null and eysPlf.eys019 !='' " >
      and   es.EYS019 = #{eysPlf.eys019,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.eys020 != null and eysPlf.eys020 !='' " >
      and   es.EYS020 = #{eysPlf.eys020,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.eys021 != null and eysPlf.eys021 !='' " >
      and   es.EYS021 = #{eysPlf.eys021,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.eys022 != null and eysPlf.eys022 !='' " >
      and   es.EYS022 = #{eysPlf.eys022,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.eys023 != null and eysPlf.eys023 !='' " >
      and   es.EYS023 = #{eysPlf.eys023,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.eys024 != null and eysPlf.eys024 !='' " >
      and   es.EYS024 = #{eysPlf.eys024,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.aab301 != null and eysPlf.aab301 !='' " >
      and   plf.AAB301 like #{eysPlf.aab301,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.aae011 != null and eysPlf.aae011 !='' " >
      and   es.AAE011 = #{eysPlf.aae011,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.aae036 != null and eysPlf.aae036 !='' " >
      and   es.AAE036 = #{eysPlf.aae036,jdbcType=TIMESTAMP},
    </if>
    <if test="eysPlf.eys015 != null and eysPlf.eys015 !='' " >
      and   es.EYS015 = #{eysPlf.eys015,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.datasource != null and eysPlf.datasource !='' " >
      and  es.DATASOURCE = #{eysPlf.datasource,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.aae100 != null and eysPlf.aae100 !='' " >
      and   es.AAE100 = #{eysPlf.aae100,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.updatedate != null and eysPlf.updatedate !='' " >
      and  es.UPDATEDATE = #{eysPlf.updatedate,jdbcType=TIMESTAMP}
    </if>
    <if test="eysPlf.updateby != null and eysPlf.updateby !='' " >
      and  es.UPDATEBY = #{eysPlf.updateby,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.createby != null and eysPlf.createby !='' " >
      and   es.CREATEBY = #{eysPlf.createby,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.aae012 != null and eysPlf.aae012 !='' " >
      and  es.AAE012 = #{eysPlf.aae012,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.isnew != null and eysPlf.isnew !='' " >
      and  es.ISNEW = #{eysPlf.isnew,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.plf004 != null and eysPlf.plf004 !='' " >
      and  plf.PLF004 like #{eysPlf.plf004,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.plf005 != null and eysPlf.plf005 !='' " >
      and plf.PLF005 = #{eysPlf.plf005,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.plf006 != null and eysPlf.plf006 !='' " >
      and plf.PLF006 = #{eysPlf.plf006,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.plf007 != null and eysPlf.plf007 !='' " >
      and plf.PLF007 = #{eysPlf.plf007,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.startage != null and eysPlf.startage !='' " >
      and plf.PLF008 >= #{eysPlf.startage,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.endage != null and eysPlf.endage !='' " >
      and plf.PLF008 &lt; #{eysPlf.endage,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.plf009 != null and eysPlf.plf009 !='' " >
      and plf.PLF009 = #{eysPlf.plf009,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.plf010 != null and eysPlf.plf010 !='' " >
      and plf.PLF010 = #{eysPlf.plf010,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.plf011 != null and eysPlf.plf011 !='' " >
      and plf.PLF011 = #{eysPlf.plf011,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.plf012 != null and eysPlf.plf012 !='' " >
      and plf.PLF012 = #{eysPlf.plf012,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.plf013 != null and eysPlf.plf013 !='' " >
      and plf.PLF013 = #{eysPlf.plf013,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.plf014 != null and eysPlf.plf014 !='' " >
      and  plf.PLF014 = #{eysPlf.plf014,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.plf016 != null and eysPlf.plf016 !='' " >
      and plf.PLF016 = #{eysPlf.plf016,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.plf015 != null and eysPlf.plf015 !='' " >
      and plf.PLF015 = #{eysPlf.plf015,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.plf017 != null and eysPlf.plf017 !='' " >
      and  plf.PLF017 = #{eysPlf.plf017,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.plf018 != null and eysPlf.plf018 !='' " >
      and  plf.PLF018 = #{eysPlf.plf018,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.plf019 != null and eysPlf.plf019 !='' " >
      and  plf.PLF019 = #{eysPlf.plf019,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.plf020 != null and eysPlf.plf020 !='' " >
      and plf.PLF020 = #{eysPlf.plf020,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.plf021 != null and eysPlf.plf021 !='' " >
      and  plf.PLF021 = #{eysPlf.plf021,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.plf022 != null and eysPlf.plf022 !='' " >
      and  plf.PLF022 = #{eysPlf.plf022,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.plf023 != null and eysPlf.plf023 !='' " >
      and  plf.PLF023 = #{eysPlf.plf023,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.plf024 != null and eysPlf.plf024 !='' " >
      and plf.PLF024 = #{eysPlf.plf024,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.phd013 != null and eysPlf.phd013 !='' " >
      and es.PHD013 = #{eysPlf.phd013,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.phd014 != null and eysPlf.phd014 !='' " >
      and es.phd014 = #{eysPlf.phd014,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.phd014_19 != null and eysPlf.phd014_19 !='' " >
      and es.phd014_19 = #{eysPlf.phd014_19,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.eys011 != null and eysPlf.eys011 !='' " >
      and   EYS011 = #{eysPlf.eys011,jdbcType=VARCHAR}
    </if>


  </select>

<!--根据劳动力id  查询最新的就业信息-->
  <select id="queryNewEmploymentSituation" resultMap="BaseResultMap" parameterType="java.lang.String" >
    select eys001,eys002,eys009 from
    (select s.eys001,eys002,eys009,row_number() over(partition by s.eys002 order by eys009 desc) as sn from EMPLOYMENT_SITUATION s where s.aae100='1' and s.eys002 = #{eys002})
    where sn=1
  </select>


    <!--*************************************以下是公益性岗位台账和待完善信息查询***********************************************************************************-->


    <!--根据行政区划查询劳动力就业台账和待完善信息-->
  <select id="queryPublicPostAccountByAab301" resultMap="EysPlfResultMap" parameterType="java.lang.String" >
    select
    plf001,plf002,plf004,plf005,plf006,plf007,plf008,
    plf009,plf010,plf011,plf012,plf013,plf015,plf016,plf017,plf018,
    plf019,plf020,plf021,plf022,plf023,plf024,phd014,
    eys001,eys002,eys003,eys004,eys005,eys006,eys007,eys008,eys009,
    eys010,eys011,eys012,eys013,eys014,eys015,eys016,
    eys017,eys018,eys019,eys020,eys021,eys022,eys023,eys024,aae036,
    AAB301, AAE011, DATASOURCE,AAE100,UPDATEDATE,UPDATEBY,CREATEBY,AAE012,phd013,phd007,ISNEW,rn,DELETEBY,DELETEDATE
    from (select plf001,plf002,
    plf004,plf005,plf006,plf007,plf008,
    plf009,plf010,plf011,plf012,plf013,plf015,plf016,plf017,plf018,
    plf019,plf020,plf021,plf022,plf023,plf024,
    eys001,eys002,eys003,eys004,eys005,eys006,eys007,eys008,eys009,
    eys010,eys011,eys012,eys013,eys014,eys015,eys016,
    eys017,eys018,eys019,eys020,eys021,eys022,eys023,eys024,aae036,
    AAB301, AAE011, DATASOURCE,AAE100,UPDATEDATE,UPDATEBY,CREATEBY,AAE012,phd013,phd007,phd014,ISNEW, rownum rn,DELETEBY,DELETEDATE
    from (select plf.plf001,plf.plf002,plf.plf004,plf.plf005,plf.plf006,
    f_getcodename('AAC004',plf.PLF007) PLF007,plf.PLF008,
    f_getcodename('AAC011',plf.PLF009) PLF009,
    f_getcodename('AAA004',plf.PLF010) PLF010,
    f_getcodename('AAA002',plf.PLF011) PLF011,
    f_getcodename('AAA003',plf.PLF012) PLF012,plf.PLF013,plf.PLF016,
    f_getcodename('AAA001',plf.PLF014) PLF014,
    (case when plf.plf015 ='1' then '是' else '否' end) plf015,
    f_getcodename('AAA011',plf.PLF017) PLF017,
    f_getcodename('AAA016',plf.PLF018) PLF018,
    plf.plf019,plf.plf020,plf.plf021,plf.plf022,
    f_getcodename('EDC441',plf.plf023) plf023,
    f_getcodename('PLF024',plf.plf024) plf024,
    es.eys001,es.eys002,
    f_getcodename('AAA013',es.EYS003)EYS003,
    f_getcodename('AAA006',es.EYS004)EYS004,
    f_getcodename('AAA018',es.EYS005)EYS005,
    f_getcodename('ECC207',es.EYS007)EYS007,
    f_getcodename('AAA005',es.EYS011)EYS011,
    f_getcodename('AAA008',es.EYS012)EYS012,
    es.EYS006,es.EYS008, es.EYS009, es.EYS010,
    f_getcodename('EDC441',es.PHD013) phd013,
    ''phd007,f_getcodename('AAA012',es.PHD014) phd014,
    es.eys013,es.eys014,es.eys015,es.eys016,
    es.eys017,es.eys018,es.eys019,es.eys020,es.eys021,es.eys022,es.eys023,es.eys024,
    t.info AAB301 , es.AAE011, es.AAE036,es.DATASOURCE,
    es.AAE100,es.UPDATEDATE,es.UPDATEBY,es.CREATEBY,es.AAE012,es.ISNEW,es.DELETEBY,es.DELETEDATE,
    eys011 esss
    from   employment_situation es left join poor_labor_force plf  on es.eys002 = plf.plf001 ,POOR_XZQH t
    where plf.AAB301=t.XZQHBM and es.aae100='1' and plf.aae100='1'
    /*待完善条件 EYS004!=1 公益性岗位就业类型 只能是转移就业    公岗的就业渠道都是“组织介绍”，就业类型都是“转移就业”，就业地域不能是“省外”  特设公岗选择后，单位性质是“村组公岗” */
      <if test="eysPlf.istobecomplete != null  and eysPlf.istobecomplete !='' ">
        and (es.eys003 !='1' or es.EYS004 !='1' or eys012 ='5' or eys012 ='6' or (eys011='7' and eys007 !='008') or jy_date(eys009,eys010)=0)

      </if>
    <if test="eysPlf.showscope != null and eysPlf.showscope !='' ">
      and  plf.ispoor='1' and success = '1'
    </if>
    <if test="eysPlf.helpyear != null and eysPlf.helpyear !='' ">
      and   substr(es.eys009,0,4) = #{eysPlf.helpyear,jdbcType=VARCHAR}
    </if>
    <if test='eysPlf.isnoduty != null and eysPlf.isnoduty =="1" '>
      and  es.EYS010 is null
    </if>
    <if test='eysPlf.isnoduty != null and eysPlf.isnoduty =="0" '>
      and  es.EYS010 is not null
    </if>
    <if test="eysPlf.eys002 != null and eysPlf.eys002 !='' ">
      and   es.EYS002 = #{eys002,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.eys003 != null and eysPlf.eys003 !='' " >
      and   es.EYS003 = #{eysPlf.eys003,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.eys004 != null and eysPlf.eys004 !='' " >
      and   es.EYS004 = #{eysPlf.eys004,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.eys005 != null and eysPlf.eys005 !='' " >
      and   es.EYS005 = #{eysPlf.eys005,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.eys006 != null and eysPlf.eys006 !='' " >
      and   es.EYS006 = #{eysPlf.eys006,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.eys007 != null and eysPlf.eys007 !='' " >
      and   es.EYS007 = #{eysPlf.eys007,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.eys008 != null and eysPlf.eys008 !='' " >
      and   es.EYS008 = #{eysPlf.eys008,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.eys009 != null and eysPlf.eys009 !='' " >
      and   es.EYS009 = #{eysPlf.eys009,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.eys010 != null and eysPlf.eys010 !='' " >
      and   es.EYS010 = #{eysPlf.eys010,jdbcType=VARCHAR}
    </if>
    <!--  <if test="eysPlf.eys011 != null and eysPlf.eys011 !='' " >
        and   es.EYS011 = #{eysPlf.eys011,jdbcType=VARCHAR}
      </if>-->
    <if test="eysPlf.eys012 != null and eysPlf.eys012 !='' " >
      and   es.EYS012 = #{eysPlf.eys012,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.eys013 != null and eysPlf.eys013 !='' " >
      and   es.EYS013 = #{eysPlf.eys013,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.eys014 != null and eysPlf.eys014 !='' " >
      and  es.EYS014 = #{eysPlf.eys014,jdbcType=VARCHAR}
    </if>

    <if test="eysPlf.eys016 != null and eysPlf.eys016 !='' " >
      and   es.EYS016 = #{eysPlf.eys016,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.eys017 != null and eysPlf.eys017 !='' " >
      and  es.EYS017 = #{eysPlf.eys017,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.eys018 != null and eysPlf.eys018 !='' " >
      and   es.EYS018 = #{eysPlf.eys018,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.eys019 != null and eysPlf.eys019 !='' " >
      and   es.EYS019 = #{eysPlf.eys019,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.eys020 != null and eysPlf.eys020 !='' " >
      and   es.EYS020 = #{eysPlf.eys020,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.eys021 != null and eysPlf.eys021 !='' " >
      and   es.EYS021 = #{eysPlf.eys021,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.eys022 != null and eysPlf.eys022 !='' " >
      and   es.EYS022 = #{eysPlf.eys022,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.eys023 != null and eysPlf.eys023 !='' " >
      and   es.EYS023 = #{eysPlf.eys023,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.eys024 != null and eysPlf.eys024 !='' " >
      and   es.EYS024 = #{eysPlf.eys024,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.aab301 != null and eysPlf.aab301 !='' " >
      and   plf.AAB301 like #{eysPlf.aab301,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.aae011 != null and eysPlf.aae011 !='' " >
      and   es.AAE011 = #{eysPlf.aae011,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.aae036 != null and eysPlf.aae036 !='' " >
      and   es.AAE036 = #{eysPlf.aae036,jdbcType=TIMESTAMP},
    </if>
    <if test="eysPlf.eys015 != null and eysPlf.eys015 !='' " >
      and   es.EYS015 = #{eysPlf.eys015,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.datasource != null and eysPlf.datasource !='' " >
      and  es.DATASOURCE = #{eysPlf.datasource,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.aae100 != null and eysPlf.aae100 !='' " >
      and   es.AAE100 = #{eysPlf.aae100,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.updatedate != null and eysPlf.updatedate !='' " >
      and  es.UPDATEDATE = #{eysPlf.updatedate,jdbcType=TIMESTAMP}
    </if>
    <if test="eysPlf.updateby != null and eysPlf.updateby !='' " >
      and  es.UPDATEBY = #{eysPlf.updateby,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.createby != null and eysPlf.createby !='' " >
      and   es.CREATEBY = #{eysPlf.createby,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.aae012 != null and eysPlf.aae012 !='' " >
      and  es.AAE012 = #{eysPlf.aae012,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.isnew != null and eysPlf.isnew !='' " >
      and  es.ISNEW = #{eysPlf.isnew,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.plf004 != null and eysPlf.plf004 !='' " >
      and  plf.PLF004 like #{eysPlf.plf004,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.plf005 != null and eysPlf.plf005 !='' " >
      and plf.PLF005 = #{eysPlf.plf005,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.plf006 != null and eysPlf.plf006 !='' " >
      and plf.PLF006 = #{eysPlf.plf006,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.plf007 != null and eysPlf.plf007 !='' " >
      and plf.PLF007 = #{eysPlf.plf007,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.startage != null and eysPlf.startage !='' " >
      and plf.PLF008 >= #{eysPlf.startage,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.endage != null and eysPlf.endage !='' " >
      and plf.PLF008 &lt; #{eysPlf.endage,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.plf009 != null and eysPlf.plf009 !='' " >
      and plf.PLF009 = #{eysPlf.plf009,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.plf010 != null and eysPlf.plf010 !='' " >
      and plf.PLF010 = #{eysPlf.plf010,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.plf011 != null and eysPlf.plf011 !='' " >
      and plf.PLF011 = #{eysPlf.plf011,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.plf012 != null and eysPlf.plf012 !='' " >
      and plf.PLF012 = #{eysPlf.plf012,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.plf013 != null and eysPlf.plf013 !='' " >
      and plf.PLF013 = #{eysPlf.plf013,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.plf014 != null and eysPlf.plf014 !='' " >
      and  plf.PLF014 = #{eysPlf.plf014,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.plf016 != null and eysPlf.plf016 !='' " >
      and plf.PLF016 = #{eysPlf.plf016,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.plf015 != null and eysPlf.plf015 !='' " >
      and plf.PLF015 = #{eysPlf.plf015,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.plf017 != null and eysPlf.plf017 !='' " >
      and  plf.PLF017 = #{eysPlf.plf017,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.plf018 != null and eysPlf.plf018 !='' " >
      and  plf.PLF018 = #{eysPlf.plf018,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.plf019 != null and eysPlf.plf019 !='' " >
      and  plf.PLF019 = #{eysPlf.plf019,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.plf020 != null and eysPlf.plf020 !='' " >
      and plf.PLF020 = #{eysPlf.plf020,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.plf021 != null and eysPlf.plf021 !='' " >
      and  plf.PLF021 = #{eysPlf.plf021,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.plf022 != null and eysPlf.plf022 !='' " >
      and  plf.PLF022 = #{eysPlf.plf022,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.plf023 != null and eysPlf.plf023 !='' " >
      and  plf.PLF023 = #{eysPlf.plf023,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.plf024 != null and eysPlf.plf024 !='' " >
      and plf.PLF024 = #{eysPlf.plf024,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.phd013 != null and eysPlf.phd013 !='' " >
      and es.PHD013 = #{eysPlf.phd013,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.phd014 != null and eysPlf.phd014 !='' " >
      and es.phd014 = #{eysPlf.phd014,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.phd014_19 != null and eysPlf.phd014_19 !='' " >
      and es.phd014_19 = #{eysPlf.phd014_19,jdbcType=VARCHAR}
    </if>
    ) a1
    where  AAE100='1'
     <if test="eysPlf.eys011 != null and eysPlf.eys011 !='' " >
      and   esss = #{eysPlf.eys011,jdbcType=VARCHAR}
     </if>
      <if test="eysPlf.eys011 = null and eysPlf.eys011 ='' " >
          and esss in ('5', '6', '7')
      </if>
    and rownum &lt;= #{pageSize})
    where rn &gt;= #{startRecord}
  </select>

  <!--查询所有多少个  根据行政区划   查询台账信息-->
  <select id="queryPublicPostCountByAab301" resultType="java.lang.String" parameterType="java.lang.String" >
    select count(1) from(
    select
    eys001
    from employment_situation es left join   poor_labor_force plf  on es.eys002 = plf.plf001
    where  es.aae100='1' and plf.aae100='1'
    /*待完善条件 EYS004!=1 公益性岗位就业类型 只能是转移就业   公岗的就业渠道都是“组织介绍”，就业类型都是“转移就业”，就业地域不能是“省外”*/
      <if test="eysPlf.istobecomplete != null  and eysPlf.istobecomplete !='' ">
        and (es.eys003 !='1' or es.EYS004 !='1' or eys012 ='5' or eys012 ='6' or (eys011='7' and eys007 !='008') or jy_date(eys009,eys010)=0)
      </if>
    <if test="eysPlf.showscope != null and eysPlf.showscope !='' ">
      and plf.ispoor='1' and success = '1'
    </if>
    <if test="eysPlf.helpyear != null and eysPlf.helpyear !='' ">
      and   substr(es.eys009,0,4) = #{eysPlf.helpyear,jdbcType=VARCHAR}
    </if>
    <if test='eysPlf.isnoduty != null and eysPlf.isnoduty =="1" '>
      and  es.EYS010 is null
    </if>
    <if test='eysPlf.isnoduty != null and eysPlf.isnoduty =="0" '>
      and  es.EYS010 is not null
    </if>
    <if test="eysPlf.eys002 != null and eysPlf.eys002 !='' ">
      and   es.EYS002 = #{eys002,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.eys003 != null and eysPlf.eys003 !='' " >
      and   es.EYS003 = #{eysPlf.eys003,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.eys004 != null and eysPlf.eys004 !='' " >
      and   es.EYS004 = #{eysPlf.eys004,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.eys005 != null and eysPlf.eys005 !='' " >
      and   es.EYS005 = #{eysPlf.eys005,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.eys006 != null and eysPlf.eys006 !='' " >
      and   es.EYS006 = #{eysPlf.eys006,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.eys007 != null and eysPlf.eys007 !='' " >
      and   es.EYS007 = #{eysPlf.eys007,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.eys008 != null and eysPlf.eys008 !='' " >
      and   es.EYS008 = #{eysPlf.eys008,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.eys009 != null and eysPlf.eys009 !='' " >
      and   es.EYS009 = #{eysPlf.eys009,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.eys010 != null and eysPlf.eys010 !='' " >
      and   es.EYS010 = #{eysPlf.eys010,jdbcType=VARCHAR}
    </if>

    <if test="eysPlf.eys012 != null and eysPlf.eys012 !='' " >
      and   es.EYS012 = #{eysPlf.eys012,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.eys013 != null and eysPlf.eys013 !='' " >
      and   es.EYS013 = #{eysPlf.eys013,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.eys014 != null and eysPlf.eys014 !='' " >
      and  es.EYS014 = #{eysPlf.eys014,jdbcType=VARCHAR}
    </if>

    <if test="eysPlf.eys016 != null and eysPlf.eys016 !='' " >
      and   es.EYS016 = #{eysPlf.eys016,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.eys017 != null and eysPlf.eys017 !='' " >
      and  es.EYS017 = #{eysPlf.eys017,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.eys018 != null and eysPlf.eys018 !='' " >
      and   es.EYS018 = #{eysPlf.eys018,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.eys019 != null and eysPlf.eys019 !='' " >
      and   es.EYS019 = #{eysPlf.eys019,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.eys020 != null and eysPlf.eys020 !='' " >
      and   es.EYS020 = #{eysPlf.eys020,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.eys021 != null and eysPlf.eys021 !='' " >
      and   es.EYS021 = #{eysPlf.eys021,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.eys022 != null and eysPlf.eys022 !='' " >
      and   es.EYS022 = #{eysPlf.eys022,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.eys023 != null and eysPlf.eys023 !='' " >
      and   es.EYS023 = #{eysPlf.eys023,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.eys024 != null and eysPlf.eys024 !='' " >
      and   es.EYS024 = #{eysPlf.eys024,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.aab301 != null and eysPlf.aab301 !='' " >
      and   plf.AAB301 like #{eysPlf.aab301,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.aae011 != null and eysPlf.aae011 !='' " >
      and   es.AAE011 = #{eysPlf.aae011,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.aae036 != null and eysPlf.aae036 !='' " >
      and   es.AAE036 = #{eysPlf.aae036,jdbcType=TIMESTAMP},
    </if>
    <if test="eysPlf.eys015 != null and eysPlf.eys015 !='' " >
      and   es.EYS015 = #{eysPlf.eys015,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.datasource != null and eysPlf.datasource !='' " >
      and  es.DATASOURCE = #{eysPlf.datasource,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.aae100 != null and eysPlf.aae100 !='' " >
      and   es.AAE100 = #{eysPlf.aae100,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.updatedate != null and eysPlf.updatedate !='' " >
      and  es.UPDATEDATE = #{eysPlf.updatedate,jdbcType=TIMESTAMP}
    </if>
    <if test="eysPlf.updateby != null and eysPlf.updateby !='' " >
      and  es.UPDATEBY = #{eysPlf.updateby,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.createby != null and eysPlf.createby !='' " >
      and   es.CREATEBY = #{eysPlf.createby,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.aae012 != null and eysPlf.aae012 !='' " >
      and  es.AAE012 = #{eysPlf.aae012,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.isnew != null and eysPlf.isnew !='' " >
      and  es.ISNEW = #{eysPlf.isnew,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.plf004 != null and eysPlf.plf004 !='' " >
      and  plf.PLF004 like #{eysPlf.plf004,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.plf005 != null and eysPlf.plf005 !='' " >
      and plf.PLF005 = #{eysPlf.plf005,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.plf006 != null and eysPlf.plf006 !='' " >
      and plf.PLF006 = #{eysPlf.plf006,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.plf007 != null and eysPlf.plf007 !='' " >
      and plf.PLF007 = #{eysPlf.plf007,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.startage != null and eysPlf.startage !='' " >
      and plf.PLF008 >= #{eysPlf.startage,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.endage != null and eysPlf.endage !='' " >
      and plf.PLF008 &lt; #{eysPlf.endage,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.plf009 != null and eysPlf.plf009 !='' " >
      and plf.PLF009 = #{eysPlf.plf009,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.plf010 != null and eysPlf.plf010 !='' " >
      and plf.PLF010 = #{eysPlf.plf010,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.plf011 != null and eysPlf.plf011 !='' " >
      and plf.PLF011 = #{eysPlf.plf011,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.plf012 != null and eysPlf.plf012 !='' " >
      and plf.PLF012 = #{eysPlf.plf012,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.plf013 != null and eysPlf.plf013 !='' " >
      and plf.PLF013 = #{eysPlf.plf013,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.plf014 != null and eysPlf.plf014 !='' " >
      and  plf.PLF014 = #{eysPlf.plf014,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.plf016 != null and eysPlf.plf016 !='' " >
      and plf.PLF016 = #{eysPlf.plf016,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.plf015 != null and eysPlf.plf015 !='' " >
      and plf.PLF015 = #{eysPlf.plf015,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.plf017 != null and eysPlf.plf017 !='' " >
      and  plf.PLF017 = #{eysPlf.plf017,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.plf018 != null and eysPlf.plf018 !='' " >
      and  plf.PLF018 = #{eysPlf.plf018,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.plf019 != null and eysPlf.plf019 !='' " >
      and  plf.PLF019 = #{eysPlf.plf019,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.plf020 != null and eysPlf.plf020 !='' " >
      and plf.PLF020 = #{eysPlf.plf020,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.plf021 != null and eysPlf.plf021 !='' " >
      and  plf.PLF021 = #{eysPlf.plf021,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.plf022 != null and eysPlf.plf022 !='' " >
      and  plf.PLF022 = #{eysPlf.plf022,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.plf023 != null and eysPlf.plf023 !='' " >
      and  plf.PLF023 = #{eysPlf.plf023,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.plf024 != null and eysPlf.plf024 !='' " >
      and plf.PLF024 = #{eysPlf.plf024,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.phd013 != null and eysPlf.phd013 !='' " >
      and es.PHD013 = #{eysPlf.phd013,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.phd014 != null and eysPlf.phd014 !='' " >
      and es.phd014 = #{eysPlf.phd014,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.phd014_19 != null and eysPlf.phd014_19 !='' " >
      and es.phd014_19 = #{eysPlf.phd014_19,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.eys011 != null and eysPlf.eys011 !='' " >
      and   EYS011 = #{eysPlf.eys011,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.eys011 = null and eysPlf.eys011 ='' " >
      and eys011 in ('5', '6', '7')
    </if>
    )


  </select>



  <!--*************************************以下是就业培训台账信息查询***********************************************************************************-->


  <!--根据行政区划查询劳动力就业台账信息-->
  <select id="queryEmploymentSituationTrainingByAab301" resultMap="EysPlfResultMap" parameterType="java.lang.String" >
    select
    plf001,plf002,plf004,plf005,plf006,plf007,plf008,
    plf009,plf010,plf011,plf012,plf013,plf015,plf016,plf017,plf018,
    plf019,plf020,plf021,plf022,plf023,plf024,phd014,
    eys001,eys002,eys003,eys004,eys005,eys006,eys007,eys008,eys009,
    eys010,eys011,eys012,eys013,eys014,eys015,eys016,
    eys017,eys018,eys019,eys020,eys021,eys022,eys023,eys024,aae036,monthcount,
    AAB301, AAE011, DATASOURCE,AAE100,UPDATEDATE,UPDATEBY,CREATEBY,AAE012,phd013,phd007,ISNEW,rn,DELETEBY,DELETEDATE
    from (select plf001,plf002,
    plf004,plf005,plf006,plf007,plf008,
    plf009,plf010,plf011,plf012,plf013,plf015,plf016,plf017,plf018,
    plf019,plf020,plf021,plf022,plf023,plf024,phd014,
    eys001,eys002,eys003,eys004,eys005,eys006,eys007,eys008,eys009,
    eys010,eys011,eys012,eys013,eys014,eys015,eys016,
    eys017,eys018,eys019,eys020,eys021,eys022,eys023,eys024,aae036,monthcount,
    AAB301, AAE011, DATASOURCE,AAE100,UPDATEDATE,UPDATEBY,CREATEBY,AAE012,phd013,phd007,ISNEW, rownum rn,DELETEBY,DELETEDATE
    from (select plf.plf001,plf.plf002,plf.plf004,plf.plf005,plf.plf006,
    f_getcodename('AAC004',plf.PLF007) PLF007,plf.PLF008,
    f_getcodename('AAC011',plf.PLF009) PLF009,
    f_getcodename('AAA004',plf.PLF010) PLF010,
    f_getcodename('AAA002',plf.PLF011) PLF011,
    f_getcodename('AAA003',plf.PLF012) PLF012,plf.PLF013,plf.PLF016,
    f_getcodename('AAA001',plf.PLF014) PLF014,
    (case when plf.plf015 ='1' then '是' else '否' end) plf015,
    f_getcodename('AAA011',plf.PLF017) PLF017,
    f_getcodename('AAA016',plf.PLF018) PLF018,
    plf.plf019,plf.plf020,plf.plf021,plf.plf022,
    f_getcodename('EDC441',plf.plf023) plf023,
    f_getcodename('PLF024',plf.plf024) plf024,
    es.eys001,es.eys002,
    f_getcodename('AAA013',es.EYS003)EYS003,
    f_getcodename('AAA006',es.EYS004)EYS004,
    f_getcodename('AAA018',es.EYS005)EYS005,
    f_getcodename('ECC207',es.EYS007)EYS007,
    f_getcodename('AAA005',es.EYS011)EYS011,
    f_getcodename('AAA008',es.EYS012)EYS012,
    es.EYS006,es.EYS008, es.EYS009, es.EYS010,
    f_getcodename('EDC441',es.PHD013) phd013,
    f_getcodename('AAA012',es.phd014) phd014,
    ''phd007,
    /*floor(((case
    when is_date_yy(es.eys009)=1 and is_date_yy(es.eys010)=1  then
    to_date(es.eys010, 'yyyy-MM-dd') -
    to_date(es.eys009, 'yyyy-MM-dd')
    when is_date_yy(es.eys009)=1  and es.eys010 is null then
    sysdate - to_date(es.eys009, 'yyyy-MM-dd')
    else
    0
    end) / 30)) monthcount,*/
    '' monthcount,
    es.eys013,es.eys014,es.eys015,es.eys016,
    es.eys017,es.eys018,es.eys019,es.eys020,es.eys021,es.eys022,es.eys023,es.eys024,
    t.info AAB301 , es.AAE011, es.AAE036,es.DATASOURCE,
    es.AAE100,es.UPDATEDATE,es.UPDATEBY,es.CREATEBY,es.AAE012,es.ISNEW,es.DELETEBY,es.DELETEDATE,
    eys011 eysss
    from   employment_situation es left join poor_labor_force plf  on es.eys002 = plf.plf001

    <if test="eysPlf.showscope != null and eysPlf.showscope !='' ">
        left join training_situation ts on es.eys002 = ts.tsn010
    </if>
    ,POOR_XZQH t
    where plf.AAB301=t.XZQHBM and es.aae100='1' and plf.aae100='1'
    and plf.ispoor='1' and success = '1' and es.eys004='1'
    <if test="eysPlf.showscope != null and eysPlf.showscope !='' ">
      and ts.TSN012='1' and ts.aae100='1'  and ts.tsn003='1'
    </if>
    <if test="eysPlf.helpyear != null and eysPlf.helpyear !='' ">
      and   substr(es.eys009,0,4) = #{eysPlf.helpyear,jdbcType=VARCHAR}
    </if>
    <if test='eysPlf.isnoduty != null and eysPlf.isnoduty =="1" '>
      and  es.EYS010 is null
    </if>
    <if test='eysPlf.isnoduty != null and eysPlf.isnoduty =="0" '>
      and  es.EYS010 is not null
    </if>
    <if test="eysPlf.eys002 != null and eysPlf.eys002 !='' ">
      and   es.EYS002 = #{eys002,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.eys003 != null and eysPlf.eys003 !='' " >
      and   es.EYS003 = #{eysPlf.eys003,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.eys004 != null and eysPlf.eys004 !='' " >
      and   es.EYS004 = #{eysPlf.eys004,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.eys005 != null and eysPlf.eys005 !='' " >
      and   es.EYS005 = #{eysPlf.eys005,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.eys006 != null and eysPlf.eys006 !='' " >
      and   es.EYS006 = #{eysPlf.eys006,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.eys007 != null and eysPlf.eys007 !='' " >
      and   es.EYS007 = #{eysPlf.eys007,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.eys008 != null and eysPlf.eys008 !='' " >
      and   es.EYS008 = #{eysPlf.eys008,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.eys009 != null and eysPlf.eys009 !='' " >
      and to_date(es.EYS009,'yyyy-MM-dd') >= to_date(#{eysPlf.eys009},'yyyy-MM-dd')
    </if>
    <if test="eysPlf.monthcount != null and eysPlf.monthcount !='' " >
      and es.eys009 is not null and instr(es.eys009, '-') > 1 and  floor((to_date(es.eys010,'yyyy-MM-dd')- to_date(es.eys009,'yyyy-MM-dd'))/30) > #{eysPlf.monthcount}
    </if>
    <if test="eysPlf.eys010 != null and eysPlf.eys010 !='' " >
      and to_date(es.EYS010,'yyyy-MM-dd') &lt;= to_date(#{eysPlf.eys010},'yyyy-MM-dd')
    </if>
    <!-- <if test="eysPlf.eys011 != null and eysPlf.eys011 !='' " >
       and   es.EYS011 = #{eysPlf.eys011,jdbcType=VARCHAR}
     </if>-->
    <if test="eysPlf.eys012 != null and eysPlf.eys012 !='' " >
      and   es.EYS012 = #{eysPlf.eys012,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.eys013 != null and eysPlf.eys013 !='' " >
      and   es.EYS013 = #{eysPlf.eys013,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.eys014 != null and eysPlf.eys014 !='' " >
      and  es.EYS014 = #{eysPlf.eys014,jdbcType=VARCHAR}
    </if>

    <if test="eysPlf.eys016 != null and eysPlf.eys016 !='' " >
      and   es.EYS016 = #{eysPlf.eys016,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.eys017 != null and eysPlf.eys017 !='' " >
      and  es.EYS017 = #{eysPlf.eys017,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.eys018 != null and eysPlf.eys018 !='' " >
      and   es.EYS018 = #{eysPlf.eys018,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.eys019 != null and eysPlf.eys019 !='' " >
      and   es.EYS019 = #{eysPlf.eys019,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.eys020 != null and eysPlf.eys020 !='' " >
      and   es.EYS020 = #{eysPlf.eys020,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.eys021 != null and eysPlf.eys021 !='' " >
      and   es.EYS021 = #{eysPlf.eys021,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.eys022 != null and eysPlf.eys022 !='' " >
      and   es.EYS022 = #{eysPlf.eys022,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.eys023 != null and eysPlf.eys023 !='' " >
      and   es.EYS023 = #{eysPlf.eys023,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.eys024 != null and eysPlf.eys024 !='' " >
      and   es.EYS024 = #{eysPlf.eys024,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.aab301 != null and eysPlf.aab301 !='' " >
      and   plf.AAB301 like #{eysPlf.aab301,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.aae011 != null and eysPlf.aae011 !='' " >
      and   es.AAE011 = #{eysPlf.aae011,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.aae036 != null and eysPlf.aae036 !='' " >
      and   es.AAE036 = #{eysPlf.aae036,jdbcType=TIMESTAMP},
    </if>
    <if test="eysPlf.eys015 != null and eysPlf.eys015 !='' " >
      and   es.EYS015 = #{eysPlf.eys015,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.datasource != null and eysPlf.datasource !='' " >
      and  es.DATASOURCE = #{eysPlf.datasource,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.aae100 != null and eysPlf.aae100 !='' " >
      and   es.AAE100 = #{eysPlf.aae100,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.updatedate != null and eysPlf.updatedate !='' " >
      and  es.UPDATEDATE = #{eysPlf.updatedate,jdbcType=TIMESTAMP}
    </if>
    <if test="eysPlf.updateby != null and eysPlf.updateby !='' " >
      and  es.UPDATEBY = #{eysPlf.updateby,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.createby != null and eysPlf.createby !='' " >
      and   es.CREATEBY = #{eysPlf.createby,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.aae012 != null and eysPlf.aae012 !='' " >
      and  es.AAE012 = #{eysPlf.aae012,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.isnew != null and eysPlf.isnew !='' " >
      and  es.ISNEW = #{eysPlf.isnew,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.plf004 != null and eysPlf.plf004 !='' " >
      and  plf.PLF004 like #{eysPlf.plf004,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.plf005 != null and eysPlf.plf005 !='' " >
      and plf.PLF005 = #{eysPlf.plf005,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.plf006 != null and eysPlf.plf006 !='' " >
      and plf.PLF006 = #{eysPlf.plf006,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.plf007 != null and eysPlf.plf007 !='' " >
      and plf.PLF007 = #{eysPlf.plf007,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.startage != null and eysPlf.startage !='' " >
      and plf.PLF008 >= #{eysPlf.startage,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.endage != null and eysPlf.endage !='' " >
      and plf.PLF008 &lt; #{eysPlf.endage,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.plf009 != null and eysPlf.plf009 !='' " >
      and plf.PLF009 = #{eysPlf.plf009,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.plf010 != null and eysPlf.plf010 !='' " >
      and plf.PLF010 = #{eysPlf.plf010,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.plf011 != null and eysPlf.plf011 !='' " >
      and plf.PLF011 = #{eysPlf.plf011,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.plf012 != null and eysPlf.plf012 !='' " >
      and plf.PLF012 = #{eysPlf.plf012,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.plf013 != null and eysPlf.plf013 !='' " >
      and plf.PLF013 = #{eysPlf.plf013,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.plf014 != null and eysPlf.plf014 !='' " >
      and  plf.PLF014 = #{eysPlf.plf014,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.plf016 != null and eysPlf.plf016 !='' " >
      and plf.PLF016 = #{eysPlf.plf016,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.plf015 != null and eysPlf.plf015 !='' " >
      and plf.PLF015 = #{eysPlf.plf015,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.plf017 != null and eysPlf.plf017 !='' " >
      and  plf.PLF017 = #{eysPlf.plf017,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.plf018 != null and eysPlf.plf018 !='' " >
      and  plf.PLF018 = #{eysPlf.plf018,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.plf019 != null and eysPlf.plf019 !='' " >
      and  plf.PLF019 = #{eysPlf.plf019,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.plf020 != null and eysPlf.plf020 !='' " >
      and plf.PLF020 = #{eysPlf.plf020,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.plf021 != null and eysPlf.plf021 !='' " >
      and  plf.PLF021 = #{eysPlf.plf021,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.plf022 != null and eysPlf.plf022 !='' " >
      and  plf.PLF022 = #{eysPlf.plf022,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.plf023 != null and eysPlf.plf023 !='' " >
      and  plf.PLF023 = #{eysPlf.plf023,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.plf024 != null and eysPlf.plf024 !='' " >
      and plf.PLF024 = #{eysPlf.plf024,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.phd013 != null and eysPlf.phd013 !='' " >
      and es.PHD013 = #{eysPlf.phd013,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.phd014 != null and eysPlf.phd014 !='' " >
      and es.phd014 = #{eysPlf.phd014,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.phd014_19 != null and eysPlf.phd014_19 !='' " >
      and es.phd014_19 = #{eysPlf.phd014_19,jdbcType=VARCHAR}
    </if>
    ) a1
    where  AAE100='1'
    <if test="eysPlf.eys011 != null and eysPlf.eys011 !='' " >
      and   eysss = #{eysPlf.eys011,jdbcType=VARCHAR}
    </if>

    and rownum &lt;= #{pageSize})
    where rn &gt;= #{startRecord}
  </select>


  <!--查询所有多少个  根据行政区划   查询就业培训个数信息-->
  <select id="queryAllEmploymentSituationTrainingByAab301" resultType="java.lang.String" parameterType="java.lang.String" >
    select count(1) from(
    select
    eys001
    from employment_situation es left join  poor_labor_force plf  on es.eys002 = plf.plf001

    <if test="eysPlf.showscope != null and eysPlf.showscope !='' ">
      left join training_situation ts on es.eys002 = ts.tsn010
    </if>
    where  es.aae100='1' and plf.aae100='1'
     and plf.ispoor='1' and success = '1'  and es.eys004='1'
    <if test="eysPlf.showscope != null and eysPlf.showscope !='' ">
      and ts.TSN012='1' and ts.aae100='1' and ts.tsn003='1'
    </if>
    <if test="eysPlf.helpyear != null and eysPlf.helpyear !='' ">
      and   substr(es.eys009,0,4) = #{eysPlf.helpyear,jdbcType=VARCHAR}
    </if>
    <if test='eysPlf.isnoduty != null and eysPlf.isnoduty =="1" '>
      and  es.EYS010 is null
    </if>
    <if test='eysPlf.isnoduty != null and eysPlf.isnoduty =="0" '>
      and  es.EYS010 is not null
    </if>
    <if test="eysPlf.eys002 != null and eysPlf.eys002 !='' ">
      and   es.EYS002 = #{eys002,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.eys003 != null and eysPlf.eys003 !='' " >
      and   es.EYS003 = #{eysPlf.eys003,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.eys004 != null and eysPlf.eys004 !='' " >
      and   es.EYS004 = #{eysPlf.eys004,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.eys005 != null and eysPlf.eys005 !='' " >
      and   es.EYS005 = #{eysPlf.eys005,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.eys006 != null and eysPlf.eys006 !='' " >
      and   es.EYS006 = #{eysPlf.eys006,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.eys007 != null and eysPlf.eys007 !='' " >
      and   es.EYS007 = #{eysPlf.eys007,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.eys008 != null and eysPlf.eys008 !='' " >
      and   es.EYS008 = #{eysPlf.eys008,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.eys009 != null and eysPlf.eys009 !='' " >
      and to_date(es.EYS009,'yyyy-MM-dd') >= to_date(#{eysPlf.eys009},'yyyy-MM-dd')
    </if>
    <if test="eysPlf.monthcount != null and eysPlf.monthcount !='' " >
      and es.eys009 is not null and instr(es.eys009, '-') > 1 and  floor((to_date(es.eys010,'yyyy-MM-dd')- to_date(es.eys009,'yyyy-MM-dd'))/30) > #{eysPlf.monthcount}
    </if>
    <if test="eysPlf.eys010 != null and eysPlf.eys010 !='' " >
      and to_date(es.EYS010,'yyyy-MM-dd') &lt;= to_date(#{eysPlf.eys010},'yyyy-MM-dd')
    </if>

    <if test="eysPlf.eys012 != null and eysPlf.eys012 !='' " >
      and   es.EYS012 = #{eysPlf.eys012,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.eys013 != null and eysPlf.eys013 !='' " >
      and   es.EYS013 = #{eysPlf.eys013,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.eys014 != null and eysPlf.eys014 !='' " >
      and  es.EYS014 = #{eysPlf.eys014,jdbcType=VARCHAR}
    </if>

    <if test="eysPlf.eys016 != null and eysPlf.eys016 !='' " >
      and   es.EYS016 = #{eysPlf.eys016,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.eys017 != null and eysPlf.eys017 !='' " >
      and  es.EYS017 = #{eysPlf.eys017,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.eys018 != null and eysPlf.eys018 !='' " >
      and   es.EYS018 = #{eysPlf.eys018,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.eys019 != null and eysPlf.eys019 !='' " >
      and   es.EYS019 = #{eysPlf.eys019,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.eys020 != null and eysPlf.eys020 !='' " >
      and   es.EYS020 = #{eysPlf.eys020,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.eys021 != null and eysPlf.eys021 !='' " >
      and   es.EYS021 = #{eysPlf.eys021,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.eys022 != null and eysPlf.eys022 !='' " >
      and   es.EYS022 = #{eysPlf.eys022,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.eys023 != null and eysPlf.eys023 !='' " >
      and   es.EYS023 = #{eysPlf.eys023,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.eys024 != null and eysPlf.eys024 !='' " >
      and   es.EYS024 = #{eysPlf.eys024,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.aab301 != null and eysPlf.aab301 !='' " >
      and   plf.AAB301 like #{eysPlf.aab301,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.aae011 != null and eysPlf.aae011 !='' " >
      and   es.AAE011 = #{eysPlf.aae011,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.aae036 != null and eysPlf.aae036 !='' " >
      and   es.AAE036 = #{eysPlf.aae036,jdbcType=TIMESTAMP},
    </if>
    <if test="eysPlf.eys015 != null and eysPlf.eys015 !='' " >
      and   es.EYS015 = #{eysPlf.eys015,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.datasource != null and eysPlf.datasource !='' " >
      and  es.DATASOURCE = #{eysPlf.datasource,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.aae100 != null and eysPlf.aae100 !='' " >
      and   es.AAE100 = #{eysPlf.aae100,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.updatedate != null and eysPlf.updatedate !='' " >
      and  es.UPDATEDATE = #{eysPlf.updatedate,jdbcType=TIMESTAMP}
    </if>
    <if test="eysPlf.updateby != null and eysPlf.updateby !='' " >
      and  es.UPDATEBY = #{eysPlf.updateby,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.createby != null and eysPlf.createby !='' " >
      and   es.CREATEBY = #{eysPlf.createby,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.aae012 != null and eysPlf.aae012 !='' " >
      and  es.AAE012 = #{eysPlf.aae012,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.isnew != null and eysPlf.isnew !='' " >
      and  es.ISNEW = #{eysPlf.isnew,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.plf004 != null and eysPlf.plf004 !='' " >
      and  plf.PLF004 like #{eysPlf.plf004,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.plf005 != null and eysPlf.plf005 !='' " >
      and plf.PLF005 = #{eysPlf.plf005,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.plf006 != null and eysPlf.plf006 !='' " >
      and plf.PLF006 = #{eysPlf.plf006,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.plf007 != null and eysPlf.plf007 !='' " >
      and plf.PLF007 = #{eysPlf.plf007,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.startage != null and eysPlf.startage !='' " >
      and plf.PLF008 >= #{eysPlf.startage,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.endage != null and eysPlf.endage !='' " >
      and plf.PLF008 &lt; #{eysPlf.endage,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.plf009 != null and eysPlf.plf009 !='' " >
      and plf.PLF009 = #{eysPlf.plf009,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.plf010 != null and eysPlf.plf010 !='' " >
      and plf.PLF010 = #{eysPlf.plf010,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.plf011 != null and eysPlf.plf011 !='' " >
      and plf.PLF011 = #{eysPlf.plf011,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.plf012 != null and eysPlf.plf012 !='' " >
      and plf.PLF012 = #{eysPlf.plf012,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.plf013 != null and eysPlf.plf013 !='' " >
      and plf.PLF013 = #{eysPlf.plf013,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.plf014 != null and eysPlf.plf014 !='' " >
      and  plf.PLF014 = #{eysPlf.plf014,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.plf016 != null and eysPlf.plf016 !='' " >
      and plf.PLF016 = #{eysPlf.plf016,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.plf015 != null and eysPlf.plf015 !='' " >
      and plf.PLF015 = #{eysPlf.plf015,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.plf017 != null and eysPlf.plf017 !='' " >
      and  plf.PLF017 = #{eysPlf.plf017,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.plf018 != null and eysPlf.plf018 !='' " >
      and  plf.PLF018 = #{eysPlf.plf018,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.plf019 != null and eysPlf.plf019 !='' " >
      and  plf.PLF019 = #{eysPlf.plf019,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.plf020 != null and eysPlf.plf020 !='' " >
      and plf.PLF020 = #{eysPlf.plf020,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.plf021 != null and eysPlf.plf021 !='' " >
      and  plf.PLF021 = #{eysPlf.plf021,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.plf022 != null and eysPlf.plf022 !='' " >
      and  plf.PLF022 = #{eysPlf.plf022,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.plf023 != null and eysPlf.plf023 !='' " >
      and  plf.PLF023 = #{eysPlf.plf023,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.plf024 != null and eysPlf.plf024 !='' " >
      and plf.PLF024 = #{eysPlf.plf024,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.phd013 != null and eysPlf.phd013 !='' " >
      and es.PHD013 = #{eysPlf.phd013,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.phd014 != null and eysPlf.phd014 !='' " >
      and es.phd014 = #{eysPlf.phd014,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.phd014_19 != null and eysPlf.phd014_19 !='' " >
      and es.phd014_19 = #{eysPlf.phd014_19,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.eys011 != null and eysPlf.eys011 !='' " >
      and   EYS011 = #{eysPlf.eys011,jdbcType=VARCHAR}
    </if>
    )

  </select>


  <!--*************************************以下是就业信息查询 （有问题就业数据）***********************************************************************************-->

  <!--根据行政区划查询劳动力就业（有问题就业数据）信息-->
  <select id="queryErrorEmploymentSituationAccountByAab301" resultMap="EysPlfResultMap" parameterType="java.lang.String" >
    select
    plf004,plf005,
    eys001,eys002,eys003,eys004,eys005,eys006,eys007,eys008,eys009,
    eys010,eys011,eys012,eys013,eys014,eys015,eys016,
    eys017,eys018,eys019,eys020,eys021,eys022,eys023,eys024,aae036,monthcount,
    AAB301, AAE011, DATASOURCE,AAE100,UPDATEDATE,UPDATEBY,CREATEBY,AAE012,phd013,phd007,ISNEW,rn,DELETEBY,DELETEDATE
    from (select
    plf004,plf005,
    eys001,eys002,eys003,eys004,eys005,eys006,eys007,eys008,eys009,
    eys010,eys011,eys012,eys013,eys014,eys015,eys016,
    eys017,eys018,eys019,eys020,eys021,eys022,eys023,eys024,aae036,monthcount,
    AAB301, AAE011, DATASOURCE,AAE100,UPDATEDATE,UPDATEBY,CREATEBY,AAE012,phd013,phd007,ISNEW, rownum rn,DELETEBY,DELETEDATE
    from (select es.PLF004,es.PLF005,
    es.eys001,es.eys002,
    f_getcodename('AAA013',es.EYS003)EYS003,
    f_getcodename('AAA006',es.EYS004)EYS004,
    f_getcodename('AAA018',es.EYS005)EYS005,
    f_getcodename('ECC207',es.EYS007)EYS007,
    f_getcodename('AAA005',es.EYS011)EYS011,
    f_getcodename('AAA008',es.EYS012)EYS012,
    es.EYS006,es.EYS008, es.EYS009, es.EYS010,
    f_getcodename('EDC441',es.PHD013) phd013,
    f_getcodename('AAA012',es.phd014) phd014,
    ''phd007,
    floor(((case
    when is_date_yy(es.eys009)=1 and is_date_yy(es.eys010)=1  then
    to_date(es.eys010, 'yyyy-MM-dd') -
    to_date(es.eys009, 'yyyy-MM-dd')
    when is_date_yy(es.eys009)=1  and es.eys010 is null then
    sysdate - to_date(es.eys009, 'yyyy-MM-dd')
    else
    0
    end) / 30)) monthcount,
    es.eys013,es.eys014,es.eys015,es.eys016,
    es.eys017,es.eys018,es.eys019,es.eys020,es.eys021,es.eys022,es.eys023,es.eys024,
    t.info AAB301 , es.AAE011, es.AAE036,es.DATASOURCE,
    es.AAE100,es.UPDATEDATE,es.UPDATEBY,es.CREATEBY,es.AAE012,es.ISNEW,es.DELETEBY,es.DELETEDATE,
    row_number() over(partition by es.eys002 order by eys009 desc) as sn,eys011 eysss
    from   employment_situation es ,POOR_XZQH t
    where es.AAB301=t.XZQHBM and es.aae100='1'
    and  es.EYS010 is  null
    <if test="eysPlf.helpyear != null and eysPlf.helpyear !='' ">
      and   substr(es.eys009,0,4) = #{eysPlf.helpyear,jdbcType=VARCHAR}
    </if>
    <if test='eysPlf.isnoduty != null and eysPlf.isnoduty =="1" '>
      and  es.EYS010 is null
    </if>
    <if test='eysPlf.isnoduty != null and eysPlf.isnoduty =="0" '>
      and  es.EYS010 is not null
    </if>
    <if test="eysPlf.eys002 != null and eysPlf.eys002 !='' ">
      and   es.EYS002 = #{eys002,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.eys003 != null and eysPlf.eys003 !='' " >
      and   es.EYS003 = #{eysPlf.eys003,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.eys004 != null and eysPlf.eys004 !='' " >
      and   es.EYS004 = #{eysPlf.eys004,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.eys005 != null and eysPlf.eys005 !='' " >
      and   es.EYS005 = #{eysPlf.eys005,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.eys006 != null and eysPlf.eys006 !='' " >
      and   es.EYS006 = #{eysPlf.eys006,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.eys007 != null and eysPlf.eys007 !='' " >
      and   es.EYS007 = #{eysPlf.eys007,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.eys008 != null and eysPlf.eys008 !='' " >
      and   es.EYS008 = #{eysPlf.eys008,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.eys009 != null and eysPlf.eys009 !='' " >
      and to_date(es.EYS009,'yyyy-MM-dd') >= to_date(#{eysPlf.eys009},'yyyy-MM-dd')
    </if>
    <if test="eysPlf.monthcount != null and eysPlf.monthcount !='' " >
      and es.eys009 is not null and instr(es.eys009, '-') > 1 and  floor((to_date(es.eys010,'yyyy-MM-dd')- to_date(es.eys009,'yyyy-MM-dd'))/30) > #{eysPlf.monthcount}
    </if>
    <if test="eysPlf.eys010 != null and eysPlf.eys010 !='' " >
      and to_date(es.EYS010,'yyyy-MM-dd') &lt;= to_date(#{eysPlf.eys010},'yyyy-MM-dd')
    </if>
    <!-- <if test="eysPlf.eys011 != null and eysPlf.eys011 !='' " >
       and   es.EYS011 = #{eysPlf.eys011,jdbcType=VARCHAR}
     </if>-->
    <if test="eysPlf.eys012 != null and eysPlf.eys012 !='' " >
      and   es.EYS012 = #{eysPlf.eys012,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.eys013 != null and eysPlf.eys013 !='' " >
      and   es.EYS013 = #{eysPlf.eys013,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.eys014 != null and eysPlf.eys014 !='' " >
      and  es.EYS014 = #{eysPlf.eys014,jdbcType=VARCHAR}
    </if>

    <if test="eysPlf.eys016 != null and eysPlf.eys016 !='' " >
      and   es.EYS016 = #{eysPlf.eys016,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.eys017 != null and eysPlf.eys017 !='' " >
      and  es.EYS017 = #{eysPlf.eys017,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.eys018 != null and eysPlf.eys018 !='' " >
      and   es.EYS018 = #{eysPlf.eys018,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.eys019 != null and eysPlf.eys019 !='' " >
      and   es.EYS019 = #{eysPlf.eys019,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.eys020 != null and eysPlf.eys020 !='' " >
      and   es.EYS020 = #{eysPlf.eys020,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.eys021 != null and eysPlf.eys021 !='' " >
      and   es.EYS021 = #{eysPlf.eys021,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.eys022 != null and eysPlf.eys022 !='' " >
      and   es.EYS022 = #{eysPlf.eys022,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.eys023 != null and eysPlf.eys023 !='' " >
      and   es.EYS023 = #{eysPlf.eys023,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.eys024 != null and eysPlf.eys024 !='' " >
      and   es.EYS024 = #{eysPlf.eys024,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.aab301 != null and eysPlf.aab301 !='' " >
      and   es.AAB301 like #{eysPlf.aab301,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.aae011 != null and eysPlf.aae011 !='' " >
      and   es.AAE011 = #{eysPlf.aae011,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.aae036 != null and eysPlf.aae036 !='' " >
      and   es.AAE036 = #{eysPlf.aae036,jdbcType=TIMESTAMP},
    </if>
    <if test="eysPlf.eys015 != null and eysPlf.eys015 !='' " >
      and   es.EYS015 = #{eysPlf.eys015,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.datasource != null and eysPlf.datasource !='' " >
      and  es.DATASOURCE = #{eysPlf.datasource,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.aae100 != null and eysPlf.aae100 !='' " >
      and   es.AAE100 = #{eysPlf.aae100,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.updatedate != null and eysPlf.updatedate !='' " >
      and  es.UPDATEDATE = #{eysPlf.updatedate,jdbcType=TIMESTAMP}
    </if>
    <if test="eysPlf.updateby != null and eysPlf.updateby !='' " >
      and  es.UPDATEBY = #{eysPlf.updateby,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.createby != null and eysPlf.createby !='' " >
      and   es.CREATEBY = #{eysPlf.createby,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.aae012 != null and eysPlf.aae012 !='' " >
      and  es.AAE012 = #{eysPlf.aae012,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.isnew != null and eysPlf.isnew !='' " >
      and  es.ISNEW = #{eysPlf.isnew,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.plf004 != null and eysPlf.plf004 !='' " >
      and  es.PLF004 like #{eysPlf.plf004,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.plf005 != null and eysPlf.plf005 !='' " >
      and es.PLF005 = #{eysPlf.plf005,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.phd013 != null and eysPlf.phd013 !='' " >
      and es.PHD013 = #{eysPlf.phd013,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.phd014 != null and eysPlf.phd014 !='' " >
      and es.phd014 = #{eysPlf.phd014,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.phd014_19 != null and eysPlf.phd014_19 !='' " >
      and es.phd014_19 = #{eysPlf.phd014_19,jdbcType=VARCHAR}
    </if>
    ) a1
    where  sn=2
    <if test="eysPlf.eys011 != null and eysPlf.eys011 !='' " >
      and   eysss = #{eysPlf.eys011,jdbcType=VARCHAR}
    </if>

    and rownum &lt;= #{pageSize})
    where rn &gt;= #{startRecord}
  </select>

  <!--查询所有多少个  根据行政区划   就业（有问题就业数据）信息-->
  <select id="queryAllErrorEmploymentSituationByAab301" resultType="java.lang.String" parameterType="java.lang.String" >
    select count(1) from(
    select
    row_number() over(partition by es.eys002 order by eys009 desc) as sn,eys011
    from employment_situation es
    where  es.aae100='1'
        and es.EYS010 is  null
    <if test="eysPlf.helpyear != null and eysPlf.helpyear !='' ">
      and   substr(es.eys009,0,4) = #{eysPlf.helpyear,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.eys002 != null and eysPlf.eys002 !='' ">
      and   es.EYS002 = #{eys002,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.eys003 != null and eysPlf.eys003 !='' " >
      and   es.EYS003 = #{eysPlf.eys003,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.eys004 != null and eysPlf.eys004 !='' " >
      and   es.EYS004 = #{eysPlf.eys004,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.eys005 != null and eysPlf.eys005 !='' " >
      and   es.EYS005 = #{eysPlf.eys005,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.eys006 != null and eysPlf.eys006 !='' " >
      and   es.EYS006 = #{eysPlf.eys006,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.eys007 != null and eysPlf.eys007 !='' " >
      and   es.EYS007 = #{eysPlf.eys007,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.eys008 != null and eysPlf.eys008 !='' " >
      and   es.EYS008 = #{eysPlf.eys008,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.eys009 != null and eysPlf.eys009 !='' " >
      and to_date(es.EYS009,'yyyy-MM-dd') >= to_date(#{eysPlf.eys009},'yyyy-MM-dd')
    </if>
    <if test="eysPlf.monthcount != null and eysPlf.monthcount !='' " >
      and es.eys009 is not null and instr(es.eys009, '-') > 1 and  floor((to_date(es.eys010,'yyyy-MM-dd')- to_date(es.eys009,'yyyy-MM-dd'))/30) > #{eysPlf.monthcount}
    </if>
    <if test="eysPlf.eys010 != null and eysPlf.eys010 !='' " >
      and to_date(es.EYS010,'yyyy-MM-dd') &lt;= to_date(#{eysPlf.eys010},'yyyy-MM-dd')
    </if>

    <if test="eysPlf.eys012 != null and eysPlf.eys012 !='' " >
      and   es.EYS012 = #{eysPlf.eys012,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.eys013 != null and eysPlf.eys013 !='' " >
      and   es.EYS013 = #{eysPlf.eys013,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.eys014 != null and eysPlf.eys014 !='' " >
      and  es.EYS014 = #{eysPlf.eys014,jdbcType=VARCHAR}
    </if>

    <if test="eysPlf.eys016 != null and eysPlf.eys016 !='' " >
      and   es.EYS016 = #{eysPlf.eys016,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.eys017 != null and eysPlf.eys017 !='' " >
      and  es.EYS017 = #{eysPlf.eys017,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.eys018 != null and eysPlf.eys018 !='' " >
      and   es.EYS018 = #{eysPlf.eys018,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.eys019 != null and eysPlf.eys019 !='' " >
      and   es.EYS019 = #{eysPlf.eys019,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.eys020 != null and eysPlf.eys020 !='' " >
      and   es.EYS020 = #{eysPlf.eys020,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.eys021 != null and eysPlf.eys021 !='' " >
      and   es.EYS021 = #{eysPlf.eys021,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.eys022 != null and eysPlf.eys022 !='' " >
      and   es.EYS022 = #{eysPlf.eys022,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.eys023 != null and eysPlf.eys023 !='' " >
      and   es.EYS023 = #{eysPlf.eys023,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.eys024 != null and eysPlf.eys024 !='' " >
      and   es.EYS024 = #{eysPlf.eys024,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.aab301 != null and eysPlf.aab301 !='' " >
      and   es.AAB301 like #{eysPlf.aab301,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.aae011 != null and eysPlf.aae011 !='' " >
      and   es.AAE011 = #{eysPlf.aae011,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.aae036 != null and eysPlf.aae036 !='' " >
      and   es.AAE036 = #{eysPlf.aae036,jdbcType=TIMESTAMP},
    </if>
    <if test="eysPlf.eys015 != null and eysPlf.eys015 !='' " >
      and   es.EYS015 = #{eysPlf.eys015,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.datasource != null and eysPlf.datasource !='' " >
      and  es.DATASOURCE = #{eysPlf.datasource,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.aae100 != null and eysPlf.aae100 !='' " >
      and   es.AAE100 = #{eysPlf.aae100,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.updatedate != null and eysPlf.updatedate !='' " >
      and  es.UPDATEDATE = #{eysPlf.updatedate,jdbcType=TIMESTAMP}
    </if>
    <if test="eysPlf.updateby != null and eysPlf.updateby !='' " >
      and  es.UPDATEBY = #{eysPlf.updateby,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.createby != null and eysPlf.createby !='' " >
      and   es.CREATEBY = #{eysPlf.createby,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.aae012 != null and eysPlf.aae012 !='' " >
      and  es.AAE012 = #{eysPlf.aae012,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.isnew != null and eysPlf.isnew !='' " >
      and  es.ISNEW = #{eysPlf.isnew,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.phd013 != null and eysPlf.phd013 !='' " >
      and es.PHD013 = #{eysPlf.phd013,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.phd014 != null and eysPlf.phd014 !='' " >
      and es.phd014 = #{eysPlf.phd014,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.phd014_19 != null and eysPlf.phd014_19 !='' " >
      and es.phd014_19 = #{eysPlf.phd014_19,jdbcType=VARCHAR}
    </if>
    ) where sn=2
    <if test="eysPlf.eys011 != null and eysPlf.eys011 !='' " >
      and   EYS011 = #{eysPlf.eys011,jdbcType=VARCHAR}
    </if>
  </select>


  <!--*************************************以下是弱劳动力就业台账信息查询***********************************************************************************-->


  <!--根据行政区划查询弱劳动力就业台账信息-->
  <select id="queryRuoEmploymentSituationAccountByAab301" resultMap="EysPlfResultMap" parameterType="java.lang.String" >
    select
    plf001,plf002,plf004,plf005,plf006,plf007,plf008,
    plf009,plf010,plf011,plf012,plf013,plf015,plf016,plf017,plf018,
    plf019,plf020,plf021,plf022,plf023,plf024,phd014,phd014_19,
    eys001,eys002,eys003,eys004,eys005,eys006,eys007,eys008,eys009,
    eys010,eys011,eys012,eys013,eys014,eys015,eys016,
    eys017,eys018,eys019,eys020,eys021,eys022,eys023,eys024,aae036,monthcount,
    AAB301, AAE011, DATASOURCE,AAE100,UPDATEDATE,UPDATEBY,CREATEBY,AAE012,phd013,phd007,ISNEW,rn,DELETEBY,DELETEDATE
    from (select plf001,plf002,
    plf004,plf005,plf006,plf007,plf008,
    plf009,plf010,plf011,plf012,plf013,plf015,plf016,plf017,plf018,
    plf019,plf020,plf021,plf022,plf023,plf024,phd014,phd014_19,
    eys001,eys002,eys003,eys004,eys005,eys006,eys007,eys008,eys009,
    eys010,eys011,eys012,eys013,eys014,eys015,eys016,
    eys017,eys018,eys019,eys020,eys021,eys022,eys023,eys024,aae036,monthcount,
    AAB301, AAE011, DATASOURCE,AAE100,UPDATEDATE,UPDATEBY,CREATEBY,AAE012,phd013,phd007,ISNEW, rownum rn,DELETEBY,DELETEDATE
    from (select plf.plf001,plf.plf002,plf.plf004,plf.plf005,plf.plf006,
    f_getcodename('AAC004',plf.PLF007) PLF007,plf.PLF008,
    f_getcodename('AAC011',plf.PLF009) PLF009,
    f_getcodename('AAA004',plf.PLF010) PLF010,
    f_getcodename('AAA002',plf.PLF011) PLF011,
    f_getcodename('AAA003',plf.PLF012) PLF012,plf.PLF013,plf.PLF016,
    f_getcodename('AAA001',plf.PLF014) PLF014,
    (case when plf.plf015 ='1' then '是' else '否' end) plf015,
    f_getcodename('AAA011',plf.PLF017) PLF017,
    f_getcodename('AAA016',plf.PLF018) PLF018,
    plf.plf019,plf.plf020,plf.plf021,plf.plf022,
    f_getcodename('EDC441',plf.plf023) plf023,
    f_getcodename('PLF024',plf.plf024) plf024,
    es.eys001,es.eys002,
    f_getcodename('AAA013',es.EYS003)EYS003,
    f_getcodename('AAA006',es.EYS004)EYS004,
    f_getcodename('AAA018',es.EYS005)EYS005,
    f_getcodename('ECC207',es.EYS007)EYS007,
    f_getcodename('AAA005',es.EYS011)EYS011,
    f_getcodename('AAA008',es.EYS012)EYS012,
    es.EYS006,es.EYS008, es.EYS009, es.EYS010,
    f_getcodename('EDC441',plf.PHD013) phd013,
    f_getcodename('AAA012',plf.phd014) phd014,es.phd014_19,
    '' phd007,
    floor(((case
    when is_date_yy(es.eys009)=1 and is_date_yy(es.eys010)=1  then
    to_date(es.eys010, 'yyyy-MM-dd') -
    to_date(es.eys009, 'yyyy-MM-dd')
    when is_date_yy(es.eys009)=1  and es.eys010 is null then
    sysdate - to_date(es.eys009, 'yyyy-MM-dd')
    else
    0
    end) / 30)) monthcount,
    es.eys013,es.eys014,es.eys015,es.eys016,
    es.eys017,es.eys018,es.eys019,es.eys020,es.eys021,es.eys022,es.eys023,es.eys024,
    t.info AAB301 , es.AAE011, es.AAE036,es.DATASOURCE,
    es.AAE100,es.UPDATEDATE,es.UPDATEBY,es.CREATEBY,es.AAE012,es.ISNEW,es.DELETEBY,es.DELETEDATE,
    eys011 eysss
    from   employment_situation es
    left join poor_labor_force plf  on es.eys002 = plf.plf001
    /*是否享受补贴*/
    <if test="eysPlf.enjoysubsidy != null  and eysPlf.enjoysubsidy !=''  and eysPlf.enjoysubsidy=='1'.toString()  ">
      left join EMPLOYMENT_SUBSIDY dy on plf.PLF001 = dy.ETS003
    </if>
    ,POOR_XZQH t
    where plf.AAB301=t.XZQHBM and es.aae100='1' and plf.aae100='1'  and plf.plf008 >= 16 and plf.plf008 &lt;= 60  and es.success='9'
    /*待完善条件 必须要有开始日期，结束日期不能大于当前日期  */
    <if test="eysPlf.istobecomplete != null  and eysPlf.istobecomplete !='' ">
      and (es.EYS009 is null or to_date(es.eys010,'yyyy-MM-dd hh24:mi:ss') > sysdate or to_date(es.eys009,'yyyy-MM-dd hh24:mi:ss') - to_date(es.eys010,'yyyy-MM-dd hh24:mi:ss') >0)
    </if>
    <if test="eysPlf.showscope != null and eysPlf.showscope !='' ">
        and   plf.plf018 = '05' and plf.PLF025='0'
    </if>
    <if test="eysPlf.helpyear != null and eysPlf.helpyear !='' ">
      and   substr(es.eys009,0,4) = #{eysPlf.helpyear,jdbcType=VARCHAR}
    </if>
    <if test='eysPlf.isnoduty != null and eysPlf.isnoduty =="1" '>
      and  es.EYS010 is null
    </if>
    <if test='eysPlf.isnoduty != null and eysPlf.isnoduty =="0" '>
      and  es.EYS010 is not null
    </if>
    <if test="eysPlf.enjoysubsidy != null  and eysPlf.enjoysubsidy !=''  and eysPlf.enjoysubsidy=='1'.toString()  ">
      and dy.AAE100='1'
    </if>
    <if test="eysPlf.enjoysubsidy != null  and eysPlf.enjoysubsidy !=''  and eysPlf.enjoysubsidy=='1'.toString()  and eysPlf.helpyear != null and eysPlf.helpyear !='' ">
      and dy.AAE100='1' and dy.ets004 = #{eysPlf.helpyear,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.eys002 != null and eysPlf.eys002 !='' ">
      and   es.EYS002 = #{eys002,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.eys003 != null and eysPlf.eys003 !='' " >
      and   es.EYS003 = #{eysPlf.eys003,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.eys004 != null and eysPlf.eys004 !='' " >
      and   es.EYS004 = #{eysPlf.eys004,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.eys005 != null and eysPlf.eys005 !='' " >
      and   es.EYS005 = #{eysPlf.eys005,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.eys006 != null and eysPlf.eys006 !='' " >
      and   es.EYS006 = #{eysPlf.eys006,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.eys007 != null and eysPlf.eys007 !='' " >
      and   es.EYS007 = #{eysPlf.eys007,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.eys008 != null and eysPlf.eys008 !='' " >
      and   es.EYS008 = #{eysPlf.eys008,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.eys009 != null and eysPlf.eys009 !='' " >
      and to_date(es.EYS009,'yyyy-MM-dd') >= to_date(#{eysPlf.eys009},'yyyy-MM-dd')
    </if>
    <if test="eysPlf.monthcount != null and eysPlf.monthcount !='' " >
      and es.eys009 is not null and instr(es.eys009, '-') > 1 and  floor((to_date(es.eys010,'yyyy-MM-dd')- to_date(es.eys009,'yyyy-MM-dd'))/30) > #{eysPlf.monthcount}
    </if>
    <if test="eysPlf.eys010 != null and eysPlf.eys010 !='' " >
      and to_date(es.EYS010,'yyyy-MM-dd') &lt;= to_date(#{eysPlf.eys010},'yyyy-MM-dd')
    </if>
    <!-- <if test="eysPlf.eys011 != null and eysPlf.eys011 !='' " >
       and   es.EYS011 = #{eysPlf.eys011,jdbcType=VARCHAR}
     </if>-->
    <if test="eysPlf.eys012 != null and eysPlf.eys012 !='' " >
      and   es.EYS012 = #{eysPlf.eys012,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.eys013 != null and eysPlf.eys013 !='' " >
      and   es.EYS013 = #{eysPlf.eys013,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.eys014 != null and eysPlf.eys014 !='' " >
      and  es.EYS014 = #{eysPlf.eys014,jdbcType=VARCHAR}
    </if>

    <if test="eysPlf.eys016 != null and eysPlf.eys016 !='' " >
      and   es.EYS016 = #{eysPlf.eys016,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.eys017 != null and eysPlf.eys017 !='' " >
      and  es.EYS017 = #{eysPlf.eys017,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.eys018 != null and eysPlf.eys018 !='' " >
      and   es.EYS018 = #{eysPlf.eys018,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.eys019 != null and eysPlf.eys019 !='' " >
      and   es.EYS019 = #{eysPlf.eys019,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.eys020 != null and eysPlf.eys020 !='' " >
      and   es.EYS020 = #{eysPlf.eys020,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.eys021 != null and eysPlf.eys021 !='' " >
      and   es.EYS021 = #{eysPlf.eys021,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.eys022 != null and eysPlf.eys022 !='' " >
      and   es.EYS022 = #{eysPlf.eys022,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.eys023 != null and eysPlf.eys023 !='' " >
      and   es.EYS023 = #{eysPlf.eys023,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.eys024 != null and eysPlf.eys024 !='' " >
      and   es.EYS024 = #{eysPlf.eys024,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.aab301 != null and eysPlf.aab301 !='' " >
      and   plf.AAB301 like #{eysPlf.aab301,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.aae011 != null and eysPlf.aae011 !='' " >
      and   es.AAE011 = #{eysPlf.aae011,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.aae036 != null and eysPlf.aae036 !='' " >
      and   es.AAE036 = #{eysPlf.aae036,jdbcType=TIMESTAMP},
    </if>
    <if test="eysPlf.eys015 != null and eysPlf.eys015 !='' " >
      and   es.EYS015 = #{eysPlf.eys015,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.datasource != null and eysPlf.datasource !='' " >
      and  es.DATASOURCE = #{eysPlf.datasource,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.aae100 != null and eysPlf.aae100 !='' " >
      and   es.AAE100 = #{eysPlf.aae100,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.updatedate != null and eysPlf.updatedate !='' " >
      and  es.UPDATEDATE = #{eysPlf.updatedate,jdbcType=TIMESTAMP}
    </if>
    <if test="eysPlf.updateby != null and eysPlf.updateby !='' " >
      and  es.UPDATEBY = #{eysPlf.updateby,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.createby != null and eysPlf.createby !='' " >
      and   es.CREATEBY = #{eysPlf.createby,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.aae012 != null and eysPlf.aae012 !='' " >
      and  es.AAE012 = #{eysPlf.aae012,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.isnew != null and eysPlf.isnew !='' " >
      and  es.ISNEW = #{eysPlf.isnew,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.plf004 != null and eysPlf.plf004 !='' " >
      and  plf.PLF004 like #{eysPlf.plf004,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.plf005 != null and eysPlf.plf005 !='' " >
      and plf.PLF005 = #{eysPlf.plf005,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.plf006 != null and eysPlf.plf006 !='' " >
      and plf.PLF006 = #{eysPlf.plf006,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.plf007 != null and eysPlf.plf007 !='' " >
      and plf.PLF007 = #{eysPlf.plf007,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.startage != null and eysPlf.startage !='' " >
      and plf.PLF008 >= #{eysPlf.startage,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.endage != null and eysPlf.endage !='' " >
      and plf.PLF008 &lt; #{eysPlf.endage,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.plf009 != null and eysPlf.plf009 !='' " >
      and plf.PLF009 = #{eysPlf.plf009,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.plf010 != null and eysPlf.plf010 !='' " >
      and plf.PLF010 = #{eysPlf.plf010,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.plf011 != null and eysPlf.plf011 !='' " >
      and plf.PLF011 = #{eysPlf.plf011,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.plf012 != null and eysPlf.plf012 !='' " >
      and plf.PLF012 = #{eysPlf.plf012,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.plf013 != null and eysPlf.plf013 !='' " >
      and plf.PLF013 = #{eysPlf.plf013,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.plf014 != null and eysPlf.plf014 !='' " >
      and  plf.PLF014 = #{eysPlf.plf014,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.plf016 != null and eysPlf.plf016 !='' " >
      and plf.PLF016 = #{eysPlf.plf016,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.plf015 != null and eysPlf.plf015 !='' " >
      and plf.PLF015 = #{eysPlf.plf015,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.plf017 != null and eysPlf.plf017 !='' " >
      and  plf.PLF017 = #{eysPlf.plf017,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.plf018 != null and eysPlf.plf018 !='' " >
      and  plf.PLF018 = #{eysPlf.plf018,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.plf019 != null and eysPlf.plf019 !='' " >
      and  plf.PLF019 = #{eysPlf.plf019,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.plf020 != null and eysPlf.plf020 !='' " >
      and plf.PLF020 = #{eysPlf.plf020,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.plf021 != null and eysPlf.plf021 !='' " >
      and  plf.PLF021 = #{eysPlf.plf021,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.plf022 != null and eysPlf.plf022 !='' " >
      and  plf.PLF022 = #{eysPlf.plf022,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.plf023 != null and eysPlf.plf023 !='' " >
      and  plf.PLF023 = #{eysPlf.plf023,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.plf024 != null and eysPlf.plf024 !='' " >
      and plf.PLF024 = #{eysPlf.plf024,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.phd013 != null and eysPlf.phd013 !='' " >
      and es.PHD013 = #{eysPlf.phd013,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.phd014 != null and eysPlf.phd014 !='' " >
      and es.phd014 = #{eysPlf.phd014,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.phd014_19 != null and eysPlf.phd014_19 !='' " >
      and es.phd014_19 = #{eysPlf.phd014_19,jdbcType=VARCHAR}
    </if>
    ) a1
    where  AAE100='1'
    <if test="eysPlf.eys011 != null and eysPlf.eys011 !='' " >
      and   eysss = #{eysPlf.eys011,jdbcType=VARCHAR}
    </if>

    and rownum &lt;= #{pageSize})
    where rn &gt;= #{startRecord}
  </select>

  <!--查询所有多少个  根据行政区划   查询弱劳动力就业台账信息-->
  <select id="queryAllRuoEmploymentSituationByAab301" resultType="java.lang.String" parameterType="java.lang.String" >

    select
    count(1)
    from employment_situation es
    left join   poor_labor_force plf  on es.eys002 = plf.plf001
    /*是否享受补贴*/
    <if test="eysPlf.enjoysubsidy != null  and eysPlf.enjoysubsidy !='' and eysPlf.enjoysubsidy=='1'.toString() ">
      left join EMPLOYMENT_SUBSIDY dy on plf.PLF001 = dy.ETS003
    </if>
    where  es.aae100='1' and plf.aae100='1'  and plf.plf008 >= 16 and plf.plf008 &lt;= 60 and es.success='9'
    /*待完善条件 必须要有开始日期，结束日期不能大于当前日期 */
    <if test="eysPlf.istobecomplete != null  and eysPlf.istobecomplete !='' ">
      and (es.EYS009 is null or to_date(es.eys010,'yyyy-MM-dd hh24:mi:ss') > sysdate or to_date(es.eys009,'yyyy-MM-dd hh24:mi:ss') - to_date(es.eys010,'yyyy-MM-dd hh24:mi:ss') >0)
    </if>
       and   plf.plf018 = '05' and plf.PLF025='0'
    <if test="eysPlf.helpyear != null and eysPlf.helpyear !='' ">
      and   substr(es.eys009,0,4) = #{eysPlf.helpyear,jdbcType=VARCHAR}
    </if>
    <if test='eysPlf.isnoduty != null and eysPlf.isnoduty =="1" '>
      and  es.EYS010 is null
    </if>
    <if test='eysPlf.isnoduty != null and eysPlf.isnoduty =="0" '>
      and  es.EYS010 is not null
    </if>
    <if test="eysPlf.enjoysubsidy != null  and eysPlf.enjoysubsidy !='' and eysPlf.enjoysubsidy=='1'.toString() ">
      and dy.AAE100='1'
    </if>
    <if test="eysPlf.enjoysubsidy != null  and eysPlf.enjoysubsidy !=''  and eysPlf.enjoysubsidy=='1'.toString()  and eysPlf.helpyear != null and eysPlf.helpyear !='' ">
      and dy.AAE100='1' and dy.ets004 = #{eysPlf.helpyear,jdbcType=VARCHAR}
    </if>

    <if test="eysPlf.eys002 != null and eysPlf.eys002 !='' ">
      and   es.EYS002 = #{eys002,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.eys003 != null and eysPlf.eys003 !='' " >
      and   es.EYS003 = #{eysPlf.eys003,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.eys004 != null and eysPlf.eys004 !='' " >
      and   es.EYS004 = #{eysPlf.eys004,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.eys005 != null and eysPlf.eys005 !='' " >
      and   es.EYS005 = #{eysPlf.eys005,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.eys006 != null and eysPlf.eys006 !='' " >
      and   es.EYS006 = #{eysPlf.eys006,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.eys007 != null and eysPlf.eys007 !='' " >
      and   es.EYS007 = #{eysPlf.eys007,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.eys008 != null and eysPlf.eys008 !='' " >
      and   es.EYS008 = #{eysPlf.eys008,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.eys009 != null and eysPlf.eys009 !='' " >
      and to_date(es.EYS009,'yyyy-MM-dd') >= to_date(#{eysPlf.eys009},'yyyy-MM-dd')
    </if>
    <if test="eysPlf.monthcount != null and eysPlf.monthcount !='' " >
      and es.eys009 is not null and instr(es.eys009, '-') > 1 and  floor((to_date(es.eys010,'yyyy-MM-dd')- to_date(es.eys009,'yyyy-MM-dd'))/30) > #{eysPlf.monthcount}
    </if>
    <if test="eysPlf.eys010 != null and eysPlf.eys010 !='' " >
      and to_date(es.EYS010,'yyyy-MM-dd') &lt;= to_date(#{eysPlf.eys010},'yyyy-MM-dd')
    </if>

    <if test="eysPlf.eys012 != null and eysPlf.eys012 !='' " >
      and   es.EYS012 = #{eysPlf.eys012,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.eys013 != null and eysPlf.eys013 !='' " >
      and   es.EYS013 = #{eysPlf.eys013,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.eys014 != null and eysPlf.eys014 !='' " >
      and  es.EYS014 = #{eysPlf.eys014,jdbcType=VARCHAR}
    </if>

    <if test="eysPlf.eys016 != null and eysPlf.eys016 !='' " >
      and   es.EYS016 = #{eysPlf.eys016,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.eys017 != null and eysPlf.eys017 !='' " >
      and  es.EYS017 = #{eysPlf.eys017,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.eys018 != null and eysPlf.eys018 !='' " >
      and   es.EYS018 = #{eysPlf.eys018,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.eys019 != null and eysPlf.eys019 !='' " >
      and   es.EYS019 = #{eysPlf.eys019,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.eys020 != null and eysPlf.eys020 !='' " >
      and   es.EYS020 = #{eysPlf.eys020,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.eys021 != null and eysPlf.eys021 !='' " >
      and   es.EYS021 = #{eysPlf.eys021,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.eys022 != null and eysPlf.eys022 !='' " >
      and   es.EYS022 = #{eysPlf.eys022,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.eys023 != null and eysPlf.eys023 !='' " >
      and   es.EYS023 = #{eysPlf.eys023,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.eys024 != null and eysPlf.eys024 !='' " >
      and   es.EYS024 = #{eysPlf.eys024,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.aab301 != null and eysPlf.aab301 !='' " >
      and   plf.AAB301 like #{eysPlf.aab301,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.aae011 != null and eysPlf.aae011 !='' " >
      and   es.AAE011 = #{eysPlf.aae011,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.aae036 != null and eysPlf.aae036 !='' " >
      and   es.AAE036 = #{eysPlf.aae036,jdbcType=TIMESTAMP},
    </if>
    <if test="eysPlf.eys015 != null and eysPlf.eys015 !='' " >
      and   es.EYS015 = #{eysPlf.eys015,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.datasource != null and eysPlf.datasource !='' " >
      and  es.DATASOURCE = #{eysPlf.datasource,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.aae100 != null and eysPlf.aae100 !='' " >
      and   es.AAE100 = #{eysPlf.aae100,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.updatedate != null and eysPlf.updatedate !='' " >
      and  es.UPDATEDATE = #{eysPlf.updatedate,jdbcType=TIMESTAMP}
    </if>
    <if test="eysPlf.updateby != null and eysPlf.updateby !='' " >
      and  es.UPDATEBY = #{eysPlf.updateby,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.createby != null and eysPlf.createby !='' " >
      and   es.CREATEBY = #{eysPlf.createby,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.aae012 != null and eysPlf.aae012 !='' " >
      and  es.AAE012 = #{eysPlf.aae012,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.isnew != null and eysPlf.isnew !='' " >
      and  es.ISNEW = #{eysPlf.isnew,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.plf004 != null and eysPlf.plf004 !='' " >
      and  plf.PLF004 like #{eysPlf.plf004,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.plf005 != null and eysPlf.plf005 !='' " >
      and plf.PLF005 = #{eysPlf.plf005,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.plf006 != null and eysPlf.plf006 !='' " >
      and plf.PLF006 = #{eysPlf.plf006,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.plf007 != null and eysPlf.plf007 !='' " >
      and plf.PLF007 = #{eysPlf.plf007,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.startage != null and eysPlf.startage !='' " >
      and plf.PLF008 >= #{eysPlf.startage,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.endage != null and eysPlf.endage !='' " >
      and plf.PLF008 &lt; #{eysPlf.endage,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.plf009 != null and eysPlf.plf009 !='' " >
      and plf.PLF009 = #{eysPlf.plf009,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.plf010 != null and eysPlf.plf010 !='' " >
      and plf.PLF010 = #{eysPlf.plf010,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.plf011 != null and eysPlf.plf011 !='' " >
      and plf.PLF011 = #{eysPlf.plf011,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.plf012 != null and eysPlf.plf012 !='' " >
      and plf.PLF012 = #{eysPlf.plf012,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.plf013 != null and eysPlf.plf013 !='' " >
      and plf.PLF013 = #{eysPlf.plf013,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.plf014 != null and eysPlf.plf014 !='' " >
      and  plf.PLF014 = #{eysPlf.plf014,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.plf016 != null and eysPlf.plf016 !='' " >
      and plf.PLF016 = #{eysPlf.plf016,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.plf015 != null and eysPlf.plf015 !='' " >
      and plf.PLF015 = #{eysPlf.plf015,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.plf017 != null and eysPlf.plf017 !='' " >
      and  plf.PLF017 = #{eysPlf.plf017,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.plf018 != null and eysPlf.plf018 !='' " >
      and  plf.PLF018 = #{eysPlf.plf018,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.plf019 != null and eysPlf.plf019 !='' " >
      and  plf.PLF019 = #{eysPlf.plf019,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.plf020 != null and eysPlf.plf020 !='' " >
      and plf.PLF020 = #{eysPlf.plf020,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.plf021 != null and eysPlf.plf021 !='' " >
      and  plf.PLF021 = #{eysPlf.plf021,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.plf022 != null and eysPlf.plf022 !='' " >
      and  plf.PLF022 = #{eysPlf.plf022,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.plf023 != null and eysPlf.plf023 !='' " >
      and  plf.PLF023 = #{eysPlf.plf023,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.plf024 != null and eysPlf.plf024 !='' " >
      and plf.PLF024 = #{eysPlf.plf024,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.phd013 != null and eysPlf.phd013 !='' " >
      and es.PHD013 = #{eysPlf.phd013,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.phd014 != null and eysPlf.phd014 !='' " >
      and es.phd014 = #{eysPlf.phd014,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.phd014_19 != null and eysPlf.phd014_19 !='' " >
      and es.phd014_19 = #{eysPlf.phd014_19,jdbcType=VARCHAR}
    </if>
    <if test="eysPlf.eys011 != null and eysPlf.eys011 !='' " >
      and   EYS011 = #{eysPlf.eys011,jdbcType=VARCHAR}
    </if>


  </select>


</mapper>